(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"./src/helpers/getAnnotationStyles.js":function(e,t,n){"use strict";var o=n("./src/core/index.js");t.a=function(e){var t={};return["FillColor","StrokeColor","TextColor","Opacity","StrokeThickness","FontSize","Precision","Scale","Style","Font","FontStyle"].forEach((function(n){var o=e[n];null!==o&&void 0!==o&&(t[n]=e[n])})),"highlight"!==e.elementName||o.default.isBlendModeSupported(e.BlendMode)||(t.Opacity=null),e instanceof window.Annotations.RedactionAnnotation&&(t.Opacity=null,t.StrokeThickness=null,t.FontSize=null),t}},"./src/helpers/getPopupPosition.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var o=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=n.n(o),r=n("./src/core/index.js"),i=function(e,t){var n=b(l(e),m(t));return{left:n.left,top:n.top}},s=function(e,t){var n=h(u(e),m(t));return{left:n.left,top:n.top}},l=function(e){var t=c(e),n=t.left,o=t.top,a=t.right,i=t.bottom,s=e.getPageNumber(),l=f(n,o,s),u=f(a,i,s);if(e instanceof window.Annotations.StickyAnnotation){var d=r.default.getZoom(),p=u.x-l.x,m=u.y-l.y;u={x:l.x+p/d*1.2,y:l.y+m/d*1.2}}return{topLeft:l,bottomRight:u}},c=function(e){var t=e.getRect(),n=t.x1,o=t.y1,a=t.x2,i=t.y2,s=e instanceof window.Annotations.StickyAnnotation,l=e.Width,c=r.default.getCompleteRotation(e.PageNumber);if(1===c){var u=[i,o];o=u[0],i=u[1],s&&(o-=l,i-=l)}else if(2===c){var d=[a,n];n=d[0],a=d[1];var p=[i,o];o=p[0],i=p[1],s&&(o-=l,i-=l,n-=l,a-=l)}else if(3===c){var f=[a,n];n=f[0],a=f[1],s&&(n-=l,a-=l)}return{left:n,top:o,right:a,bottom:i}},u=function(e){var t=d(e),n=t.startPageIndex,o=t.endPageIndex,a=p(e,n,o),i=a.left,s=a.right,l=a.top,c=a.bottom,u=f(i,l,n),m=f(s,c,o);if(r.default.getRotation()>1){var b=u;u=m,m=b}return{topLeft:u,bottomRight:m}},d=function(e){var t=Object.keys(e).map((function(e){return Number(e)}));return{startPageIndex:Math.min.apply(Math,a()(t)),endPageIndex:Math.max.apply(Math,a()(t))}},p=function(e,t,n){var o=function(){var o=e[t][0].y3,a=e[n];return{top:o,bottom:a[a.length-1].y1}}(),a=o.top,r=o.bottom,i=function(){var t,n;return Object.keys(e).forEach((function(o){e[o].forEach((function(e){var o=e.x1,a=e.x2;(!t||o<t)&&(t=o),(!n||a>n)&&(n=a)}))})),{left:t,right:n}}();return{left:i.left,top:a,bottom:r,right:i.right}},f=function(e,t,n){return r.default.getDisplayModeObject().pageToWindow({x:e,y:t},n)},m=function(e){var t=e.current.getBoundingClientRect();return{width:t.width,height:t.height}},b=function(e,t){var n=y(e,t,350);return{left:g(e,t),top:n}},h=function(e,t){var n=y(e,t,50);return{left:g(e,t),top:n}},g=function(e,t){var n=e.topLeft,o=e.bottomRight,a=t.height,i=t.width,s=r.default.getScrollViewElement(),l=s.scrollLeft,c=s.scrollTop,u=s.getBoundingClientRect(),d=n.y-c-u.top,p=window.innerHeight-d-u.top,f=(n.x+o.x)/2-l,m=f-i/2;return m<0?m=d<a&&p<a+32?f+24:0:m+i+u.top<window.innerWidth?m=d<a&&p<a+32?f+24:f-i/2:m+i+u.top>window.innerWidth&&(m=d<a&&p<a+32?f-i-24:window.innerWidth-i),Math.round(m)},y=function(e,t,n){var o,a=e.topLeft,i=e.bottomRight,s=t.height,l=r.default.getScrollViewElement(),c=l.getBoundingClientRect(),u=(c.left,l.scrollLeft,c.left,l.scrollLeft,c.width,c.top+l.scrollTop),d=c.top+l.scrollTop+c.height,p=a.y-13,f=i.y+13,m=a.y-l.scrollTop-c.top,b=window.innerHeight-m-c.top;return o=f+n<d?m<s&&b<s+32?f/2:f:p-n>u?p-s:f+s<d?f:p-s>u?p-s:u+5,Math.round(o-l.scrollTop)}},"./src/lumin-components/AnnotationPopup/index.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=n.n(o),r=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),i=n.n(r),s=n("./node_modules/react/index.js"),l=n.n(s),c=n("./node_modules/classnames/index.js"),u=n.n(c),d=n("./node_modules/react-redux/es/index.js"),p=n("./node_modules/@apollo/react-hoc/lib/react-hoc.esm.js"),f=n("./node_modules/recompose/dist/Recompose.esm.js"),m=n("./src/lumin-components/ActionButton/index.js"),b=n("./src/lumin-components/AnnotationStylePopup/index.js"),h=n("./src/lumin-components/CustomizablePopup/index.js"),g=n("./src/core/index.js"),y=n("./src/helpers/getPopupPosition.js"),j=n("./src/helpers/getAnnotationStyles.js"),v=n("./node_modules/i18next/dist/esm/i18next.js"),E=n("./src/redux/actions/index.js"),P=n("./src/helpers/downloadPdf.js"),O=n("./src/constants/lumin-common.js"),x=n("./src/constants/customDataConstant.js"),w=function(e,t){return g.default.applyRedactions(e).then((function(e){if(e&&e.url)return Object(P.a)(t,{filename:"redacted.pdf",includeAnnotations:!0,externalURL:e.url});console.warn("WebViewer Server did not return a valid result")}))},S=function(e,t){var n=v.a.t("warning.redaction.applyMessage"),o=v.a.t("warning.redaction.applyTile"),a=v.a.t("action.apply"),r={type:O.A.WARNING,title:o,message:n,confirmButtonTitle:a,onCancel:function(){},onConfirm:function(){return function(e,t){if(e.getCustomData(x.c.APPLIED.key)!==x.c.APPLIED.truthyValue){var n=e.FillColor;e.Color=new window.Annotations.Color(n.R,n.G,n.B,n.A),e.setCustomData(x.c.APPLIED.key,x.c.APPLIED.truthyValue),e.setModified(!0),g.default.getAnnotationManager().trigger("annotationChanged",[[e],"modify",{}])}else{var o={type:O.A.ERROR,message:"The annotation has been applied by another user"};t(E.a.openToast(o))}}(e,t)}};return t(E.a.openModal(r))},C=n("./src/constants/documentConstants.js"),A=n("./src/redux/selectors/index.js"),T=n("./src/hooks/index.js");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=Object(f.a)(p.a)((function(){var e=Object(d.f)((function(e){return[A.a.isElementDisabled(e,"annotationPopup"),A.a.isElementOpen(e,"annotationPopup"),A.a.isElementDisabled(e,"notesPanel"),A.a.isElementDisabled(e,"annotationStylePopup"),A.a.isElementOpen(e,"leftPanel"),A.a.isElementOpen(e,"searchPanel"),A.a.getPopupItems(e,"annotationPopup"),A.a.getDisabledElementFromList(e,["annotationStyleEditButton"])]}),d.d),t=i()(e,8),n=t[0],o=t[1],a=t[2],r=t[3],c=t[4],p=t[5],f=t[6],v=t[7],P=function(e){var t=Object(s.useRef)();return Object(s.useEffect)((function(){t.current=e})),t.current}(c),O=Object(d.e)(),I=Object(s.useState)({left:0,top:0}),L=i()(I,2),R=L[0],k=L[1],_=Object(s.useState)(null),M=i()(_,2),B=M[0],H=M[1],N=Object(s.useState)(!1),G=i()(N,2),F=G[0],W=G[1],z=Object(s.useState)(!1),q=i()(z,2),V=q[0],U=q[1],J=Object(s.useRef)(),K=Object(T.o)();if(Object(s.useEffect)((function(){var e=function(){if(J.current&&f.length>0){var e=Object(y.a)(B,J),t=e.left,n=e.top;if(V){if("Free text"===B.Subject){var o=function(e,t){var n=Number(t.X+t.Width),o=t.getWidth();return K&&K.width<1050?n>490?Math.abs(e-400):e+o/2+45:K&&K.width<1500&&n>450?Math.abs(e-o-400):e+o/2+45}(t,B),a=function(e){return e<0?200:K&&K.height<700&&e>240?240:K&&K.width<1050&&e>180?e-50:e}(n);return void k({left:o,top:a})}if(t>1080)return void k({left:1080,top:n})}k({left:t,top:n}),setTimeout((function(){var e=B.Subject===C.g.COMMENT&&B.getCustomData(x.b.HIGHLIGHT_TEXT.key);B.Subject===C.g.HIGHLIGHT&&B.getCustomData(x.b.IS_HIGHLIGHT_COMMENT.key)||e||O(E.a.openElement("annotationPopup"))}),0)}};(B&&B.Subject!==C.g.COMMENT||V)&&e();var t=function(t){B&&(g.default.getAnnotationByMouseEvent(t)===B&&B.Subject!==C.g.COMMENT&&e())},n=function(t,n){"modify"===n&&e()},o=function(){B&&W(g.default.canModify(B))};return g.default.addEventListener("mouseLeftUp",t),g.default.addEventListener("annotationChanged",n),g.default.addEventListener("updateAnnotationPermission",o),function(){g.default.removeEventListener("mouseLeftUp",t),g.default.removeEventListener("annotationChanged",n),g.default.removeEventListener("updateAnnotationPermission",o)}}),[O,F,B,V,f]),Object(s.useEffect)((function(){var e=function(){O(E.a.closeElement("annotationPopup")),k({left:0,top:0}),H(null),W(!1),U(!1)};c!==P&&e();var t=function(t,n){if(null===t||void 0===t||!t.length||!t[0].isReply())if("selected"===n&&t.length){if(t.some((function(e){return e.Subject===C.g.HIGHLIGHT}))){var o=g.default.getAnnotationManager().getAnnotationsList(),a=[];t.forEach((function(e){if(e.Subject===C.g.HIGHLIGHT&&e.getCustomData(x.b.IS_HIGHLIGHT_COMMENT.key)){var t=o.find((function(t){return t.Id===e.getCustomData(x.b.STICKY_ID.key)}));a.push(t)}})),g.default.selectAnnotations(a)}H(t[0]),W(g.default.canModify(t[0]))}else e()};return g.default.addEventListener("annotationSelected",t),g.default.addEventListener("documentUnloaded",e),window.addEventListener("resize",e),function(){g.default.removeEventListener("annotationSelected",t),g.default.removeEventListener("documentUnloaded",e),window.removeEventListener("resize",e)}}),[O,c,p]),n||!B)return null;var X=Object(j.a)(B),Q=Object.keys(X).length>0,Y=g.default.isAnnotationRedactable(B),Z=g.default.getSelectedAnnotations(),$=Z.length,ee=1===g.default.getNumberOfGroups(Z)&&$>1,te=$>1,ne=function(){c?(O(E.a.setActiveLeftPanel("notesPanel")),O(E.a.triggerNoteEditing())):(O(E.a.openElement("notesPanel")),setTimeout((function(){O(E.a.triggerNoteEditing())}),400)),O(E.a.closeElement("searchPanel")),O(E.a.closeElement("annotationPopup"))},oe=Boolean(B&&"Comment"===B.Subject),ae=Boolean(B&&B.getCustomData(x.b.IS_HIGHLIGHT_COMMENT.key));return l.a.createElement("div",{className:u()({Popup:!0,AnnotationPopup:!0,open:o&&!oe,closed:!o,stylePopupOpen:V,"AnnotationPopup--comment":oe&&!V}),ref:J,"data-element":"annotationPopup",style:D({},R)},V?l.a.createElement(b.a,{annotation:B,style:X,isOpen:o}):l.a.createElement(l.a.Fragment,null,oe||ae?null:l.a.createElement(h.a,{dataElement:"annotationPopup"},!a&&!Y&&(!te||ee)&&"CropPage"!==B.ToolName&&l.a.createElement(m.a,{dataElement:"annotationCommentButton",title:"component.notesPanel",icon:"basic-notes",onClick:ne}),F&&Q&&!r&&!te&&"CropPage"!==B.ToolName&&l.a.createElement(m.a,{dataElement:"annotationStyleEditButton",title:"action.style",icon:"palette",onClick:function(){v.annotationStyleEditButton||U(!0)}}),Y&&!te&&l.a.createElement(m.a,{dataElement:"annotationRedactButton",title:"action.apply",icon:"check",onClick:function(){var e;O((e=B,function(t){return g.default.isWebViewerServerDocument()?w(e,t):S(e,t)})),O(E.a.closeElement("annotationPopup"))}}),F&&l.a.createElement(m.a,{dataElement:"annotationDeleteButton",title:"action.delete",icon:"trash",onClick:function(){g.default.deleteAnnotations(g.default.getSelectedAnnotations(),{}),O(E.a.closeElement("annotationPopup"))}}))))}));t.default=L},"./src/lumin-components/AnnotationStylePopup/index.js":function(e,t,n){"use strict";var o=n("./src/redux/actions/index.js"),a=n("./src/redux/selectors/index.js"),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=n.n(i),l=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),u=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=n.n(u),p=n("./node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(p),m=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),b=n.n(m),h=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=n.n(h),y=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),j=n.n(y),v=n("./node_modules/react/index.js"),E=n.n(v),P=n("./node_modules/prop-types/index.js"),O=n.n(P),x=n("./node_modules/lodash/debounce.js"),w=n.n(x),S=n("./src/lumin-components/StylePalette/index.js"),C=n("./src/core/index.js"),A=n("./src/helpers/getClassName.js"),T=n("./src/helpers/device.js"),I=n("./src/constants/map.js");function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=g()(e);if(t){var a=g()(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return b()(this,n)}}var L={isDisabled:O.a.bool,annotation:O.a.object.isRequired,style:O.a.object.isRequired,closeElement:O.a.func.isRequired,placement:O.a.string},R=function(e){f()(n,e);var t=D(n);function n(e){var o;return s()(this,n),o=t.call(this,e),j()(d()(o),"handleStyleChange",(function(e,t){var n=o.props.annotation;C.default.setAnnotationStyles(n,j()({},e,t))})),j()(d()(o),"handleClick",(function(e){Object(T.m)()&&e.target===e.currentTarget&&o.props.closeElement("annotationPopup")})),o.debounceHandleStyleChange=w()(o.handleStyleChange,500),o}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.isDisabled,n=e.annotation,o=e.style,a=e.placement,r=n instanceof window.Annotations.FreeTextAnnotation&&n.getIntent()===window.Annotations.FreeTextAnnotation.Intent.FreeText,i="Signature"===n.Subject&&n instanceof window.Annotations.StampAnnotation,s=Object(A.a)("Popup AnnotationStylePopup",this.props),l=n instanceof window.Annotations.StampAnnotation,c=Object(I.c)(n);return t?null:E.a.createElement("div",{className:s,"data-element":"annotationStylePopup",onClick:this.handleClick},E.a.createElement(S.a,{colorMapKey:c,style:o,isFreeText:r,isSignature:i,annotation:n,onStyleChange:this.debounceHandleStyleChange,hideDivider:l,isAnnotationStylePopup:!0,placement:a}))}}]),n}(E.a.Component);R.propTypes=L,R.defaultProps={isDisabled:!1,placement:"bottom"};var k=R,_={closeElement:o.a.closeElement};t.a=Object(r.c)((function(e){return{isDisabled:a.a.isElementDisabled(e,"annotationStylePopup")}}),_)(k)},"./src/lumin-components/CustomizablePopup/index.js":function(e,t,n){"use strict";var o=n("./node_modules/react-redux/es/index.js"),a=n("./src/redux/selectors/index.js"),r=n("./node_modules/@babel/runtime/helpers/extends.js"),i=n.n(r),s=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),l=n.n(s),c=n("./node_modules/react/index.js"),u=n.n(c),d=n("./node_modules/prop-types/index.js"),p=n.n(d),f=n("./src/lumin-components/ToolButton/index.js"),m=n("./src/lumin-components/ToolGroupButton/index.js"),b=n("./src/lumin-components/ToggleElementButton/index.js"),h=n("./src/lumin-components/ActionButton/index.js"),g=n("./src/lumin-components/StatefulButton/index.js"),y=n("./src/lumin-components/CustomElement/index.js");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={dataElement:p.a.string.isRequired,children:p.a.arrayOf(p.a.any).isRequired,getItems:p.a.func.isRequired},P=function(e){var t=e.dataElement,n=e.children,o=(0,e.getItems)(t),a=u.a.Children.toArray(n);return o.map((function(e,t){var n=e.dataElement,o=e.type,r=e.hidden,s="".concat(o,"-").concat(n||t),l=null===r||void 0===r?void 0:r.map((function(e){return"hide-in-".concat(e)})).join(" "),c=a.find((function(e){return e.props.dataElement===n}));if(!c){var d=v(v({},e),{},{mediaQueryClassName:l});"toolButton"===o&&(c=u.a.createElement(f.a,d)),"toolGroupButton"===o&&(c=u.a.createElement(m.a,d)),"toggleElementButton"===o&&(c=u.a.createElement(b.a,d)),"actionButton"===o&&(c=u.a.createElement(h.a,d)),"statefulButton"===o&&(c=u.a.createElement(g.a,d)),"customElement"===o&&(c=u.a.createElement(y.a,d)),"spacer"!==o&&"divider"!==o||(c=u.a.createElement("div",i()({className:"".concat(o," ").concat(l)},d)))}return c?u.a.cloneElement(c,{key:s}):null}))};P.propTypes=E;var O=P;t.a=Object(o.c)((function(e){return{getItems:function(t){return a.a.getPopupItems(e,t)}}}))(O)}}]);