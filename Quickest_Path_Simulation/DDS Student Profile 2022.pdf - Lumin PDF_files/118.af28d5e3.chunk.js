(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{"./src/lumin-components/SearchOverlay/index.js":function(e,t,a){"use strict";a.r(t);var s=a("./node_modules/react-redux/es/index.js"),r=a("./node_modules/react-onclickoutside/dist/react-onclickoutside.es.js"),n=a("./node_modules/recompose/dist/Recompose.esm.js"),c=a("./node_modules/react-i18next/dist/es/withTranslation.js"),i=a("./src/redux/actions/index.js"),l=a("./src/redux/selectors/index.js"),o=a("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=a.n(o),h=a("./node_modules/@babel/runtime/helpers/createClass.js"),d=a.n(h),S=a("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=a.n(S),m=a("./node_modules/@babel/runtime/helpers/inherits.js"),f=a.n(m),v=a("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=a.n(v),R=a("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=a.n(R),E=a("./node_modules/@babel/runtime/helpers/defineProperty.js"),C=a.n(E),x=a("./node_modules/react/index.js"),I=a.n(x),O=a("./node_modules/prop-types/index.js"),P=a.n(O),y=a("./node_modules/classnames/index.js"),W=a.n(y),w=a("./node_modules/@material-ui/core/esm/FormControlLabel/FormControlLabel.js"),D=a("./node_modules/@material-ui/styles/esm/withStyles/withStyles.js"),j=a("./src/lumin-components/Icomoon/index.js"),k=a("./src/lumin-components/Tooltip/index.js"),A=a("./src/lumin-components/CustomCheckbox/index.js"),N=a("./src/lumin-components/ButtonMaterial/index.js"),_=a("./src/core/index.js"),F=a("./node_modules/lodash/debounce.js"),T=a.n(F),q=a("./src/constants/defaultTool.js");function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,s=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(s,arguments,r)}else a=s.apply(this,arguments);return g()(this,a)}}var L=Object(D.a)({root:{marginLeft:-9},label:{fontSize:14,marginLeft:-4}})(w.a),V={isOpen:P.a.bool,isDisabled:P.a.bool,isSearchPanelOpen:P.a.bool,isSearchPanelDisabled:P.a.bool,searchValue:P.a.string,isCaseSensitive:P.a.bool,isWholeWord:P.a.bool,setWildcard:P.a.func.isRequired,isSearchUp:P.a.bool,isAmbientString:P.a.bool,isWildcard:P.a.bool,isRegex:P.a.bool,results:P.a.arrayOf(P.a.object),activeResult:P.a.object,activeResultIndex:P.a.number,isProgrammaticSearch:P.a.bool,isProgrammaticSearchFull:P.a.bool,searchListeners:P.a.arrayOf(P.a.func),openElement:P.a.func.isRequired,closeElement:P.a.func.isRequired,closeElements:P.a.func.isRequired,setSearchValue:P.a.func.isRequired,setActiveResult:P.a.func.isRequired,setActiveResultIndex:P.a.func.isRequired,setIsSearching:P.a.func.isRequired,resetSearch:P.a.func.isRequired,addResult:P.a.func.isRequired,setCaseSensitive:P.a.func.isRequired,setWholeWord:P.a.func.isRequired,setNoResult:P.a.func.isRequired,setIsProgrammaticSearch:P.a.func.isRequired,setIsProgrammaticSearchFull:P.a.func.isRequired,isShowTopBar:P.a.bool,t:P.a.func,setSearchError:P.a.func.isRequired,isPageEditMode:P.a.bool},U=function(e){f()(a,e);var t=M(a);function a(){var e;return u()(this,a),e=t.call(this),C()(p()(e),"handleSearchError",(function(t){var a=e.props,s=a.setIsSearching,r=a.setSearchError;s(!1),t&&t.message&&r(t.message)})),C()(p()(e),"handleClickOutside",(function(t){var a=e.props,s=a.closeElements,r=a.isSearchPanelOpen,n="searchButton"===t.target.getAttribute("data-element");r||n||s(["searchOverlay"])})),C()(p()(e),"clearSearchResults",(function(){_.default.clearSearchResults(),e.props.resetSearch()})),C()(p()(e),"executeFullSearch",(function(){var t=e.props,a=t.searchValue,s=t.addResult,r=t.setIsSearching,n=t.setNoResult,c=t.setActiveResultIndex,i=e.getSearchMode(true),l=-1,o=!0,u=!0,h=function(t){var a=t.resultCode===_.default.CoreControls.Search.ResultCode.FOUND,i=t.resultCode===_.default.CoreControls.Search.ResultCode.DONE;a&&(l++,u=!1,s(t),_.default.displayAdditionalSearchResult(t),o&&e.isActiveResult(t)&&(o=!1,c(l),_.default.setActiveSearchResult(t))),i&&(r(!1),n(u),e.runSearchListeners())};r(!0);var d={fullSearch:true,onResult:h,onPageEnd:h,onDocumentEnd:h,onError:e.handleSearchError.bind(p()(e))};_.default.textSearchInit(a,i,d)})),C()(p()(e),"getSearchMode",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.props,s=a.isCaseSensitive,r=a.isWholeWord,n=a.isWildcard,c=a.isRegex,i=a.isSearchUp,l=a.isAmbientString,o=_.default.getSearchMode(),u=o.CASE_SENSITIVE,h=o.WHOLE_WORD,d=o.WILD_CARD,S=o.REGEX,p=o.PAGE_STOP,m=o.HIGHLIGHT,f=o.SEARCH_UP,v=o.AMBIENT_STRING,g=p|m;return s&&(g|=u),r&&(g|=h),n&&(g|=d),c&&(g|=S),i&&!t&&(g|=f),(l||t)&&(g|=v),g})),C()(p()(e),"isActiveResult",(function(t){var a=e.props.activeResult;if(!a)return!0;var s=a.pageNum===t.pageNum,r=Object.values(a.quads[0]).toString()===Object.values(t.quads[0]).toString();return s&&r})),C()(p()(e),"executeSingleSearch",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.props,s=a.searchValue,r=a.setActiveResult,n=a.setIsSearching,c=a.addResult,i=a.resetSearch,l=t?e.getSearchMode()|_.default.getSearchMode().SEARCH_UP:e.getSearchMode(),o=!1;e.currentSingleSearchTerm!==s&&(e.currentSingleSearchTerm=s,e.foundSingleSearchResult=!1,_.default.clearSearchResults()),i();var u=function(t){var a=t.resultCode===_.default.CoreControls.Search.ResultCode.FOUND,s=t.resultCode===_.default.CoreControls.Search.ResultCode.DONE;a?(e.foundSingleSearchResult=!0,c(t),_.default.displaySearchResult(t),r(t),e.runSearchListeners()):_.default.clearSearchResults(),s&&_.default.docViewer.trigger("endOfDocumentResult",!0),n(!1)};n(!0);var h={fullSearch:o,onResult:u,onPageEnd:u,onDocumentEnd:u,onError:e.handleSearchError.bind(p()(e))};_.default.textSearchInit(s,l,h)})),C()(p()(e),"runSearchListeners",(function(){var t=e.props,a=t.searchValue,s=t.searchListeners,r=t.isCaseSensitive,n=t.isWholeWord,c=t.isWildcard,i=t.isRegex,l=t.isAmbientString,o=t.isSearchUp,u=t.results;s.forEach((function(e){e(a,{caseSensitive:r,wholeWord:n,wildcard:c,regex:i,searchUp:o,ambientString:l},u)}))})),C()(p()(e),"onChange",(function(t){var a=e.props.setSearchValue,s=t.target.value;a(s),s.trim()?(e.clearSearchResults(),e.executeDebouncedFullSearch()):e.clearSearchResults()})),C()(p()(e),"onKeyDown",(function(t){var a=!e.props.isSearchPanelDisabled&&(t.metaKey||t.ctrlKey)&&13===t.which;t.shiftKey&&13===t.which?e.onClickPrevious(t):a?e.onClickOverflow(t):13===t.which&&e.onClickNext(t)})),C()(p()(e),"onClickNext",(function(t){t.preventDefault();var a=e.props,s=a.activeResultIndex,r=a.results,n=a.setActiveResultIndex;if(0!==r.length){var c=s===r.length-1?0:s+1;n(c),_.default.setActiveSearchResult(r[c])}})),C()(p()(e),"onClickPrevious",(function(t){t.preventDefault();var a=e.props,s=a.activeResultIndex,r=a.results,n=a.setActiveResultIndex;if(0!==r.length){var c=s<=0?r.length-1:s-1;n(c),_.default.setActiveSearchResult(r[c])}})),C()(p()(e),"onClickOverflow",(function(){var t=e.props,a=t.activeResult,s=t.openElement,r=t.closeElement,n=t.setActiveResult;s("searchPanel"),r("rightPanel"),e.clearSearchResults(),n(a),e.executeFullSearch()})),C()(p()(e),"onChangeCaseSensitive",(function(t){e.props.setCaseSensitive(t.target.checked),e.clearSearchResults(),e.executeDebouncedFullSearch()})),C()(p()(e),"onChangeWholeWord",(function(t){e.props.setWholeWord(t.target.checked),e.clearSearchResults(),e.executeDebouncedFullSearch()})),C()(p()(e),"focusSearchInput",(function(){e.setState({isSearchFocusing:!0})})),C()(p()(e),"blurSearchInput",(function(){e.setState({isSearchFocusing:!1})})),C()(p()(e),"onChangeWildcard",(function(t){e.props.setWildcard(t.target.checked),e.clearSearchResults(),e.executeDebouncedFullSearch()})),e.state={isSearchFocusing:!1},e.searchTextInput=I.a.createRef(),e.wholeWordInput=I.a.createRef(),e.caseSensitiveInput=I.a.createRef(),e.wildcardInput=I.a.createRef(),e.executeDebouncedSingleSearch=T()(e.executeSingleSearch,300),e.executeDebouncedFullSearch=T()(e.executeFullSearch,300),e.currentSingleSearchTerm="",e.foundSingleSearchResult=!1,e}return d()(a,[{key:"componentDidMount",value:function(){this.searchTextInput.current.focus()}},{key:"componentDidUpdate",value:function(e){this.props.isProgrammaticSearch?(this.clearSearchResults(),this.executeSingleSearch(),this.props.setIsProgrammaticSearch(!1)):this.props.isProgrammaticSearchFull&&(this.caseSensitiveInput.current.checked=this.props.isCaseSensitive,this.wholeWordInput.current.checked=this.props.isWholeWord,this.wildcardInput.current&&(this.wildcardInput.current.checked=this.props.isWildcard),this.clearSearchResults(),this.executeFullSearch(),this.props.setIsProgrammaticSearchFull(!1)),!e.isOpen&&this.props.isOpen&&(this.props.closeElements(["toolsOverlay","viewControlsOverlay","menuOverlay","toolStylePopup","signatureOverlay","zoomOverlay","redactionOverlay"]),this.searchTextInput.current.focus(),_.default.setToolMode(q.a)),e.isOpen&&!this.props.isOpen&&(this.props.closeElement("searchPanel"),this.clearSearchResults())}},{key:"componentWillUnmount",value:function(){this.clearSearchResults()}},{key:"render",value:function(){var e=this.state.isSearchFocusing,t=this.props,a=t.isDisabled,s=t.isSearchPanelOpen,r=t.isSearchPanelDisabled,n=t.results,c=t.searchValue,i=t.activeResultIndex,l=t.isShowTopBar,o=t.t,u=t.isOpen,h=t.isPageEditMode;if(a)return null;var d=W()("Overlay SearchOverlay",{transformed:s,"SearchOverlay--no-topbar":!l,open:u||!h,closed:!u||h});return I.a.createElement("div",{className:d,"data-element":"searchOverlay",onClick:function(e){return e.stopPropagation()}},I.a.createElement("div",{className:"wrapper"},I.a.createElement("div",{className:"SearchOverlay__arrow"},I.a.createElement("div",{className:"SearchOverlay__arrow-white"})),I.a.createElement("div",{className:"main"},I.a.createElement("div",{className:"input-wrapper"},I.a.createElement(j.a,{className:"search ".concat(e?"icon-search--focusing":"")}),I.a.createElement("input",{ref:this.searchTextInput,type:"text",autoComplete:"off",onChange:this.onChange,onKeyDown:this.onKeyDown,value:c,onFocus:this.focusSearchInput,onBlur:this.blurSearchInput,className:"SearchOverlay__input"})),I.a.createElement("div",{className:"number-of-results ".concat(e?"number-of-results--focusing":"")},s&&I.a.createElement("div",null,"".concat(i+1," / ").concat(n.length))),I.a.createElement(N.a,{className:"button previous ".concat(e?"button--focusing":""),onClick:this.onClickPrevious},I.a.createElement(j.a,{className:"prev-page"})),I.a.createElement(N.a,{className:"button next ".concat(e?"button--focusing":""),onClick:this.onClickNext},I.a.createElement(j.a,{className:"next-page"})),I.a.createElement(k.a,{content:"action.showMoreResults",location:"left"},I.a.createElement("div",{className:"advanced ".concat(s||r?"hidden":""),onClick:this.onClickOverflow},I.a.createElement(j.a,{className:"more-v"})))),I.a.createElement("div",{className:"options ".concat(s?"visible":"")},I.a.createElement(L,{control:I.a.createElement(A.a,{id:"case-sensitive-option",type:"checkbox",onChange:this.onChangeCaseSensitive,ref:this.caseSensitiveInput}),label:o("option.searchPanel.caseSensitive")}),I.a.createElement(L,{control:I.a.createElement(A.a,{id:"whole-word-option",type:"checkbox",onChange:this.onChangeWholeWord,ref:this.wholeWordInput}),label:o("option.searchPanel.wholeWordOnly")}))))}}]),a}(I.a.PureComponent);U.propTypes=V,U.defaultProps={isOpen:!1,isDisabled:!1,isSearchPanelOpen:!1,isSearchPanelDisabled:!1,searchValue:"",isCaseSensitive:!1,isWholeWord:!1,isSearchUp:!1,isAmbientString:!1,isWildcard:!1,isRegex:!1,results:[],activeResult:{},activeResultIndex:-1,isProgrammaticSearch:!1,isProgrammaticSearchFull:!1,searchListeners:[],isShowTopBar:!1,t:function(){},isPageEditMode:!1};var B=U,H={openElement:i.a.openElement,openElements:i.a.openElements,closeElement:i.a.closeElement,closeElements:i.a.closeElements,setSearchValue:i.a.setSearchValue,setActiveResult:i.a.setActiveResult,setActiveResultIndex:i.a.setActiveResultIndex,setIsSearching:i.a.setIsSearching,resetSearch:i.a.resetSearch,addResult:i.a.addResult,setCaseSensitive:i.a.setCaseSensitive,setWholeWord:i.a.setWholeWord,setWildcard:i.a.setWildcard,setNoResult:i.a.setNoResult,setSearchError:i.a.setSearchError,setIsProgrammaticSearch:i.a.setIsProgrammaticSearch,setIsProgrammaticSearchFull:i.a.setIsProgrammaticSearchFull};t.default=Object(n.a)(Object(s.c)((function(e){return{isSearchPanelOpen:l.a.isElementOpen(e,"searchPanel"),isSearchPanelDisabled:l.a.isElementDisabled(e,"searchPanel"),isWildCardSearchDisabled:l.a.isElementDisabled(e,"wildCardSearchOption"),searchValue:l.a.getSearchValue(e),isCaseSensitive:l.a.isCaseSensitive(e),isWholeWord:l.a.isWholeWord(e),isAmbientString:l.a.isAmbientString(e),isSearchUp:l.a.isSearchUp(e),isWildcard:l.a.isWildcard(e),isRegex:l.a.isRegex(e),results:l.a.getResults(e),activeResult:l.a.getActiveResult(e),activeResultIndex:l.a.getActiveResultIndex(e),isProgrammaticSearch:l.a.isProgrammaticSearch(e),isProgrammaticSearchFull:l.a.isProgrammaticSearchFull(e),searchListeners:l.a.getSearchListeners(e),isDisabled:l.a.isElementDisabled(e,"searchOverlay"),isOpen:l.a.isElementOpen(e,"searchOverlay"),isShowTopBar:l.a.getIsShowTopBar(e),isPageEditMode:l.a.isPageEditMode(e)}}),H),Object(c.a)())(Object(r.a)(B))}}]);