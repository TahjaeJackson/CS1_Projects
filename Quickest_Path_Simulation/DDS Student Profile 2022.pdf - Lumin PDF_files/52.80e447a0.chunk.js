(window.webpackJsonp=window.webpackJsonp||[]).push([[52,2],{"./node_modules/react-measure/dist/index.esm.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/esm/extends.js"),o=n("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),r=n("./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("./node_modules/react/index.js"),l=n("./node_modules/prop-types/index.js"),s=n.n(l),c=n("./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js"),u=["client","offset","scroll","bounds","margin"];function d(e){var t=[];return u.forEach((function(n){e[n]&&t.push(n)})),t}function m(e,t){var n={};if(t.indexOf("client")>-1&&(n.client={top:e.clientTop,left:e.clientLeft,width:e.clientWidth,height:e.clientHeight}),t.indexOf("offset")>-1&&(n.offset={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}),t.indexOf("scroll")>-1&&(n.scroll={top:e.scrollTop,left:e.scrollLeft,width:e.scrollWidth,height:e.scrollHeight}),t.indexOf("bounds")>-1){var a=e.getBoundingClientRect();n.bounds={top:a.top,right:a.right,bottom:a.bottom,left:a.left,width:a.width,height:a.height}}if(t.indexOf("margin")>-1){var o=getComputedStyle(e);n.margin={top:o?parseInt(o.marginTop):0,right:o?parseInt(o.marginRight):0,bottom:o?parseInt(o.marginBottom):0,left:o?parseInt(o.marginLeft):0}}return n}function p(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||window}var f=function(e){return function(t){var n,l;return l=n=function(n){function l(){for(var t,a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=n.call.apply(n,[this].concat(o))||this).state={contentRect:{entry:{},client:{},offset:{},scroll:{},bounds:{},margin:{}}},t._animationFrameID=null,t._resizeObserver=null,t._node=null,t._window=null,t.measure=function(n){var a=m(t._node,e||d(t.props));n&&(a.entry=n[0].contentRect),t._animationFrameID=t._window.requestAnimationFrame((function(){null!==t._resizeObserver&&(t.setState({contentRect:a}),"function"===typeof t.props.onResize&&t.props.onResize(a))}))},t._handleRef=function(e){null!==t._resizeObserver&&null!==t._node&&t._resizeObserver.unobserve(t._node),t._node=e,t._window=p(t._node);var n=t.props.innerRef;n&&("function"===typeof n?n(t._node):n.current=t._node),null!==t._resizeObserver&&null!==t._node&&t._resizeObserver.observe(t._node)},t}Object(r.a)(l,n);var s=l.prototype;return s.componentDidMount=function(){this._resizeObserver=null!==this._window&&this._window.ResizeObserver?new this._window.ResizeObserver(this.measure):new c.default(this.measure),null!==this._node&&(this._resizeObserver.observe(this._node),"function"===typeof this.props.onResize&&this.props.onResize(m(this._node,e||d(this.props))))},s.componentWillUnmount=function(){null!==this._window&&this._window.cancelAnimationFrame(this._animationFrameID),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)},s.render=function(){var e=this.props,n=(e.innerRef,e.onResize,Object(o.a)(e,["innerRef","onResize"]));return Object(i.createElement)(t,Object(a.a)({},n,{measureRef:this._handleRef,measure:this.measure,contentRect:this.state.contentRect}))},l}(i.Component),n.propTypes={client:s.a.bool,offset:s.a.bool,scroll:s.a.bool,bounds:s.a.bool,margin:s.a.bool,innerRef:s.a.oneOfType([s.a.object,s.a.func]),onResize:s.a.func},l}}()((function(e){var t=e.measure,n=e.measureRef,a=e.contentRect;return(0,e.children)({measure:t,measureRef:n,contentRect:a})}));f.displayName="Measure",f.propTypes.children=s.a.func,t.a=f},"./src/constants/dataElement.js":function(e,t,n){"use strict";t.a={COLOR_PALETTE:"colorPalette",OPACITY_SLIDER:"opacitySlider",STROKE_THICKNESS_SLIDER:"strokeThicknessSlider",FONT_SIZE_SLIDER:"fontSizeSlider",STYLE_OPTION:"styleOption",STYLE_POPUP:"stylePopup",SCALE_INPUT_CONTAINER:"scaleInputContainer",PRECISION_INPUT_CONTAINER:"precisionInputContainer",ANNOTATION_POPUP:"annotationPopup",AREA_MEASUREMENT_TOOL_BUTTON:"areaMeasurementToolButton",ARROW_TOOL_BUTTON:"arrowToolButton",BOOKMARKS_PANEL:"bookmarksPanel",BOOKMARKS_PANEL_BUTTON:"bookmarksPanelButton",CLOUD_TOOL_BUTTON:"cloudToolButton",COUNT_MEASUREMENT_TOOL_BUTTON:"countMeasurementToolButton",CROP_TOOL_BUTTON:"cropToolButton",DISTANCE_MEASUREMENT_TOOL_BUTTON:"distanceMeasurementToolButton",ELLIPSE_MEASUREMENT_TOOL_BUTTON:"ellipseMeasurementToolButton",ELLIPSE_TOOL_BUTTON:"ellipseToolButton",ERASER_TOOL_BUTTON:"eraserToolButton",FILE_ATTACHMENT_TOOL_BUTTON:"fileAttachmentToolButton",FILE_PICKER_BUTTON:"filePickerButton",FILE_PICKER_HANDLER:"filePickerHandler",FREE_HANDTOOL_BUTTON:"freeHandToolButton",FREETEXT_TOOL_BUTTON:"freeTextToolButton",HIGHLIGHT_TOOL_BUTTON:"highlightToolButton",LAYERS_PANEL:"layersPanel",LAYERS_PANEL_BUTTON:"layersPanelButton",LINE_TOOL_BUTTON:"lineToolButton",LINK_BUTTON:"linkButton",MEASUREMENT_OVERLAY:"measurementOverlay",MEASUREMENT_TOOL_GROUP_BUTTON:"measurementToolGroupButton",PERIMETER_MEASUREMENT_TOOL_BUTTON:"perimeterMeasurementToolButton",POLYGON_TOOL_BUTTON:"polygonToolButton",POLYLINE_TOOL_BUTTON:"polylineToolButton",RECTANGLE_TOOL_BUTTON:"rectangleToolButton",RECTANGULAR_AREA_MEASUREMENT_TOOL_BUTTON:"rectangularAreaMeasurementToolButton",REDACTION_BUTTON:"redactionButton",REDO_BUTTON:"redoButton",RUBBER_STAMP_TOOL_BUTTON:"rubberStampToolButton",SHAPE_TOOL_GROUP_BUTTON:"shapeToolGroupButton",SIGNATURE_TOOL_BUTTON:"signatureToolButton",SQUIGGLY_TOOL_BUTTON:"squigglyToolButton",STAMP_TOOL_BUTTON:"stampToolButton",STICKY_TOOL_BUTTON:"stickyToolButton",STRIKEOUT_TOOL_BUTTON:"strikeoutToolButton",TEXT_HIGHLIGHT_TOOL_BUTTON:"textHighlightToolButton",TEXT_REDACT_TOOL_BUTTON:"textRedactToolButton",TEXT_SELECT_BUTTON:"textSelectButton",TEXT_SQUIGGLY_TOOL_BUTTON:"textSquigglyToolButton",TEXT_STRIKEOUT_TOOL_BUTTON:"textStrikeoutToolButton",TEXT_TOOL_GROUP_BUTTON:"textToolGroupButton",TEXT_UNDERLINE_TOOL_BUTTON:"textUnderlineToolButton",TOOLS_BUTTON:"toolsButton",UNDERLINE_TOOL_BUTTON:"underlineToolButton",UNDO_BUTTON:"undoButton",COPY_TEXT_BUTTON:"copyTextButton"}},"./src/helpers/getAnnotationStyles.js":function(e,t,n){"use strict";var a=n("./src/core/index.js");t.a=function(e){var t={};return["FillColor","StrokeColor","TextColor","Opacity","StrokeThickness","FontSize","Precision","Scale","Style","Font","FontStyle"].forEach((function(n){var a=e[n];null!==a&&void 0!==a&&(t[n]=e[n])})),"highlight"!==e.elementName||a.default.isBlendModeSupported(e.BlendMode)||(t.Opacity=null),e instanceof window.Annotations.RedactionAnnotation&&(t.Opacity=null,t.StrokeThickness=null,t.FontSize=null),t}},"./src/lumin-components/AnnotationStylePopup/index.js":function(e,t,n){"use strict";var a=n("./src/redux/actions/index.js"),o=n("./src/redux/selectors/index.js"),r=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(i),s=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(s),u=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(m),f=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=n.n(f),v=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=n.n(v),g=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=n.n(g),E=n("./node_modules/react/index.js"),O=n.n(E),C=n("./node_modules/prop-types/index.js"),S=n.n(C),T=n("./node_modules/lodash/debounce.js"),_=n.n(T),j=n("./src/lumin-components/StylePalette/index.js"),P=n("./src/core/index.js"),R=n("./src/helpers/getClassName.js"),N=n("./src/helpers/device.js"),w=n("./src/constants/map.js");function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return h()(this,n)}}var I={isDisabled:S.a.bool,annotation:S.a.object.isRequired,style:S.a.object.isRequired,closeElement:S.a.func.isRequired,placement:S.a.string},k=function(e){p()(n,e);var t=x(n);function n(e){var a;return l()(this,n),a=t.call(this,e),y()(d()(a),"handleStyleChange",(function(e,t){var n=a.props.annotation;P.default.setAnnotationStyles(n,y()({},e,t))})),y()(d()(a),"handleClick",(function(e){Object(N.m)()&&e.target===e.currentTarget&&a.props.closeElement("annotationPopup")})),a.debounceHandleStyleChange=_()(a.handleStyleChange,500),a}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.isDisabled,n=e.annotation,a=e.style,o=e.placement,r=n instanceof window.Annotations.FreeTextAnnotation&&n.getIntent()===window.Annotations.FreeTextAnnotation.Intent.FreeText,i="Signature"===n.Subject&&n instanceof window.Annotations.StampAnnotation,l=Object(R.a)("Popup AnnotationStylePopup",this.props),s=n instanceof window.Annotations.StampAnnotation,c=Object(w.c)(n);return t?null:O.a.createElement("div",{className:l,"data-element":"annotationStylePopup",onClick:this.handleClick},O.a.createElement(j.a,{colorMapKey:c,style:a,isFreeText:r,isSignature:i,annotation:n,onStyleChange:this.debounceHandleStyleChange,hideDivider:s,isAnnotationStylePopup:!0,placement:o}))}}]),n}(O.a.Component);k.propTypes=I,k.defaultProps={isDisabled:!1,placement:"bottom"};var A=k,L={closeElement:a.a.closeElement};t.a=Object(r.c)((function(e){return{isDisabled:o.a.isElementDisabled(e,"annotationStylePopup")}}),L)(A)},"./src/lumin-components/ListSeparator/index.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),o=n.n(a);var r=function(e){var t=e.selectedPage,n=e.currentPage;return o.a.createElement("div",{className:"ListSeparator ".concat(t==n?"active":"")},e.renderContent())};t.a=r},"./src/lumin-components/MaterialSelect/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("./node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),s=n.n(l),c=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(p),h=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=n.n(h),b=n("./node_modules/react/index.js"),g=n.n(b),y=n("./node_modules/prop-types/index.js"),E=n.n(y),O=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),C=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),S=n("./node_modules/@material-ui/core/esm/styles/withStyles.js"),T=n("./node_modules/lodash/capitalize.js"),_=n.n(T),j=n("./node_modules/classnames/index.js"),P=n.n(j),R=n("./src/lumin-components/Icomoon/index.js"),N=n("./src/lumin-components/LuminPlanLabel/index.js"),w=n("./src/constants/lumin-common.js"),x=n("./src/constants/styles/index.js"),I=n("./src/lumin-components/MaterialPopper/index.js");function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return m()(this,n)}}var A=Object(S.a)({disabledMenu:{"&:hover":{cursor:"auto",background:"inherit"}}}),L=function(e){u()(n,e);var t=k(n);function n(e){var a;return o()(this,n),a=t.call(this,e),v()(s()(a),"togglePopper",(function(){a.setState((function(e){return{popperShow:!e.popperShow}}))})),v()(s()(a),"closePopper",(function(e){a.anchorEl.contains(e.target)||a.setState({popperShow:!1})})),v()(s()(a),"onItemClick",(function(e){var t=a.props.onSelected;a.setState({popperShow:!1}),t(e)})),a.state={popperShow:!1},a}return i()(n,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.items,o=n.containerClasses,r=n.inputClasses,i=n.value,l=n.blankMessage,s=n.disabled,c=n.classes,u=n.childNameComponent,d=n.arrowStyle,m=this.state.popperShow,p=a.find((function(e){return e.value===i}));return g.a.createElement("div",{className:"MaterialSelect ".concat(o||""," ").concat(m?"MaterialSelect--focus":""," ").concat(s?"disabled":"")},g.a.createElement("div",{className:P()("MaterialSelect__input",(e={},v()(e,r,Boolean(r)),v()(e,"MaterialSelect__input--disabled",s),e)),onClick:s?null:function(){return t.togglePopper()},ref:function(e){t.anchorEl=e}},g.a.createElement("span",{className:"form__text--overflow ".concat(p&&p.class?p.class:"")},p?p.name:"- Choose one -"),g.a.createElement(R.a,{className:"dropdown icon__9 MaterialSelect__input__icon_dropdown",color:d.color,size:d.size})),g.a.createElement(I.a,{open:m,anchorEl:this.anchorEl,handleClose:this.closePopper,placement:"bottom",classes:"MaterialSelect__popper"},g.a.createElement(O.a,null,a.length>0?a.map((function(e){var n;return g.a.createElement(C.a,{className:"Menu__item ".concat(e.disabled?"disabled":""," ").concat(e.selected?"selected":""),key:JSON.stringify(e),onClick:e.disabled?null:function(){return t.onItemClick(e)}},g.a.createElement("div",{className:"item__container"},g.a.createElement("div",{className:"form__text--overflow ".concat(null!==(n=e.class)&&void 0!==n?n:"")},"".concat(e.name," ").concat(e.note?e.note:"")," ",e.value===i&&u),g.a.createElement("div",null,e.payment&&g.a.createElement(N.a,{label:_()(e.payment.type),entity:w.k.ORGANIZATION,payment:e.payment}))))})):g.a.createElement(C.a,{className:c.disabledMenu,disableRipple:!0},l||"Nothing to choose"))))}}]),n}(g.a.PureComponent);L.propTypes={items:E.a.array,containerClasses:E.a.string,inputClasses:E.a.string,value:E.a.any,blankMessage:E.a.oneOfType([E.a.string,E.a.node]),disabled:E.a.bool,onSelected:E.a.func,classes:E.a.object,childNameComponent:E.a.element,arrowStyle:E.a.shape({size:E.a.number,color:E.a.string})},L.defaultProps={items:[],containerClasses:"",inputClasses:"",value:0,blankMessage:"",disabled:!1,onSelected:function(){},classes:{},childNameComponent:g.a.createElement("div",null),arrowStyle:{size:16,color:x.b.PRIMARY}};var D=A(L);t.a=D},"./src/lumin-components/NoteCommentBox/CommentContext.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),o=n.n(a).a.createContext();t.a=o},"./src/lumin-components/NoteLumin/Context.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),o=n.n(a).a.createContext();t.a=o},"./src/lumin-components/NoteLumin/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/regenerator/index.js"),o=n.n(a),r=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(r),l=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),s=n.n(l),c=n("./node_modules/react/index.js"),u=n.n(c),d=n("./node_modules/classnames/index.js"),m=n.n(d),p=n("./node_modules/prop-types/index.js"),f=n.n(p),h=n("./node_modules/react-redux/es/index.js"),v=n("./node_modules/@material-ui/core/esm/Button/Button.js"),b=n("./node_modules/@apollo/react-hoc/lib/react-hoc.esm.js"),g=n("./src/redux/store/index.js"),y=n("./src/lumin-components/NoteLumin/Context.js"),E=n("./src/lumin-components/NoteCommentBox/CommentContext.js"),O=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),C=n.n(O),S=n("./node_modules/react-i18next/dist/es/useTranslation.js"),T=n("./node_modules/autolinker/dist/es2015/index.js"),_=n("./node_modules/dayjs/dayjs.min.js"),j=n.n(_),P=n("./node_modules/dayjs/plugin/calendar.js"),R=n.n(P),N=n("./src/constants/lumin-common.js"),w=n("./node_modules/lodash/debounce.js"),x=n.n(w),I=n("./src/redux/selectors/index.js"),k=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),A=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),L=n("./src/lumin-components/MaterialPopper/index.js"),D=n("./src/lumin-components/MaterialAvatar/index.js"),M=n("./node_modules/@material-ui/core/esm/TextareaAutosize/TextareaAutosize.js"),B={value:f.a.string,placeholder:f.a.string,onChange:f.a.func.isRequired,onBlur:f.a.func,onFocus:f.a.func,onKeyDown:f.a.func,className:f.a.string,id:f.a.string},F=u.a.forwardRef((function(e,t){var n=e.value,a=void 0===n?"":n,o=e.onChange,r=e.onBlur,i=void 0===r?function(){}:r,l=e.onFocus,s=void 0===l?function(){}:l,d=e.onKeyDown,m=void 0===d?function(){}:d,p=e.placeholder,f=void 0===p?"":p,h=e.className,v=void 0===h?"":h,b=e.id,g=void 0===b?"":b,y=Object(c.useRef)(null);return u.a.createElement(M.a,{className:v,id:g,ref:function(e){y.current=e,t(e)},onBlur:i,onFocus:s,placeholder:f,onChange:o,onKeyDown:m,value:a})}));F.propTypes=B,F.defaultProps={value:"",placeholder:"",onBlur:function(){},onFocus:function(){},onKeyDown:function(){},className:"",id:""};var U=F;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={value:f.a.string,placeholder:f.a.string,onChange:f.a.func.isRequired,onBlur:f.a.func,onFocus:f.a.func,onSubmit:f.a.func,onKeyDown:f.a.func},q=u.a.forwardRef((function(e,t){var n=z(z({},e),{},{ref:function(e){t(e)},onChange:function(t){e.onChange(t)},onKeyDown:function(t){e.onKeyDown(t),(t.metaKey||t.ctrlKey)&&13===t.which&&e.onSubmit(t)}});return u.a.createElement(U,n)}));q.propTypes=K,q.defaultProps={value:"",placeholder:"",onBlur:function(){},onFocus:function(){},onSubmit:function(){},onKeyDown:function(){}};var G=q,V=n("./src/lumin-components/CircularLoading/index.js"),Y=n("./node_modules/@material-ui/core/esm/Grid/Grid.js"),W=n("./src/utils/index.js"),X=n("./src/services/graphServices/documentGraphServices.js"),J=n("./src/screens/Viewer/Context.js");Z.propTypes={className:f.a.string,currentUser:f.a.object,inputRef:f.a.object,onBlur:f.a.func,onChange:f.a.func,onFocus:f.a.func,onSubmit:f.a.func,placeholder:f.a.string,value:f.a.string,showAvatar:f.a.bool},Z.defaultProps={className:"",currentUser:{},inputRef:{},onBlur:function(){},onChange:function(){},onFocus:function(){},onSubmit:function(){},placeholder:"",value:"",showAvatar:!0};function Z(e){var t=e.className,n=e.placeholder,a=e.value,r=e.onFocus,l=e.onBlur,d=e.onChange,p=e.onSubmit,f=e.inputRef,h=e.currentUser,v=e.showAvatar,b=Object(c.useState)(!1),g=s()(b,2),y=g[0],E=g[1],O=Object(c.useRef)(),C=Object(c.useState)(!1),S=s()(C,2),T=S[0],_=S[1],j=Object(c.useState)(a||""),P=s()(j,2),R=P[0],N=P[1],w=Object(c.useState)(),I=s()(w,2),M=I[0],B=I[1],F=Object(c.useState)([]),U=s()(F,2),H=U[0],z=U[1],K=Object(c.useState)(0),q=s()(K,2),Z=q[0],Q=q[1],$=Object(c.useState)(0),ee=s()($,2),te=ee[0],ne=ee[1],ae=Object(c.useContext)(J.a).currentDocument,oe=Boolean(null===h||void 0===h?void 0:h._id),re=Object(c.useCallback)(x()(function(){var e=i()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe||!ae.documentReference||T){e.next=11;break}return _(!0),e.prev=2,e.next=5,X.a.getMentionList({documentId:ae._id,searchKey:t});case 5:n=e.sent,z(n);case 7:return e.prev=7,_(!1),E(!0),e.finish(7);case 11:case"end":return e.stop()}}),e,null,[[2,,7,11]])})));return function(t){return e.apply(this,arguments)}}(),500),[]);Object(c.useEffect)((function(){var e=ie(R,Z);"@"===e.charAt(0)?(re(e.slice(1)),ne(Z-e.length)):E(!1)}),[R]),Object(c.useEffect)((function(){a?N(a):(Q(0),ne(0),N(""))}),[a]),Object(c.useEffect)((function(){function e(){E(!1)}var t=document.getElementById("DocumentContainer");return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}),[]);var ie=function(e,t){var n=e.substring(0,t).split(/\s+/);return n[n.length-1]};var le=Object(c.useCallback)((function(){y||l()}),[]);return u.a.createElement("div",{className:"NoteInput__container"},v&&u.a.createElement(D.a,{size:28,src:h?W.d.getAvatar(h.avatarRemoteId):""},h?W.d.getTextAvatar(h.name):""),u.a.createElement("div",{className:"NoteInput",ref:function(e){return B(e)}},u.a.createElement(G,{className:"NoteInput__input",ref:function(e){f.current=e},onKeyDown:function(e){8===e.which&&e.stopPropagation(),32===e.which&&E(!1),(e.metaKey||e.shiftKey)&&50===e.which&&h&&(0!==R.length&&(" "!==R.charAt(Z)&&""!==R.charAt(Z)||" "!==R.charAt(Z-1)&&" "!==R.charAt(Z-2)&&"\n"!==R.charAt(Z-1)&&"\n"!==R.charAt(Z-2))||ne(Z)),y&&(38===e.keyCode&&Z>-1&&(f.current.blur(),O.current.focus()),40===e.keyCode&&Z<H.length-1&&(f.current.blur(),O.current.focus()))},value:R,onChange:function(e){e.preventDefault(),Q(e.target.selectionStart),function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=e.split(""),a=t.split(""),o=0;o<e.length;o++)if(n[o]!==a[o]&&"@"===n[o])return!0;return!1}(R,e.target.value)&&E(!1),N(e.target.value),d&&d(e.target.value)},onBlur:le,onSubmit:p,placeholder:n,onFocus:r})),y&&Boolean(H.length)&&u.a.createElement(L.a,{open:!0,disablePortal:!0,parentOverflow:"scrollParent",anchorEl:M,placement:"bottom",handleClose:function(){return E(!y)},classes:"NoteInput__popper ".concat(t||"")},u.a.createElement("div",{className:"NoteInput__popper-container"},u.a.createElement(k.a,{className:m()("NoteInput__user-list",{"NoteInput__user-list--disabled":T}),ref:O},H.map((function(e){return u.a.createElement(A.a,{onClick:function(){return function(e){var t="".concat(R.slice(0,te),"@").concat(e.email).concat(R.slice(Z));Q(0),N(t),E(!1),f.current.focus(),d(t)}(e)},className:"NoteInput__user-item",key:e._id},u.a.createElement(Y.a,{container:!0,alignItems:"center"},u.a.createElement(Y.a,{item:!0,xs:2},u.a.createElement(D.a,{size:28,src:W.d.getAvatar(e.avatarRemoteId),containerClasses:"comment-avatar"},W.d.getTextAvatar(e.name))),u.a.createElement(Y.a,{item:!0,xs:10,className:"NoteInput__user-item __info"},u.a.createElement("p",null,W.H.getShortStringWithLimit(e.name,30)," ",h&&e.id===h._id?"(You)":""),u.a.createElement("span",null,e.email))))}))),T&&u.a.createElement(V.a,{className:"NoteInput__loading",size:24}))))}var Q=Object(h.c)((function(e){return{currentUser:I.a.getCurrentUser(e),currentTeam:I.a.getCurrentTeam(e),currentFolderType:I.a.getCurrentFolderType(e),currentDocument:I.a.getCurrentDocument(e)}}))(Object(b.a)(Z)),$=n("./src/lumin-components/Icomoon/index.js"),ee=n("./src/lumin-components/AnnotationStylePopup/index.js"),te=n("./src/constants/documentConstants.js"),ne=n("./src/constants/customDataConstant.js"),ae=n("./src/constants/dataElement.js"),oe=n("./src/constants/commentState.js"),re=n("./src/helpers/getAnnotationStyles.js"),ie=n("./src/core/index.js"),le=n("./src/redux/actions/index.js"),se={annotation:f.a.object.isRequired,setIsEditing:f.a.func.isRequired,handleReopen:f.a.func,setIsShowDeleteOverlay:f.a.func,isResolved:f.a.bool,setIsNotOwnerComment:f.a.func,isCommentPanel:f.a.bool.isRequired},ce=function(e){var t=e.annotation,n=e.setIsEditing,a=e.handleReopen,o=e.setIsShowDeleteOverlay,r=e.isResolved,i=e.setIsNotOwnerComment,l=e.isCommentPanel,d=Object(h.f)((function(e){return[I.a.isElementDisabled(e,"notePopup"),I.a.isElementDisabled(e,"notePopupEdit"),I.a.isElementDisabled(e,"notePopupDelete")]}),h.d),m=s()(d,3),p=m[0],f=m[1],b=m[2],g=Object(c.useState)(ie.default.canModify(t)),O=s()(g,2),C=O[0],T=O[1],_=Object(c.useState)(ie.default.canModifyContents(t)),j=s()(_,2),P=j[0],R=j[1],N=Object(c.useState)(!1),w=s()(N,2),x=w[0],D=w[1],M=Object(c.useState)(!1),B=s()(M,2),F=B[0],U=B[1],H=Object(h.e)(),z=Object(S.a)(),K=s()(z,1)[0],q=Object(c.useRef)(),G=Object(c.useContext)(l?E.a:y.a),V=G.isInsideComment,Y=void 0!==V&&V,W=G.openCommentPanel,X=void 0===W?function(){}:W,J=G.disabledElements,Z=void 0===J?{}:J,Q=G.setIsFocusInput,se=t instanceof window.Annotations.FreeTextAnnotation,ce=t.isReply(),ue=t.getContents(),de=t.Subject===te.g.COMMENT;Object(c.useEffect)((function(){var e=function(){T(ie.default.canModify(t)),R(ie.default.canModifyContents(t))},n=!f&&ie.default.canModify(t),a=!b&&ie.default.canModifyContents(t);return i(!(n||a)||p),ie.default.addEventListener("updateAnnotationPermission",e),function(){return ie.default.removeEventListener("updateAnnotationPermission",e)}}),[t]),Object(c.useEffect)((function(){function e(){D(!1)}var t=document.getElementById("DocumentContainer");return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}),[]);return!(!f&&P)&&!(!b&&C)||p?null:u.a.createElement("div",{className:"NotePopup",onClick:function(e){return e.stopPropagation()}},u.a.createElement(v.a,{className:"square overflow  ".concat((x||F)&&"open"),"aria-label":"note",ref:function(e){return q.current=e},onMouseDown:function(){F&&(H(le.a.enableElement(ae.a.OPACITY_SLIDER)),U(!1)),D(!x)}},u.a.createElement($.a,{className:"more-v icon__16"})),u.a.createElement(L.a,{open:x,disablePortal:!0,parentOverflow:"window",anchorEl:q.current,handleClose:function(e){q.current.contains(e.target)||D(!1)},placement:"bottom-end",classes:"NotePopup__popper-comment"},u.a.createElement(k.a,null,!ce&&ie.default.getCurrentUser()===t.Author&&!(null!==Z&&void 0!==Z&&Z.annotationStyleEditButton)&&ue&&!r&&!t.getCustomData(ne.b.HIGHLIGHT_TEXT.key)&&de&&u.a.createElement(A.a,{onClick:function(){H(le.a.disableElement(ae.a.OPACITY_SLIDER)),D(!1),U(!0)}},u.a.createElement("span",{className:"icon-color"}),"Change color"),r&&!ce&&u.a.createElement(A.a,{onClick:function(){a(),D(!x)}},u.a.createElement($.a,{className:"reopen icon__16"}),"Reopen"),ie.default.getCurrentUser()===t.Author&&!r&&u.a.createElement(A.a,{onClick:function(){se?ie.default.getAnnotationManager().trigger("annotationDoubleClicked",t):setTimeout((function(){n(!0),Q(!0)}),0),D(!x)}},u.a.createElement($.a,{className:"edit icon__16"}),K("action.edit")),u.a.createElement(A.a,{onClick:function(){if(ce){if(ie.default.deleteAnnotations([t],{}),t.getState()===oe.a.Cancelled.state){var e=new window.Annotations.StickyAnnotation;e.InReplyTo=t.InReplyTo,e.X=t.X,e.Y=t.Y,e.PageNumber=t.PageNumber,e.Author=t.Author,e.setContents(""),e.setStateModel("Marked"),e.setState(oe.a.Rejected.state),e.DateCreated=t.DateCreated,t.addReply(e),ie.default.addAnnotations([e],{})}}else document.querySelector(".reply-container .NoteInput__container textarea").blur(),D(!1),o(!0)}},u.a.createElement($.a,{className:"trash icon__16"}),K("action.delete")),Y&&u.a.createElement(A.a,{onClick:function(){D(!1),X()}},u.a.createElement($.a,{className:"outlines icon__16"}),"Open Annotation"))),u.a.createElement(L.a,{open:F,disablePortal:!0,parentOverflow:"window",anchorEl:q.current,handleClose:function(e){q.current.contains(e.target)||(H(le.a.enableElement(ae.a.OPACITY_SLIDER)),U(!1))},placement:"bottom-end",classes:"NotePopup__popper-comment"},F?u.a.createElement("div",{className:"commentColorPalette"},u.a.createElement(ee.a,{placement:"bottom-end",annotation:t,style:Object(re.a)(t),isOpen:F})):u.a.createElement("div",null)))};ce.propTypes=se,ce.defaultProps={isResolved:!1,handleReopen:function(){},setIsShowDeleteOverlay:function(){},setIsNotOwnerComment:function(){}};var ue=ce,de=n("./src/lumin-components/ButtonMaterial/index.js"),me=n("./src/lumin-components/Tooltip/index.js"),pe=n("./src/helpers/MentionsManager.js"),fe=n("./src/constants/map.js"),he=n("./src/constants/plan.js"),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1?arguments[1]:void 0,n=Object(c.useRef)(!1);Object(c.useEffect)((function(){if(n.current)return e();n.current=!0}),t)};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}j.a.extend(R.a);var ye={sameDay:"[Today]",lastDay:"[Yesterday]",lastWeek:"[Last] dddd"},Ee={annotation:f.a.object.isRequired,isRightPanel:f.a.bool.isRequired,handleReopen:f.a.func,setIsShowDeleteOverlay:f.a.func,isResolved:f.a.bool,setCommentResolve:f.a.func,openSignInModal:f.a.func,userPlan:f.a.string},Oe=function(e){var t,n=e.annotation,a=e.isRightPanel,r=e.handleReopen,l=e.setIsShowDeleteOverlay,d=e.isResolved,p=e.isCommentPanel,f=e.setCommentResolve,b=e.openSignInModal,g=e.userPlan,O=Object(h.f)((function(e){return[I.a.getCurrentUser(e),I.a.getCurrentDocument(e),I.a.getSortStrategy(e),I.a.getNoteDateFormat(e),I.a.getIconColor(e,Object(fe.c)(n)),I.a.getIsNoteEditing(e)]}),h.d),C=s()(O,6),S=C[0],_=C[1],P=C[2],R=C[3],w=C[4],x=C[5],k=Object(c.useContext)(p?E.a:y.a),A=k.isSelected,L=k.searchInput,M=k.resize,B=k.isContentEditable,F=k.isFocusInput,U=k.setIsFocusInput,H=Object(c.useState)(""),z=s()(H,2),K=z[0],q=z[1],G=Object(c.useState)(""),V=s()(G,2),Y=V[0],X=V[1],J=Object(c.useState)(!1),Z=s()(J,2),Q=Z[0],ee=Z[1],ae=Object(c.useState)(!1),re=s()(ae,2),se=re[0],ce=re[1],de=Object(c.useRef)(null),be=Object(c.useRef)(null),Ee=Object(c.useState)(!0),Oe=s()(Ee,2),Ce=Oe[0],Te=Oe[1],_e=Object(c.useState)(!1),je=s()(_e,2),Pe=je[0],Re=je[1],Ne=n.getCustomData(ne.a.MENTION.key),we=Object(c.useState)(Ne?null===(t=JSON.parse(Ne))||void 0===t?void 0:t.contents:n.getContents()),xe=s()(we,2),Ie=xe[0],ke=xe[1],Ae=Object(h.e)(),Le=n.isReply(),De=0===n.getReplies().length,Me=n.Subject===te.g.COMMENT,Be=n instanceof window.Annotations.StickyAnnotation&&"Marked"===n.getStateModel(),Fe=!!Me&&n.getState()===oe.a.Cancelled.state,Ue=!!Me&&n.getState()===oe.a.Rejected.state,He=n.getCustomData(ne.b.HIGHLIGHT_TEXT.key),ze=!0,Ke=Object(c.useRef)();ve((function(){Q||Ae(le.a.finishNoteEditing()),M()}),[Q]),Object(c.useEffect)((function(){function e(){return(e=i()(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(n);case 2:return t=e.sent,e.next=5,Qe();case 5:a=e.sent,q(t),X(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Ke.current=setTimeout((function(){de.current&&be.current&&de.current.clientWidth+1<=be.current.clientWidth&&Te(!1)}),0),ze&&function(){e.apply(this,arguments)}(),ie.default.addEventListener("annotationChanged",Ge),ie.default.addEventListener("annotationSelected",Ve),function(){ze=!1,clearTimeout(Ke.current),ie.default.removeEventListener("annotationChanged",Ge),ie.default.removeEventListener("annotationSelected",Ve)}}),[]),Object(c.useEffect)((function(){n instanceof window.Annotations.FreeTextAnnotation&&!Y&&qe(),x&&A&&B&&ee(!0)}),[B,x,A]),Object(c.useEffect)((function(){A||ce(!1)}),[A]),Object(c.useEffect)((function(){qe()}),[n]);var qe=function(){var e=i()(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe();case 2:t=e.sent,X(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ge=function(){var e=i()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==t&&void 0!==t&&t[0]&&n&&t[0].Id===n.Id&&qe();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(e,t){"deselected"===t&&(ee(!1),U(!1),l(!1))},Ye=Object(c.useCallback)((function(e){A&&e.stopPropagation()}),[A]),We=function(){var e=i()(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","");case 2:if(n="string"===typeof t?t:t.Author,!W.M.validateEmail(n)){e.next=9;break}if(!S||n!==S.email){e.next=6;break}return e.abrupt("return",S.name);case 6:if(!(a=pe.a.getUserData()).some((function(e){return e.email===n}))){e.next=9;break}return e.abrupt("return",a.find((function(e){return e.email===n})).name);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=Object(c.useCallback)((function(e){return L.trim()?e.replace(new RegExp("(".concat(L,")"),"gi"),'<span class="highlight">$1</span>'):e.includes("Anonymous")?e.split("-")[0]:e}),[L]),Je=Object(c.useCallback)(function(){var e=i()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",u.a.createElement("span",{className:"author"},"no name"));case 5:return e.abrupt("return",u.a.createElement("span",{className:"author"},n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Xe]),Ze=function(){var e=i()(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(" "),e.next=3,Promise.all(n.map(function(){var e=i()(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\r|\n/),e.next=3,Promise.all(n.map(function(){var e=i()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.startsWith("@")||!W.M.validateEmail(t.slice(1))){e.next=9;break}return e.next=3,We(t.slice(1));case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",t);case 6:if(-1===n.search("@")){e.next=8;break}return e.abrupt("return",n);case 8:return e.abrupt("return",'<span class="mention">'.concat(n,"</span>"));case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return a=e.sent,e.abrupt("return",a.join("\n"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return a=e.sent,e.abrupt("return",a.join(" "));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qe=function(){var e=i()(o.a.mark((function e(){var t,a,r,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.getContents()){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Ze(t);case 5:return a=e.sent,-1!==T.a.link(a).indexOf("<a")?(r=T.a.link(a,{stripPrefix:!1}),a=r.replace(/>(.+)</i,(function(e,t){return">".concat(Xe(t),"<")}))):a=Xe(a),i=W.h.commentParser(a),l=function(e){var t=e.target.href,n=new URL(t),a=n.hostname.replace("www.",""),o=n.hostname.split(".");"luminpdf.com"!==a&&"luminpdf.com"!=="".concat(o[1],".").concat(o[2])&&(e.preventDefault(),Ae(le.a.openModal({type:N.A.WARNING,title:"You are leaving Lumin PDF",message:"Following this link opens a new browser tab and sends you to a website outside of Lumin PDF",cancelButtonTitle:"Cancel",confirmButtonTitle:"Proceed",onCancel:function(){return Ae(le.a.closeModal())},onConfirm:function(){window.open(n.href,"_blank").focus()},isFullWidthButton:!0})))},e.abrupt("return",u.a.createElement("span",{className:"contents"},i.map((function(e,t){return e.startsWith("<a")?u.a.createElement("span",{key:"".concat(t,"-").concat(n.Id),className:"links",onClick:l,dangerouslySetInnerHTML:{__html:e}}):u.a.createElement("span",{key:"".concat(t,"-").concat(n.Id),dangerouslySetInnerHTML:{__html:e}})}))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=Object(c.useCallback)((function(){var e,t={avatarRemoteId:"",name:""};if(!n)return t;if(e="string"===typeof n?n:n.Author,W.M.validateEmail(e))if(S&&e===S.email)t.avatarRemoteId=S.avatarRemoteId,t.name=S.name;else{var a=pe.a.getUserData();if(a.some((function(t){return t.email===e}))){var o=a.find((function(t){return t.email===e}));t.avatarRemoteId=o.avatarRemoteId,t.name=o.name}}return t}),[]),et=Object(c.useCallback)((function(){var e=Object(fe.b)(Object(fe.c)(n)).icon,t="Signature"!==n.Subject?w&&n[w].toHexString():null;if(e){var a="annotation-redact"===e?"basic-redaction":e;return"comment"===a?u.a.createElement(D.a,{size:28,src:W.d.getAvatar($e().avatarRemoteId)},W.d.getTextAvatar($e().name)):u.a.createElement($.a,{className:a,color:t,size:22})}return n.Subject}),[]),tt=function(){A&&ce(!se)},nt=function(){g===he.c.NO_PLAN?b():f(!0)},at=Object(c.useMemo)((function(){var e;if(Le)e=u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"type"},u.a.createElement(D.a,{size:28,src:W.d.getAvatar($e().avatarRemoteId)},W.d.getTextAvatar($e().name))),u.a.createElement("div",{className:"info-wrapper"},K,u.a.createElement("span",{className:"time"},"\n                ".concat(j()(n.DateCreated).calendar(null,ge(ge({},ye),{},{sameElse:R.split(",")[0]})),",\n                ").concat(j()(n.DateCreated).format(R.split(",")[1]),"\n              "))),A&&!d&&!Be&&!Ue&&u.a.createElement(ue,{isCommentPanel:p,annotation:n,setIsEditing:ee})));else{var t=n.getReplies().filter((function(e){return"Marked"!==e.getStateModel()&&e.getState()!==oe.a.Rejected.state})).length;e=u.a.createElement("div",{className:m()("title",{comment_added:Me&&!Y})},u.a.createElement("div",{className:"type"},et()),u.a.createElement("div",{className:"user-info"},K,u.a.createElement("div",{className:"time"},("time"!==P||A)&&j()(n.DateCreated||new Date).calendar(null,ge(ge({},ye),{},{sameElse:R.split(",")[0]})),","," ",j()(n.DateCreated).format(R.split(",")[1]),t>0&&u.a.createElement("span",{className:"reply-count"},u.a.createElement($.a,{className:"reply-count",size:16}),t))),Me&&Y&&!d&&u.a.createElement("div",{className:"check-resolved"},u.a.createElement(me.a,{content:"Mark as resolved",additionalClass:"note_tooltip_edit ".concat(Pe?"note_tooltip_edit-left":"")},u.a.createElement(v.a,{className:"Resolved__btn",onClick:nt},u.a.createElement($.a,{className:"check icon__16 icon"})))),u.a.createElement(ue,{isResolved:d,isCommentPanel:p,handleReopen:r,setIsShowDeleteOverlay:l,annotation:n,setIsEditing:ee,setIsNotOwnerComment:Re}))}return e}),[A,K,Y]);return Object(c.useMemo)((function(){return u.a.createElement("div",{className:m()("NoteContent",{"no-content":!Y&&!Ue,"no-reply":De&&!Le,"is-status":Be}),onMouseDown:function(e){return e.preventDefault()}},u.a.createElement("div",{className:"NoteContent__right"},at,He&&a&&u.a.createElement("div",{className:"highlight ".concat(!Me||Y||Ue?"":"comment_added"),onMouseDown:tt},u.a.createElement("div",{className:"highlight__mark_left"},u.a.createElement("div",null)),u.a.createElement("div",{ref:be,className:"highlight__text ".concat(se?"opened":"closed")},u.a.createElement("span",{ref:de},He),Ce&&u.a.createElement("div",{className:"icon"},u.a.createElement($.a,{className:se?"light-arrow-up":"light-arrow-down",size:16})))),u.a.createElement("div",{className:"content-container ".concat(!Me||Y||Ue?"":"comment_added"),onMouseDown:Ye},Q&&F?u.a.createElement(Se,{textAreaValue:Ie,onTextAreaValueChange:ke,annotation:n,setIsEditing:ee,currentUser:S,currentDocument:_,setContent:X,setIsFocusInput:U}):u.a.createElement("div",{className:"content-container"},Fe&&u.a.createElement("p",{className:"reopened"},oe.a.Cancelled.message),Ue&&u.a.createElement("p",{className:"reopened"},oe.a.Rejected.message),u.a.createElement("p",{className:"container"},Y)))),u.a.createElement("hr",null))}),[Ye,Q,Qe])};Oe.propTypes=Ee,Oe.defaultProps={setIsShowDeleteOverlay:function(){},isResolved:!1,isCommentPanel:!1,setCommentResolve:function(){},openSignInModal:function(){},userPlan:"",isRightPanel:!1};var Ce=Object(b.a)(Oe),Se=function(e){var t,n=e.annotation,a=e.setIsEditing,r=e.currentUser,l=e.currentDocument,d=e.setContent,p=e.setIsFocusInput,f=n.getCustomData(ne.a.MENTION.key),h=f?null===(t=JSON.parse(f))||void 0===t?void 0:t.contents:n.getContents(),v=Object(c.useState)(h),b=s()(v,2),g=b[0],y=b[1],E=Object(c.useState)([]),O=s()(E,2),C=O[0],T=O[1],_=Object(S.a)(),j=s()(_,1)[0],P=Object(c.useRef)(),R=n.getCustomData(ne.b.HIGHLIGHT_TEXT.key),N=Object(c.useRef)(!1);Object(c.useEffect)((function(){return setTimeout((function(){if(P.current){P.current.focus();var e=P.current.value.length;P.current.setSelectionRange(e,e)}}),300),function(){clearTimeout(P.current)}}),[]),Object(c.useEffect)((function(){if(g){var e=g.trim(),t=W.h.getEmailsFromContent(r,e);T(t)}}),[]),Object(c.useEffect)((function(){return ie.default.addEventListener("annotationSelected",w),function(){ie.default.removeEventListener("annotationSelected",w)}}),[g]);var w=function(e,t){"deselected"!==t||N.current||n.Subject===te.g.COMMENT&&(n.getContents()||(g?A(window.event,!1):x()))},x=function(){var e=ie.default.getAnnotationsList().filter((function(e){return e.Subject===te.g.HIGHLIGHT&&e.getCustomData(ne.b.IS_HIGHLIGHT_COMMENT.key)})).find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===n.Id}));e&&ie.default.deleteAnnotations([e]),ie.default.deleteAnnotations([n])},I=function(e){return{ownerEmail:e.Author,ownerComment:e.getContents(),comments:e.getReplies().map((function(e){return{email:e.Author,content:e.getContents()}}))}},k=function(){var e=i()(o.a.mark((function e(t){var i,s,c,u,m,f,v,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),g!==h&&g.trim()&&(a(!1),p(!1),i=g.trim(),s=W.h.getEmailsFromContent(r,i),c=W.h.getNewTagUsers(C,s),i&&(u=l._id,m=l.ownerId,r?(f=r.name,v={name:f,id:r._id},(0===c.length||c.every((function(e){return e!==n.Author})))&&r._id!==m&&W.G.socketEmitSendEmailComment(v,u,new Date,i),0!==c.length&&(b=I(n),W.G.socketEmitSendEmailMention(v,u,i,b,c))):W.G.socketEmitSendEmailComment({name:"Anonymous"},u,new Date,i),d(W.h.clearAllMarkupSymbol(i)),ie.default.setNoteContents(n,W.h.clearAllMarkupSymbol(i)),n instanceof window.Annotations.FreeTextAnnotation&&ie.default.drawAnnotationsFromList([n])));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.preventDefault(),e.stopPropagation(),N.current=!0,R){var o=ie.default.getAnnotationsList().find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===n.Id}));h?o.DateModified=n.DateModified:o.setCustomData(ne.b.HIGHLIGHT_HAS_CONTENT.key,ne.b.HIGHLIGHT_HAS_CONTENT.hasValue)}g&&g.trim()&&(k(e),a(!1),p(!1)),t&&!h&&ie.default.deselectAnnotation(n)};return u.a.createElement("div",{className:"edit-content"},u.a.createElement(Q,{inputRef:P,value:W.h.redoMarkupSymbol(g),onChange:y,closeEditing:function(){a(!1),p(!1)},placeholder:"".concat(j("action.comment"),"..."),onSubmit:k,showAvatar:!h}),u.a.createElement("span",{className:"buttons"},u.a.createElement(de.a,{className:"secondary",onMouseDown:function(){a(!1),p(!1),h||"Comment"!==n.Subject||ie.default.deleteAnnotations([n],{})}},j("action.cancel")),u.a.createElement(de.a,{className:m()("primary",{disabled:!(g&&g.trim())}),disabled:!(g&&g.trim()),onMouseDown:A},h?"Save":"Comment")))};Se.propTypes={annotation:f.a.object.isRequired,setIsEditing:f.a.func.isRequired,currentUser:f.a.object,currentDocument:f.a.object,setContent:f.a.func,setIsFocusInput:f.a.func},Se.defaultProps={currentUser:{},currentDocument:{},setContent:function(){},setIsFocusInput:function(){}};var Te=Ce;function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e){var t=e.annotation,n=e.handleReplyReopen,a=e.replyTextareaRef,o=e.isResolved,r=e.changeIsReOpenByReply,i=e.isCommentPanel,l=Object(h.f)((function(e){var n;return[I.a.getCurrentUser(e),I.a.getCurrentDocument(e),I.a.isDocumentReadOnly(e),I.a.isElementDisabled(e,"noteReply"),null===(n=I.a.getIsReplyDisabled(e))||void 0===n?void 0:n(t),I.a.getIsNoteEditing(e)]}),h.d),d=s()(l,6),p=d[0],f=d[1],v=d[2],b=d[3],g=d[4],O=d[5],C=Object(c.useContext)(i?E.a:y.a),T=C.resize,_=C.isContentEditable,j=C.isSelected,P=Object(c.useState)(!1),R=s()(P,2),N=R[0],w=R[1],x=Object(c.useState)(""),k=s()(x,2),A=k[0],L=k[1],D=Object(S.a)(),M=s()(D,1)[0],B=Object(h.e)(),F={email:t.Author,content:t.getContents()},U=t.getReplies().map((function(e){return{email:e.Author,content:e.getContents()}})).concat([F]);ve((function(){N||B(le.a.finishNoteEditing()),T()}),[N]),Object(c.useEffect)((function(){O&&j&&!_&&a&&a.current.focus()}),[_,O,j]);var H=function(e){e.preventDefault();var a=je(je({},F),{},{comments:U}),l=A&&A.trim();if(l){o&&r(!0),ie.default.createAnnotationReply(t,W.h.clearAllMarkupSymbol(A.trim()));var s=f._id,c=t.Author,u=W.h.getEmailsFromContent(p,A.trim()),d=Array.from(new Set(U.filter((function(e){return(null===p||void 0===p?void 0:p.email)!==e.email})).map((function(e){return e.email}))));if(p){var m={name:p.name,id:p._id};if(u.length>0&&W.G.socketEmitSendEmailMention(m,s,A.trim(),a,u),u.every((function(e){return e!==c}))&&U.length>0){var h=d.filter((function(e){return!u.find((function(t){return t===e}))}));W.G.socketEmitSendEmailReply(m,s,c,h,a,l)}}else W.G.socketEmitSendEmailReply({name:"Anonymous"},s,c,d,a,l)}L(""),n(),i&&ie.default.deselectAnnotation(t)},z=m()({disabled:!A||!A.trim()});return v||b||g||O&&_?null:u.a.createElement("div",{className:"reply-container",onMouseDown:function(e){return e.stopPropagation()}},u.a.createElement("hr",null),u.a.createElement(Q,{inputRef:a,value:A,onChange:function(e){return L(e)},onFocus:function(){return w(!0)},placeholder:o?"Adding a comment will reopen this discussion":M("action.reply"),onBlur:function(){return w(!1)},onSubmit:H}),N&&u.a.createElement("div",{className:"buttons btn_mg-0"},u.a.createElement(de.a,{className:"secondary",onMouseDown:function(){L(""),a.current.blur()}},M("action.cancel")),u.a.createElement(de.a,{className:"primary ".concat(z),onMouseDown:H,disabled:!A||!A.trim()},"Reply")))};Pe.propTypes={annotation:f.a.object.isRequired,handleReplyReopen:f.a.func,replyTextareaRef:f.a.object,isResolved:f.a.bool.isRequired,changeIsReOpenByReply:f.a.func,isCommentPanel:f.a.bool},Pe.defaultProps={handleReplyReopen:function(){},replyTextareaRef:{},changeIsReOpenByReply:function(){},isCommentPanel:!1};var Re=Pe,Ne=(n("./src/lumin-components/CustomCheckbox/index.js"),n("./src/constants/socketConstant.js")),we=n("./src/helpers/setToolModeAndGroup.js"),xe=n("./src/helpers/scrollToAnnotation.js"),Ie=n("./src/socket/index.js"),ke={annotation:f.a.object.isRequired,isCommentPanel:f.a.bool.isRequired,isRightPanel:f.a.bool.isRequired},Ae=0,Le=function(e){var t=e.annotation,n=e.isCommentPanel,a=e.isRightPanel,r=Object(c.useContext)(n?E.a:y.a),l=r.isSelected,d=r.resize,p=Object(c.useRef)(),f=Object(c.useRef)(),v=Object(c.useRef)(null),b=t instanceof window.Annotations.StickyAnnotation,O=Object(c.useRef)([]),C=Object(c.useState)(!1),S=s()(C,2),T=S[0],_=S[1],j=ie.default.getAnnotationManager(),P=Object(h.f)((function(e){return[I.a.getNoteTransformFunction(e),I.a.getCurrentDocument(e),I.a.getCurrentUser(e)]}),h.d),R=s()(P,3),N=R[0],w=R[1],x=R[2],k=Object(h.e)(),A=t.getContents(),L=x?"":he.c.NO_PLAN,D=b&&t.getState()===oe.a.Resolved.state,M=Object(c.useRef)(!1),B=ie.default.getAnnotationsList().find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===t.Id}));Object(c.useEffect)((function(){return ie.default.addEventListener("addReply",F),function(){return ie.default.removeEventListener("addReply",F)}}),[]),Object(c.useEffect)((function(){var e=f.current,t=p.current.getBoundingClientRect().height;f.current=t,e&&Math.round(e)!==Math.round(t)&&d()}),[l,d]),Object(c.useEffect)((function(){if(N){O.current.forEach((function(e){var t=document.querySelector("[data-webviewer-custom-element='".concat(e,"']"));t&&t.parentNode.removeChild(t)})),O.current=[];var e={annotation:t,isSelected:l};N(p.current,e,(function(){var e,t=(e=document).createElement.apply(e,arguments),n="custom-element-".concat(Ae);return Ae++,O.current.push(n),t.setAttribute("data-webviewer-custom-element",n),t.addEventListener("mousedown",(function(e){e.stopPropagation()})),t}))}})),Object(c.useEffect)((function(){B&&Be(D,B)}),[D]);var F=function(e,t,n){M.current&&"Marked"!==e.getStateModel()&&"Comment"===n.Subject&&(e.setState(oe.a.Cancelled.state),M.current=!1)},U=function(){var e=i()(o.a.mark((function e(n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.stopPropagation(),(null===(a=ie.default.getToolMode())||void 0===a?void 0:a.name)!==window.Tools.ToolNames.FREEHAND){e.next=4;break}return e.next=4,Object(we.a)(g.a,"AnnotationEdit");case 4:l||(ie.default.deselectAllAnnotations(),ie.default.selectAnnotation(t),t.isVisible()&&Object(xe.a)(ie.default.getScrollViewElement(),t),B&&(ie.default.selectAnnotation(B),B.isVisible()&&Object(xe.a)(ie.default.getScrollViewElement(),B)));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=i()(o.a.mark((function e(n){var a,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.length>1&&void 0!==r[1]?r[1]:"button",n===D){e.next=4;break}return e.next=4,Ue(n,t,B,w,x);case 4:n?j.updateAnnotationState(t,oe.a.Resolved.state,"Marked",oe.a.Resolved.message):D&&"button"===a&&j.updateAnnotationState(t,oe.a.Open.state,"Marked",oe.a.Open.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=m()({NoteLumin:!0,expanded:l,resolved:D}),K=m()({replies:!0,hidden:!l}),q=t.getReplies().sort((function(e,t){return e.DateCreated-t.DateCreated})),G=function(){k(le.a.openElement("signInUseCommentModal"))};return u.a.createElement("div",{className:z,ref:p,onMouseDown:U},b&&A&&D&&u.a.createElement("div",{className:"NoteLumin_header"},u.a.createElement(Me,{setCommentResolve:H,userPlan:L,openSignInModal:G})),u.a.createElement("div",{className:"NoteLumin__wrapper-note-content",role:"button",tabIndex:0},u.a.createElement(Te,{handleReopen:function(){return H(!1)},setIsShowDeleteOverlay:function(e){v.current&&v.current.blur(),_(e)},annotation:t,isResolved:D,isRightPanel:a,isCommentPanel:n,setCommentResolve:H,openSignInModal:G,userPlan:L}),u.a.createElement("div",{className:K},q.map((function(e){return u.a.createElement(Te,{key:e.Id,isResolved:D,annotation:e,isCommentPanel:n,isRightPanel:a})})),L!==he.c.NO_PLAN?u.a.createElement(Re,{replyTextareaRef:v,annotation:t,handleReplyReopen:function(){return H(!1,"reply")},isResolved:D,changeIsReOpenByReply:function(e){return M.current=e},isCommentPanel:n,isRightPanel:a}):u.a.createElement("div",null)),T&&u.a.createElement(De,{setIsShowDeleteOverlay:_,handleDelete:function(){ie.default.deleteAnnotations([t],{}),B&&ie.default.deleteAnnotations([B],{})}})))},De=function(e){var t=e.setIsShowDeleteOverlay,n=e.handleDelete;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"note_delete_mask"}),u.a.createElement("div",{className:"note_delete_content"},u.a.createElement("div",{className:"note_delete_content_title"},"Delete this comment thread?"),u.a.createElement("div",{className:"note_delete_content_button_group"},u.a.createElement(de.a,{className:"secondary",onClick:function(){return t(!1)}},"Cancel"),u.a.createElement(de.a,{className:"primary",onClick:n},"Delete"))))};De.propTypes={setIsShowDeleteOverlay:f.a.func.isRequired,handleDelete:f.a.func.isRequired};f.a.string.isRequired,f.a.func.isRequired,f.a.bool.isRequired,f.a.string.isRequired,f.a.func.isRequired,f.a.object.isRequired;var Me=function(e){var t=e.setCommentResolve,n=e.userPlan,a=e.openSignInModal;return u.a.createElement("div",{className:"note-resolved-wrapper"},u.a.createElement("div",{className:"label"},u.a.createElement($.a,{className:"check",size:14}),u.a.createElement("span",null,"Resolved")),u.a.createElement(v.a,{className:m()({action:!0,disabled:n===he.c.NO_PLAN}),onClick:function(){n!==he.c.NO_PLAN?t(!1):a()}},"Reopen"))};Me.propTypes={setCommentResolve:f.a.func.isRequired,userPlan:f.a.string.isRequired,openSignInModal:f.a.func.isRequired};var Be=function(e,t){var n=ie.default.getAnnotationManager();e?n.hideAnnotation(t):n.showAnnotation(t)},Fe=function(e,t,n,a){Ie.a.emit(Ne.a.ANNOTATION_CHANGE,{roomId:n._id,xfdf:t,annotationId:e,userId:a._id,email:a.email})},Ue=function(){var e=i()(o.a.mark((function e(t,n,a,r,l){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i()(o.a.mark((function e(i){var c,u,d,m,p,f,h,v,b,g,y;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ie.default.getAnnotationManager(),e.next=3,ze(a?[n,a]:[n]);case 3:u=e.sent,d=s()(u,2),m=d[0],p=d[1],f=new XMLSerializer,h="",m.setAttribute("state",t?oe.a.Resolved.state:oe.a.Open.state),a?(b=p.getAttribute("flags").split(","),t?b.push("hidden"):b.indexOf("hidden")>-1&&b.splice(b.indexOf("hidden"),1),p.setAttribute("flags",b.join(",")),h=f.serializeToString(p)):(v=m.getAttribute("flags").split(","),t?v.push("noview"):v.indexOf("noview")>-1&&v.splice(v.indexOf("noview"),1),m.setAttribute("flags",v.join(","))),g=f.serializeToString(m),y=He(g+h),Fe(n.Id,y,r,l),c.importAnnotCommand(y),t&&ie.default.deselectAnnotation(n),t||(Object(xe.a)(ie.default.getScrollViewElement(),n,"instant"),ie.default.selectAnnotation(n)),i();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,o,r){return e.apply(this,arguments)}}(),He=function(e){return'<?xml version="1.0" encoding="UTF-8" ?>\n<xfdf xmlns="http://www.w3.org/1999/xhtml" xml:space="preserve"><fields /><add /><modify>'.concat(e,"</modify><delete /></xfdf>")},ze=function(){var e=i()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i()(o.a.mark((function e(n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new DOMParser,e.next=3,ie.default.getAnnotationManager().exportAnnotations({annotList:t,widgets:!1,links:!1,fields:!1});case 3:r=e.sent,n(a.parseFromString(r,"text/xml").querySelector("annots").children);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Le.propTypes=ke,Le.defaultProps={};var Ke=Object(b.a)(Le);t.a=Ke},"./src/lumin-components/NotesPanel/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(a),r=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=n.n(r),l=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),s=n.n(l),c=n("./node_modules/react/index.js"),u=n.n(c),d=n("./node_modules/prop-types/index.js"),m=n.n(d),p=n("./node_modules/react-redux/es/index.js"),f=n("./node_modules/react-measure/dist/index.esm.js"),h=n("./node_modules/react-virtualized/dist/es/index.js"),v=n("./node_modules/react-i18next/dist/es/useTranslation.js"),b=n("./node_modules/@apollo/react-hoc/lib/react-hoc.esm.js"),g=n("./src/lumin-components/ListSeparator/index.js"),y=n("./src/lumin-components/Icomoon/index.js"),E=n("./src/lumin-components/SvgElement/index.js"),O=n("./src/lumin-components/NoteLumin/index.js"),C=n("./src/lumin-components/NoteLumin/Context.js"),S=n("./src/lumin-components/NoteCommentBox/CommentContext.js"),T=n("./src/core/index.js"),_=n("./src/redux/selectors/index.js"),j=n("./src/constants/sortStrategies.js"),P=n("./src/constants/documentConstants.js"),R=n("./src/constants/customDataConstant.js");function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x={display:m.a.string.isRequired,isRightPanel:m.a.bool},I=function(e){var t=e.display,n=e.isRightPanel,a=Object(p.f)((function(e){return[_.a.getSortStrategy(e),_.a.isElementDisabled(e,"notesPanel"),_.a.getPageLabels(e),_.a.getCustomNoteFilter(e)]}),p.d),o=s()(a,4),r=o[0],l=o[1],d=o[2],m=o[3],f=Object(c.useState)([]),h=s()(f,2),b=h[0],N=h[1],w=Object(c.useState)({}),x=s()(w,2),I=x[0],k=x[1],A=Object(c.useState)(""),L=s()(A,2),B=L[0],F=L[1],U=Object(c.useState)(!1),H=s()(U,2),z=H[0],K=H[1],q=Object(v.a)(),G=s()(q,1)[0],V=Object(c.useRef)(),Y=Object(c.useRef)(),W=Object(c.useRef)(0);Object(c.useEffect)((function(){var e=function(){N([]),k({}),F("")};return T.default.addEventListener("documentUnloaded",e),T.default.getTool("AnnotationCreateSticky").addEventListener("annotationCreated",J),function(){T.default.removeEventListener("documentUnloaded",e),T.default.getTool("AnnotationCreateSticky").removeEventListener("annotationCreated",J)}}),[]),Object(c.useEffect)((function(){var e=function(){N(T.default.getAnnotationsList().filter((function(e){return n?e.Subject===P.g.COMMENT&&!e.isReply()&&e.getContents():e.Subject&&e.Subject!==P.g.NO_NAME&&e.Subject!==P.g.WIDGET&&!e.isReply()&&!e.Hidden&&!e.isGrouped()&&!e.getCustomData(R.b.IS_HIGHLIGHT_COMMENT.key)&&e.Subject!==P.g.COMMENT})))};return e(),T.default.addEventListener("annotationChanged",e),T.default.addEventListener("annotationHidden",e),function(){T.default.removeEventListener("annotationChanged",e),T.default.removeEventListener("annotationHidden",e)}}),[]),Object(c.useEffect)((function(){var e=function(){var e={},t=n?T.default.getSelectedAnnotations().filter((function(e){return e.Subject===P.g.COMMENT&&!e.isReply()})):T.default.getSelectedAnnotations().filter((function(e){return e.Subject!==P.g.COMMENT&&!e.getCustomData(R.b.IS_HIGHLIGHT_COMMENT.key)}));n&&K(!0),t.forEach((function(t){e[t.Id]=!0})),k(e)};return T.default.addEventListener("annotationSelected",e),function(){T.default.removeEventListener("annotationSelected",e)}}),[]);Object(c.useEffect)((function(){"flex"===t&&V.current&&W.current&&V.current.scrollToPosition(W.current)}),[t]);var X=function(e){e&&(W.current=e)},J=function(){K(!0)},Z=function(e,t){return!!e&&-1!==e.search(new RegExp(t,"i"))},Q=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=null,i=Object(j.a)()[r],l=i.shouldRenderSeparator,s=i.getSeparatorContent,c=0===t?null:e[t-1],m=e[t];l&&s&&(!c||l(c,m))&&(o=u.a.createElement(g.a,{renderContent:function(){return s(c,m,{pageLabels:d})}}));var p={searchInput:B,resize:a,isSelected:I[m.Id],isFocusInput:z,setIsFocusInput:K,isContentEditable:T.default.canModify(m)&&!m.getContents()},f=function(){return n?"".concat(m.Id,"-right"):""};return u.a.createElement("div",{className:"note-wrapper",id:f()},n?"":o,n?u.a.createElement(S.a.Provider,{value:p},u.a.createElement(O.a,{annotation:m,isCommentPanel:!0,isRightPanel:!0})):u.a.createElement(C.a.Provider,{value:p},u.a.createElement(O.a,{annotation:m,isCommentPanel:!1,isRightPanel:!1})))},$=Object(j.a)()[r].getSortedNotes(b).filter((function(e){var t=!0;if(m&&(t=t&&m(e)),B){var n=e.getReplies(),a=[e].concat(i()(n));t=t&&a.some((function(e){var t=e.getContents(),n=e.Author;return Z(t,B)||Z(n,B)}))}return t})),ee=Object.keys(I),te=-1;1===ee.length&&(te=$.findIndex((function(e){return e.Id===ee[0]}))),Object(c.useEffect)((function(){Object.keys(I).length&&-1!==te&&Y.current&&($.length<=100?function(e){var t=V.current.children(),n=t.children[e],a=Y.current.getBoundingClientRect(),o=n.getBoundingClientRect();o.top>=a.top&&o.top<=a.top+Y.current.clientHeight||(Y.current.scrollTop=o.top+t.scrollTop-a.top)}(te):V.current.scrollToRow(te))}),[I]);return l||"none"===t?null:u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"Panel NotesPanel","data-element":"notesPanel",ref:Y,onMouseDown:T.default.deselectAllAnnotations},0===b.length?n?u.a.createElement("div",{className:"no-annotations"},u.a.createElement(E.a,{className:"center-of-panel",content:"icon_comment",width:132,height:120}),u.a.createElement("p",null,"There is no comments here")):u.a.createElement("div",{className:"no-annotations"},u.a.createElement(y.a,{className:"annotation icon__88"}),u.a.createElement("p",null,G("message.noAnnotations"))):0===$.length?u.a.createElement("div",{className:"no-results"},G("message.noResults")):$.length<=100?u.a.createElement(M,{ref:V,notes:$,onScroll:X,initialScrollTop:W.current},Q):u.a.createElement(D,{ref:V,notes:$,onScroll:X,initialScrollTop:W.current},Q)))};I.propTypes=x,I.defaultProps={isRightPanel:!1};var k=Object(b.a)(I),A={notes:m.a.array.isRequired,children:m.a.func.isRequired,onScroll:m.a.func.isRequired,initialScrollTop:m.a.number.isRequired},L=new h.c({defaultHeight:50,fixedWidth:!0}),D=u.a.forwardRef((function(e,t){var n=e.notes,a=e.children,o=e.onScroll,r=e.initialScrollTop,i=Object(c.useRef)(),l=Object(c.useState)(0),d=s()(l,2),m=d[0],p=d[1],v=Object(c.useState)({width:0,height:0}),b=s()(v,2),g=b[0],y=b[1],E=window.innerHeight;Object(c.useImperativeHandle)(t,(function(){return{scrollToPosition:function(e){i.current.scrollToPosition(e)},scrollToRow:function(e){i.current.scrollToRow(e)}}})),Object(c.useEffect)((function(){i.current.scrollToPosition(r)}),[r]),Object(c.useEffect)((function(){var e;L.clearAll(),null===i||void 0===i||null===(e=i.current)||void 0===e||e.recomputeRowHeights()}),[n.length]),Object(c.useEffect)((function(){var e=function(){var e=window.innerHeight-E;e&&(window.innerHeight<E&&p(e),E=window.innerHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var O=function(e){var t=e.scrollTop;o(t)},C=function(e){var t=e.index,o=e.key,r=e.parent,l=e.style,s=n[t];return u.a.createElement(h.b,{key:"".concat(o).concat(s.Id),cache:L,columnIndex:0,parent:r,rowIndex:t},u.a.createElement("div",{style:l},a(n,t,(function(){return function(e){L.clear(e),i.current&&i.current.recomputeRowHeights(e)}(t)}))))};return u.a.createElement(f.a,{bounds:!0,onResize:function(e){var t=e.bounds;y(w(w({},t),{},{height:t.height+2*m})),p(0)}},(function(e){var t=e.measureRef;return u.a.createElement("div",{ref:t,className:"virtualized-notes-container"},u.a.createElement(h.f,{deferredMeasurementCache:L,style:{outline:"none"},height:g.height-m,width:g.width,overscanRowCount:10,ref:i,rowCount:n.length,rowHeight:L.rowHeight,rowRenderer:C,onScroll:O}))}))}));D.propTypes=A;var M=u.a.forwardRef((function(e,t){var n=e.notes,a=e.children,o=e.onScroll,r=e.initialScrollTop,i=Object(c.useRef)();Object(c.useImperativeHandle)(t,(function(){return{scrollToPosition:function(e){i.current.scrollTop=e},children:function(){return i.current},scrollToRow:function(e){var t=i.current,n=t.children[e],a=t.getBoundingClientRect(),o=n.getBoundingClientRect();o.top>=a.top&&o.top<=a.top+t.clientHeight||(t.scrollTop=o.top+t.scrollTop-a.top)}}})),Object(c.useEffect)((function(){i.current.scrollTop=r}),[r]);return u.a.createElement("div",{ref:i,className:"normal-notes-container",onScroll:function(e){o(e.target.scrollTop)}},n.map((function(e,t){return u.a.createElement(u.a.Fragment,{key:"".concat(t).concat(e.Id)},a(n,t))})))}));M.propTypes=A;t.a=k},"./src/lumin-components/RightPanelLumin/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(a),r=n("./node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(r),l=n("./node_modules/@babel/runtime/helpers/inherits.js"),s=n.n(l),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=n.n(p),h=n("./node_modules/react/index.js"),v=n.n(h),b=n("./node_modules/prop-types/index.js"),g=n.n(b),y=n("./node_modules/classnames/index.js"),E=n.n(y),O=n("./node_modules/react-redux/es/index.js"),C=n("./src/lumin-components/NotesPanel/index.js"),S=n("./src/lumin-components/CustomElement/index.js"),T=n("./src/lumin-components/ButtonLumin/index.js"),_=n("./src/helpers/device.js"),j=n("./src/redux/actions/index.js"),P=n("./src/redux/selectors/index.js"),R=n("./src/core/index.js"),N=n("./src/constants/documentConstants.js");function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var x=function(){var e=Object(O.f)((function(e){return[P.a.isElementDisabled(e,"rightPanel"),P.a.isElementOpen(e,"rightPanel"),P.a.getCustomPanels(e),P.a.getLeftPanelWidth(e),P.a.getIsShowTopBar(e)]}),O.d),t=f()(e,5),n=t[0],a=t[1],o=t[2],r=t[3],i=t[4],l=Object(O.e)();Object(h.useEffect)((function(){a&&Object(_.p)()&&l(j.a.closeElement("searchPanel"))}),[l,a]);var s=function(e){return"notesPanel"===e?"flex":"none"},c=_.i&&r?{width:r}:{};return n?null:v.a.createElement("div",{className:E()({Panel:!0,RightPanelLumin:!0,open:a,closed:!a,"no-topbar":!i,"comment-list":!0}),"data-element":"rightPanel",style:c},v.a.createElement("div",{className:E()({RightPanelLumin__top:!0})},v.a.createElement("p",null,function(){var e=R.default.getAnnotationsList().filter((function(e){return e.Subject===N.g.COMMENT&&!e.isReply()&&e.getContents()})).length;return"".concat(e,1!==e?" Comments":" Comment")}()),v.a.createElement(T.a,{icon:"flat-cross",onClick:function(){l(j.a.closeElement("rightPanel")),window.document.getElementById("panel-scroll").hasChildNodes()&&l(j.a.openElement("rightPanelComment"))},iconSize:24})),v.a.createElement("hr",{className:"title-divider"}),v.a.createElement("div",{className:"left-panel-header"}),v.a.createElement(I,null,v.a.createElement(C.a,{display:s("notesPanel"),isRightPanel:!0})),o.map((function(e,t){var n=e.panel;return v.a.createElement(S.a,{key:n.dataElement||t,className:"Panel ".concat(n.dataElement),display:s(n.dataElement),dataElement:n.dataElement,render:n.render})})))},I=function(e){s()(n,e);var t=w(n);function n(e){var a;return o()(this,n),(a=t.call(this,e)).state={hasError:!1},a}return i()(n,null,[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0}}}]),i()(n,[{key:"render",value:function(){return this.state.hasError?null:this.props.children}}]),n}(v.a.Component);I.propTypes={children:g.a.element},I.defaultProps={children:v.a.createElement(v.a.Fragment,null)},x.propTypes={},x.defaultProps={};var k=x;t.default=k},"./src/lumin-components/StylePalette/index.js":function(e,t,n){"use strict";var a=n("./node_modules/react-redux/es/index.js"),o=n("./src/redux/selectors/index.js"),r=n("./node_modules/@babel/runtime/helpers/extends.js"),i=n.n(r),l=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=n.n(l),c=n("./node_modules/@babel/runtime/helpers/createClass.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(p),h=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=n.n(h),b=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=n.n(b),y=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=n.n(y),O=n("./node_modules/react/index.js"),C=n.n(O),S=n("./node_modules/prop-types/index.js"),T=n.n(S),_=n("./node_modules/react-i18next/dist/es/withTranslation.js"),j=n("./src/redux/actions/index.js"),P=n("./node_modules/classnames/index.js"),R=n.n(P),N=n("./src/lumin-components/Tooltip/index.js"),w=n("./src/lumin-components/Icomoon/index.js"),x=n("./src/constants/documentConstants.js"),I=n("./src/constants/map.js");function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return v()(this,n)}}var A=function(e){f()(n,e);var t=k(n);function n(){var e;s()(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o)),E()(m()(e),"setActivePalette",(function(t){var n=e.props;(0,n.setActivePalette)(n.colorMapKey,t)})),E()(m()(e),"renderBorderColorIcon",(function(){var t=e.props,n=t.style.StrokeColor,a=t.colorPalette,o=null===n||void 0===n?void 0:n.toHexString(),r=a===x.b.STROKE_COLOR,i="#FFFFFF"===o;return C.a.createElement(N.a,{content:"option.annotationColor.StrokeColor"},C.a.createElement("div",{className:R()({border:!0,selected:r}),onClick:function(){return e.setActivePalette(x.b.STROKE_COLOR)}},C.a.createElement(w.a,{className:"border",color:i&&!r?"rgb(192, 208, 223)":n})))})),E()(m()(e),"renderFillColorIcon",(function(){var t=e.props,n=t.style.FillColor,a=t.colorPalette,o=null===n||void 0===n?void 0:n.toHexString(),r=a===x.b.FILL_COLOR,i="#FFFFFF"===o;return C.a.createElement(N.a,{content:"option.annotationColor.FillColor"},C.a.createElement("div",{className:R()({fill:!0,selected:r}),onClick:function(){return e.setActivePalette(x.b.FILL_COLOR)}},C.a.createElement(w.a,{className:"rect-filled",color:i&&!r?"rgb(192, 208, 223, 0.6)":o})))})),E()(m()(e),"renderTitleHeader",(function(){var t=e.props,n=t.colorPalette,a="Style";return"freeText"===t.colorMapKey&&(n===x.b.TEXT_COLOR&&(a="Text style"),n!==x.b.STROKE_COLOR&&n!==x.b.FILL_COLOR||(a="Text frame")),a})),e}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.colorPalette,n=e.colorMapKey,a=e.isTextColorPaletteDisabled,o=e.isBorderColorPaletteDisabled,r=e.isFillColorPaletteDisabled,i=e.isAnnotationStylePopup,l=e.annotation,s=Object(I.b)(n).availablePalettes,c=l&&l.Subject!==x.g.REDACTION,u=(null===s||void 0===s?void 0:s.includes(x.b.TEXT_COLOR))&&!a&&c,d=(null===s||void 0===s?void 0:s.includes(x.b.STROKE_COLOR))&&!o&&c,m=(null===s||void 0===s?void 0:s.includes(x.b.FILL_COLOR))&&!r&&c;return(null===s||void 0===s?void 0:s.length)<2||!u&&!d&&!m?C.a.createElement("div",{className:"stylePopup-title"},"freeHand"===n&&C.a.createElement("div",{className:R()({"palette--title":!0,"palette--mg-0":i})})):C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"stylePopup-title"},C.a.createElement("div",{className:R()({"palette--title":!0,"palette--mg-0":t===x.b.FILL_COLOR})},this.renderTitleHeader(),C.a.createElement("div",{className:"palette palette--mg-0 ColorPaletteHeader__palette--flex"},t!==x.b.TEXT_COLOR&&m&&this.renderFillColorIcon(),t!==x.b.TEXT_COLOR&&d&&this.renderBorderColorIcon()))))}}]),n}(C.a.PureComponent);A.propTypes={style:T.a.object.isRequired,colorPalette:T.a.oneOf(["TextColor","StrokeColor","FillColor"]),colorMapKey:T.a.string.isRequired,setActivePalette:T.a.func.isRequired,isTextColorPaletteDisabled:T.a.bool,isFillColorPaletteDisabled:T.a.bool,annotation:T.a.object,isBorderColorPaletteDisabled:T.a.bool,isAnnotationStylePopup:T.a.bool},A.defaultProps={colorPalette:"TextColor",isTextColorPaletteDisabled:!1,isFillColorPaletteDisabled:!1,isBorderColorPaletteDisabled:!1,annotation:{},isAnnotationStylePopup:!1};var L=A,D={setActivePalette:j.a.setActivePalette},M=Object(a.c)((function(e){return{isTextColorPaletteDisabled:o.a.isElementDisabled(e,"textColorPalette"),isFillColorPaletteDisabled:o.a.isElementDisabled(e,"fillColorPalette"),isBorderColorPaletteDisabled:o.a.isElementDisabled(e,"borderColorPalette")}}),D)(Object(_.a)(null,{wait:!1})(L)),B=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),F=n.n(B),U=n("./src/core/index.js"),H=n("./src/utils/index.js"),z=n("./src/constants/toolsName.js"),K="redaction",q=n("./node_modules/@material-ui/core/esm/Button/Button.js"),G=C.a.createElement("svg",{width:"24px",height:"24px",style:{position:"relative",borderRadius:"100%",border:"1px solid #c0d0df"}},C.a.createElement("line",{x1:"0%",y1:"100%",x2:"100%",y2:"0%",strokeWidth:"1",stroke:"#e44234",strokeLinecap:"square"}));function V(e){var t=e.property,n=e.setColor,a=e.active,o=e.className;return e.isNotRenderTransparencyCell||"TextColor"===t||"StrokeColor"===t||"redaction"===t?null:C.a.createElement(q.a,{onClick:function(e){return n(e)},className:"ColorPaletteLumin__transparent ".concat(o," ").concat(a)},C.a.createElement("div",{className:"cell ColorPaletteLumin__transparent--cell"},G))}V.propTypes={property:T.a.string,setColor:T.a.func.isRequired,active:T.a.string,className:T.a.string,isNotRenderTransparencyCell:T.a.bool},V.defaultProps={property:"",active:"",className:"",isNotRenderTransparencyCell:!1};var Y=V,W=function(e){var t=e.bg,n=e.onClick,a=e.className;return C.a.createElement(q.a,{key:t,onClick:n,value:t,className:a},C.a.createElement("div",{className:"cell ".concat("rgb(255, 255, 255)"===t?"bordered":""),style:{backgroundColor:t}}))};W.propTypes={bg:T.a.string,onClick:T.a.func,className:T.a.string},W.defaultProps={bg:"",className:"",onClick:function(){}};var X=W,J=n("./node_modules/react-color/es/index.js"),Z=n("./src/lumin-components/LuminButton/index.js"),Q=n("./node_modules/@material-ui/core/esm/Grid/Grid.js"),$=n("./src/lumin-components/MaterialPopper/index.js");function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return v()(this,n)}}var te=function(e){f()(n,e);var t=ee(n);function n(e){var a;return s()(this,n),a=t.call(this,e),E()(m()(a),"handleToggleColorPicker",(function(){a.setState({displayColorPicker:!a.state.displayColorPicker})})),E()(m()(a),"handleChange",(function(e){var t=e.rgb;a.setState({color:t})})),E()(m()(a),"setPalette",(function(){var e=a.state.color;a.props.setPalette("rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")),a.handleToggleColorPicker()})),E()(m()(a),"handleClosePicker",(function(){a.setState({displayColorPicker:!1})})),a.state={displayColorPicker:!1,color:{r:34,g:25,b:75,a:1}},a}return u()(n,[{key:"render",value:function(){var e=this,t=this.props.placement,n=this.state,a=n.displayColorPicker,o=n.color;return C.a.createElement(C.a.Fragment,null,C.a.createElement(q.a,{onClick:this.handleToggleColorPicker,value:this.props.bg,className:"ColorPickerBtn ".concat(this.props.className," ").concat(this.state.displayColorPicker?"active-picker":""),ref:function(t){e.anchorEl=t}},C.a.createElement(w.a,{className:"basic-tint",size:22})),C.a.createElement($.a,{open:a,anchorEl:this.anchorEl,classes:"ColorPicker__popper",placement:t,handleClose:this.handleClosePicker},C.a.createElement("div",{className:"ColorPicker"},C.a.createElement(J.a,{className:"ColorPicker__container",disableAlpha:!0,color:o,width:"auto",onChangeComplete:this.handleChange,styles:{default:{picker:{boxShadow:"none"}}}}),C.a.createElement("div",{className:"divider horizontal"}),C.a.createElement(Q.a,{container:!0,spacing:2},C.a.createElement(Q.a,{item:!0,xs:6},C.a.createElement(Z.a,{type:"secondary",label:"Cancel",full:!0,onClick:this.handleToggleColorPicker})),C.a.createElement(Q.a,{item:!0,xs:6},C.a.createElement(Z.a,{type:"primary",label:"Confirm",full:!0,onClick:this.setPalette}))))))}}]),n}(C.a.PureComponent);te.propTypes={bg:T.a.string,className:T.a.string,setPalette:T.a.func,placement:T.a.string},te.defaultProps={placement:"bottom",bg:"",className:"",setPalette:function(){}};var ne=te;function ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return v()(this,n)}}var oe={property:T.a.string.isRequired,color:T.a.object,onStyleChange:T.a.func.isRequired,colorMapKey:T.a.string.isRequired,overridePalette:T.a.object,annotation:T.a.object,placement:T.a.string},re=function(e){f()(n,e);var t=ae(n);function n(e){var a;return s()(this,n),a=t.call(this,e),E()(m()(a),"defaultPalette",function(){var e,t,n=["transparency","rgb(249, 73, 57)","rgb(255, 230, 162)","rgb(79, 194, 246)","rgb(126, 211, 33)","rgb(74, 144, 226)","rgb(80, 227, 194)","rgb(246, 123, 137)","rgb(255, 255, 255)"];return(U.default.getSelectedAnnotations().length&&U.default.getSelectedAnnotations().some((function(e){return"Comment"===e.Subject}))||"AnnotationCreateSticky"===(null===(e=U.default.getToolMode())||void 0===e?void 0:e.name))&&n.splice(7,1),(U.default.getSelectedAnnotations().length&&(null===(t=U.default.getToolMode())||void 0===t?void 0:t.name)===z.a.REDACTION||a.props.colorMapKey===K)&&n.splice(7,1,"rgb(0, 0, 0)"),n}()),E()(m()(a),"setColor",(function(e){e.stopPropagation();var t=a.props,n=t.property,o=t.onStyleChange,r=e.currentTarget.value,i=r?r.slice(r.indexOf("(")+1,-1).split(","):[0,0,0,0];o(n,new window.Annotations.Color(i[0],i[1],i[2],i[3]))})),E()(m()(a),"setPalette",(function(e){var t=a.props,n=t.property,o=t.onStyleChange;if(!a.state.palette.includes(e)){var r="transparency"===a.state.palette[0]?1:0,i=F()(a.state.palette);null===i||void 0===i||i.splice(r,1),a.setState({palette:[].concat(F()(i),[e])});var l=e?e.slice(e.indexOf("(")+1,-1).split(","):[0,0,0,0];o(n,new window.Annotations.Color(l[0],l[1],l[2],l[3]))}})),E()(m()(a),"renderActiveClass",(function(e){var t=a.props.color,n=H.g.rbgToHex(e)||"transparency";return(t.toHexString()||"transparency").toLowerCase()===n?"active":""})),a.state={palette:[]},a.setPalette=a.setPalette.bind(m()(a)),a}return u()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.overridePalette,n=e.colorMapKey,a=e.color,o=(null===t||void 0===t?void 0:t[n])||(null===t||void 0===t?void 0:t.global)||this.defaultPalette,r="rgb(".concat(a.R,", ").concat(a.G,", ").concat(a.B,")");o.includes(r)||null===o||void 0===o||o.splice((null===o||void 0===o?void 0:o.length)-1,1,r),this.setState({palette:o})}},{key:"render",value:function(){var e=this,t=this.state.palette,n=this.props,a=n.annotation,o=n.placement,r=a&&a.Subject===x.g.REDACTION;return C.a.createElement("div",{className:"ColorPaletteLumin","data-element":"colorPalette"},t.map((function(t){return C.a.createElement(C.a.Fragment,{key:t},"transparency"===t?C.a.createElement(Y,{setColor:e.setColor,property:e.props.property,active:e.renderActiveClass(t),className:"color-cell",isNotRenderTransparencyCell:r}):C.a.createElement(X,{bg:t,onClick:function(t){return e.setColor(t)},className:"color-cell  ".concat(e.renderActiveClass(t))}))})),C.a.createElement(ne,{setPalette:this.setPalette,placement:o}))}}]),n}(C.a.PureComponent);re.propTypes=oe,re.defaultProps={overridePalette:null,color:"",annotation:{},placement:"bottom"};var ie=re,le=Object(a.c)((function(e){return{overridePalette:o.a.getCustomElementOverrides(e,"colorPalette")}}))(ie),se=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ce=n.n(se),ue=n("./node_modules/lodash/debounce.js"),de=n.n(ue),me=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),pe=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),fe=n("./src/lumin-components/MaterialSelect/index.js"),he=n("./src/lumin-components/ActionButton/index.js"),ve=n("./src/lumin-components/Shared/Input/index.js"),be=n("./src/helpers/getRichTextCSSStyle.js");function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=/^\d+$/,Oe=function(e,t){var n=Object(be.a)(e.getContents(),t);n&&e.setRichTextStyle(n),U.default.getAnnotationManager().redrawAnnotation(e)},Ce=function(e){var t=e.key,n=e.annotation,a=e.fontWeight,o=Number(n.FontSize.replace(/\p|t/g,""));if("bold"===t&&("Arial"===n.Font||"Helvetica"===n.Font)){var r=o;o>=40?r=o-9:o<40&&o>=30?r=o-6:o<30&&o>=20&&(r=o-3);var i=function(e,t){var n=document.createElement("canvas").getContext("2d");return n.font=t,n.measureText(e).width}(n.getContents().split(/\n/).sort((function(e,t){return t.length-e.length}))[0],"".concat(a," ").concat(r,"pt Helvetica"));n.Width<i&&n.setWidth(i)}},Se=[{value:"Aladin",name:"Aladin",class:"font-aladin"},{value:"Allura",name:"Allura",class:"font-allura"},{value:"Cookie",name:"Cookie",class:"font-cookie"},{value:"Courgette",name:"Courgette",class:"font-courgette"},{value:"DancingScript",name:"Dancing Script",class:"font-dancing-script"},{value:"GillSans",name:"GillSans",class:"font-gillSans"},{value:"Helvetica",name:"Helvetica",class:"font-helvetica"},{value:"Italianno",name:"Italianno",class:"font-italianno"},{value:"Lora",name:"Lora",class:"font-lora"},{value:"Merriweather",name:"Merriweather",class:"font-merriweather"},{value:"Roboto",name:"Roboto",class:"font-roboto"}],Te=function(e){var t,n=e.key,a=e.annotation,o=e.onStyleChange,r=void 0===o?function(){}:o,i=null===(t=a.getContents())||void 0===t?void 0:t.length,l=a.getRichTextStyle();Object.prototype.hasOwnProperty.call(l,i)||(l[i]={});var s=l[Object.keys(l)[0]],c=Object.values(s),u={key:n,objRichStyleKeys:c,richStyle:s,annotation:a,propertyName:function(e){return{bold:"font-weight",italic:"font-style",word:"text-decoration"}[e]}(n),onStyleChange:r};void 0!==c&&null!==c&&void 0!==c&&c.includes(n)?function(e){var t=e.key,n=e.objRichStyleKeys,a=e.richStyle,o=e.annotation,r=e.propertyName,i=e.onStyleChange,l=void 0===i?function(){}:i,s=null===n||void 0===n?void 0:n.filter((function(e){return e!==t}));l(x.b.FONT_STYLE,s),o instanceof window.Annotations.FreeTextAnnotation&&(delete a[r],Oe(o,a))}(ye({},u)):function(e){var t=e.key,n=e.objRichStyleKeys,a=e.richStyle,o=e.annotation,r=e.propertyName,i=e.onStyleChange,l=void 0===i?function(){}:i,s=(null===n||void 0===n?void 0:n.length)>0?[].concat(F()(n),[t]):[t];l(x.b.FONT_STYLE,s),o instanceof window.Annotations.FreeTextAnnotation&&(a[r]=t,Oe(o,a)),Ce({key:"bold",annotation:o,fontWeight:"bold"})}(ye({},u))},_e=function(e){var t,n=e.inputFontSizeRef,a=e.inputFocused,o=e.fontSizeValue,r=e.setOpenFontSizePopper,i=void 0===r?function(){}:r,l=e.handleUpdateFontSize,s=void 0===l?function(){}:l,c=e.renderCheckedActiveFont,u=void 0===c?function(){}:c,d=(t=5,Array(45-t+1).fill().map((function(e,n){return t+n}))||[]);return C.a.createElement($.a,{open:!0,anchorEl:n.current,classes:"FreeTextPaletteHeader__MaterialPopper",handleClose:function(){a||i(!1)}},C.a.createElement(me.a,{className:"FreeTextPaletteHeader__MenuList"},d.map((function(e,t){return C.a.createElement(pe.a,{key:t,onClick:function(){s(e),i(!1)}},e," pt ",e===Number(o)&&u())}))))};function je(e){var t=e.isAnnotationStylePopup,n=e.style,a=n.Font,o=n.FontSize,r=e.annotation,i=e.colorPalette,l=e.colorMapKey,s=e.onStyleChange,c=null===o||void 0===o?void 0:o.split("pt")[0],u=Object(O.useRef)(),d=Object(O.useState)(c),m=ce()(d,2),p=m[0],f=m[1],h=Object(O.useState)(!1),v=ce()(h,2),b=v[0],g=v[1],y=Object(O.useState)(!1),E=ce()(y,2),S=E[0],T=E[1],_=r&&r.Subject===x.g.FREE_TEXT&&!r.getContents(),j=_?"FreeTextPaletteHeader__ActionButton--disabled":"",P=function(e){var t;f(e),s(x.b.FONT_SIZE,(t=e,"".concat(Math.round(t),"pt")))},N=Object(O.useCallback)(de()((function(e){Number(e)>=5&&Number(e)<=45&&P(e)}),700),[]),I=function(e){var n=t&&r&&r.getRichTextStyle();if(n){var a=n[Object.keys(n)[0]];if(Object.values(a).includes(e))return"active"}return""},k=function(){return C.a.createElement("span",{className:"palette__font-selected"},C.a.createElement(w.a,{className:"check",size:14}))},A=[{title:"Bold",icon:"text-bold",iconSize:24,className:"text-tool ".concat(I("bold")," ").concat(j),onClick:function(){Te({key:"bold",annotation:r,onStyleChange:s})},disabled:_},{title:"Italic",icon:"text-italic",iconSize:24,className:"text-tool ".concat(I("italic")," ").concat(j),onClick:function(){Te({key:"italic",annotation:r,onStyleChange:s})},disabled:_},{title:"Underline",icon:"text-underline",iconSize:24,className:"text-tool ".concat(I("word")," ").concat(j),onClick:function(){Te({key:"word",annotation:r,onStyleChange:s})},disabled:_}];return C.a.createElement("div",{className:"stylePopup-title"},C.a.createElement("div",{className:R()({"palette--mg-0":i===x.b.FILL_COLOR})},C.a.createElement("span",{className:"palette--title-free-text"},function(){var e="Style";return"freeText"===l&&(i===x.b.TEXT_COLOR&&(e="Text style"),i!==x.b.STROKE_COLOR&&i!==x.b.FILL_COLOR||(e="Text frame")),e}()),C.a.createElement("div",{className:R()({palette:!0,"ColorPaletteHeader__palette--flex":!t})},C.a.createElement(fe.a,{value:a,onSelected:function(e){s(x.b.FONT,e.value)},containerClasses:R()({"FreeTextPaletteHeader__MaterialSelect--full-width":t,"FreeTextPaletteHeader__MaterialSelect--font-size":!0}),inputClasses:"input",items:Se,childNameComponent:k()}),C.a.createElement("div",{className:R()({"FreeTextPaletteHeader__input--wrapper":!0,"FreeTextPaletteHeader__input--wrapper-flex":t})},C.a.createElement("div",{className:"Input--container",onClick:function(){b||u.current.focus()}},C.a.createElement(ve.a,{inputRef:u,value:"".concat(p).concat(b?"":" pt"),postfix:C.a.createElement("span",{className:"FreeTextPaletteHeader__Input--font-extension"},C.a.createElement(w.a,{className:"dropdown MaterialSelect__input__icon_dropdown",size:16})),onChange:function(e){var t=e.target.value,n=new RegExp(Ee);t&&!n.test(t)||(f(t),N(t))},onBlur:function(e){var t=Number(e.target.value),n=Math.max(5,Math.min(45,t));P(n),g(!1)},onFocus:function(){T(!0),g(!0)},onKeyPress:function(e){"Enter"===e.key&&(u.current.blur(),T(!1))}})),t&&C.a.createElement("div",{className:"FreeTextPaletteHeader__ActionButton--wrapper"},A.map((function(e,t){return C.a.createElement(he.a,{key:t,title:e.title,icon:e.icon,iconSize:e.iconSize,className:e.className,onClick:e.onClick,disabled:e.disabled})}))),S&&_e({inputFontSizeRef:u,inputFocused:b,fontSizeValue:p,setOpenFontSizePopper:T,handleUpdateFontSize:P,renderCheckedActiveFont:k})))))}je.propTypes={style:T.a.object.isRequired,colorPalette:T.a.oneOf(["TextColor","StrokeColor","FillColor"]),colorMapKey:T.a.string.isRequired,onStyleChange:T.a.func.isRequired,annotation:T.a.object,isAnnotationStylePopup:T.a.bool},je.defaultProps={colorPalette:"TextColor",annotation:{},isAnnotationStylePopup:!1};var Pe=je,Re=n("./src/helpers/device.js"),Ne=n("./node_modules/react-color/lib/components/common/index.js"),we=function(){return C.a.createElement("div",{style:{width:"16px",height:"16px",borderRadius:"8px",marginTop:"1px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}})};function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke=function(e){var t=e.rgb,n=e.hsl,a=e.hsv,o=e.renderers,r=e.extension,i=e.sliderValue,l=e.setSliderValue,s=e.changeSlider,c=e.handleOnBlur,u=e.property,d=e.displayProperty,m=Object(O.useState)(i),p=ce()(m,2),f=p[0],h=p[1];return Object(O.useEffect)((function(){i<=100&&h(i)}),[i]),C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{id:"".concat(u,"-").concat(d),onMouseDown:function(){document.getElementById("".concat(u,"-").concat(d)).style.cursor="grabbing"},onMouseUp:function(){document.getElementById("".concat(u,"-").concat(d)).style.cursor="pointer"},className:"slider__alpha"},C.a.createElement(Ne.Alpha,{width:208,rgb:Ie(Ie({},t),{},{a:f/100}),hsl:n,hsv:a,renderers:o,onChange:function(e){var t=100*(null===e||void 0===e?void 0:e.a);s(t)},pointer:we})),C.a.createElement("div",{className:"slider__value"},C.a.createElement(ve.a,{postfix:C.a.createElement("span",{className:"SliderLumin__extension"},r),value:String(i),onChange:function(e){l(e)},onBlur:c})))};ke.propTypes={renderers:T.a.any,sliderValue:T.a.number,extension:T.a.string,property:T.a.string,displayProperty:T.a.string,rgb:T.a.object,hsl:T.a.object,hsv:T.a.object,setSliderValue:T.a.func,changeSlider:T.a.func,handleOnBlur:T.a.func},ke.defaultProps={renderers:{},sliderValue:0,extension:"",property:"",displayProperty:"",rgb:{},hsl:{},hsv:{},setSliderValue:function(){},changeSlider:function(){},handleOnBlur:function(){}};var Ae=Object(J.b)(ke);function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return v()(this,n)}}var De={property:T.a.string.isRequired,initialValue:T.a.oneOfType([T.a.number,T.a.string]),displayProperty:T.a.string.isRequired,dataElement:T.a.string.isRequired,getCirclePosition:T.a.func.isRequired,convertRelativeCirclePositionToValue:T.a.func.isRequired,onStyleChange:T.a.func.isRequired,t:T.a.func.isRequired,limitValue:T.a.object.isRequired,annotation:T.a.object.isRequired,convertValue:T.a.func.isRequired,currentPalette:T.a.string.isRequired},Me=function(e){f()(n,e);var t=Le(n);function n(e){var a;return s()(this,n),a=t.call(this,e),E()(m()(a),"onAnnotationChanged",(function(){var e=a.props.annotation;if("Free text"===e.Subject&&e.getContents()&&(e.Width<50||e.Height<20)){var t=U.default.getDocument(),n=U.default.getCurrentPage(),o=t.getPageInfo(n),r=t.getPageMatrix(n),i=t.getPageRotation(n);e.fitText(o,r,i),U.default.getAnnotationManager().redrawAnnotation(e)}})),E()(m()(a),"updateSvg",(function(){a.setLineLength(),a.forceUpdate()})),E()(m()(a),"setLineLength",(function(){var e,t;(null===(e=a.sliderSvg.current)||void 0===e?void 0:e.getBoundingClientRect().width)<170?a.lineLength=a.sliderSvg.current.getBoundingClientRect().width+50-24:a.lineLength=(null===(t=a.sliderSvg.current)||void 0===t?void 0:t.getBoundingClientRect().width)-24})),E()(m()(a),"onMouseDown",(function(e){var t=a.props,n=t.property,o=t.displayProperty;document.getElementById("".concat(n,"-").concat(o)).style.cursor="grabbing",a.isMouseDown=!0,a.onMove(e.nativeEvent)})),E()(m()(a),"onMouseUp",(function(){var e=a.props,t=e.property,n=e.displayProperty;document.getElementById("".concat(t,"-").concat(n)).style.cursor="pointer",a.isMouseDown=!1})),E()(m()(a),"onTouchStart",(function(e){a.onMove(e)})),E()(m()(a),"onMove",(function(e){if(!!e.touches||a.isMouseDown){e.preventDefault();var t=(0,a.props.convertRelativeCirclePositionToValue)(a.getRelativeCirclePosition(e));a.setState({sliderValue:t}),a.handleUpdateStyle(t)}})),E()(m()(a),"handleUpdateStyle",(function(e){var t=a.props,n=t.property,o=t.onStyleChange,r=t.convertValue,i=t.getCirclePosition;a.setState({sliderValue:parseInt(e)},(function(){a.setState({circleCenter:i(a.lineLength,a.state.sliderValue)})})),o(n,r(e))})),E()(m()(a),"getRelativeCirclePosition",(function(e){var t,n=!e.touches,o=8+a.lineLength,r=a.sliderSvg.current.getBoundingClientRect().left;return(t=n?e.pageX-r:e.touches[0].pageX-r)<8?t=8:t>o&&(t=o),(t-8)/a.lineLength})),E()(m()(a),"onChange",(function(e){var t=a.props.limitValue,n=t.max,o=t.min;(e=Number(e))>=Number(o)&&e<=Number(n)&&a.handleUpdateStyle(e)})),E()(m()(a),"handleChangeInput",(function(e){var t=e.target.value;t&&Number.isNaN(Number(t))||(a.setState({sliderValue:parseInt(t)||0}),a.debounceInput(t))})),E()(m()(a),"handleOnBlur",(function(e){var t=a.props.limitValue,n=t.max,o=t.min,r=Number(e.target.value);if(r<Number(o)||r>Number(n)){var i=Math.max(Number(o),Math.min(Number(n),Number(r)));a.handleUpdateStyle(i)}})),E()(m()(a),"getExtension",(function(){return"Opacity"===a.props.property?"%":"pt"})),E()(m()(a),"renderSlider",(function(){var e=a.props,t=e.dataElement,n=e.displayProperty,o=e.t,r=e.property,i=a.state,l=i.sliderValue,s=i.circleCenter;return C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"slider__property","data-element":t},C.a.createElement(N.a,{content:"thickness"!==n?o("option.slider.".concat(n)):"Border Size"},C.a.createElement("div",null,"FontSize"===r?C.a.createElement(w.a,{className:"text-font-size",size:22}):C.a.createElement(w.a,{className:"stroke-size",size:16})))),C.a.createElement("svg",{id:"".concat(r,"-").concat(n),width:"100%",height:22,onMouseDown:a.onMouseDown,onTouchStart:a.onTouchStart,ref:a.sliderSvg,onMouseUp:a.onMouseUp,onMouseMove:a.onMove},C.a.createElement("defs",null,C.a.createElement("filter",{id:"dropshadow",x:"-40%",y:"-40%",width:"180%",height:"180%",filterUnits:"userSpaceOnUse"},C.a.createElement("feGaussianBlur",{in:"SourceAlpha",result:"shadowBlurOuter1",stdDeviation:"2"}),C.a.createElement("feColorMatrix",{in:"shadowBlurOuter1",values:"0 0 0 0 0.131001602 0 0 0 0 0.270895425 0 0 0 0 0.43622449 0 0 0 0.29761096 0"}),C.a.createElement("feOffset",{dx:"5",dy:"5",result:"offsetblur"}),C.a.createElement("feOffset",{dx:"-5",dy:"-5",result:"offsetblur"}),C.a.createElement("feMerge",null,C.a.createElement("feMergeNode",null),C.a.createElement("feMergeNode",{in:"SourceGraphic"}),C.a.createElement("feMergeNode",{in:"SourceGraphic"})))),C.a.createElement("line",{className:"slider__line-fill",x1:8,y1:"50%",x2:s,y2:"50%",strokeWidth:"3",strokeLinecap:"round"}),C.a.createElement("line",{className:"slider__line-empty",x1:s,y1:"50%",x2:a.lineLength+8,y2:"50%",strokeWidth:"3",strokeLinecap:"round"}),C.a.createElement("circle",{className:"slider__circle",cx:s,cy:"50%",r:8,strokeWidth:"3"})),C.a.createElement("div",{className:"slider__value"},C.a.createElement(ve.a,{value:String(l),postfix:C.a.createElement("span",{className:"SliderLumin__extension"},a.getExtension()),onChange:a.handleChangeInput,onBlur:a.handleOnBlur})))})),E()(m()(a),"renderSliderOpacity",(function(){var e=a.props,t=e.property,n=e.displayProperty,o=a.state.sliderValue;return C.a.createElement(Ae,{color:"#000000",extension:a.getExtension(),sliderValue:o,changeSlider:a.onChangeOpacityInputValue,setSliderValue:a.handleChangeInput,handleOnBlur:a.handleOnBlur,property:t,displayProperty:n})})),E()(m()(a),"onChangeOpacityInputValue",(function(e){a.setState({sliderValue:parseInt(e)}),a.onChange(e)})),a.state={sliderValue:0},a.isMouseDown=!1,a.sliderSvg=C.a.createRef(),a.lineLength=0,a.updateMinValue=null,a.state={sliderValue:0,circleCenter:0},a.debounceInput=de()(a.onChange,700),a}return u()(n,[{key:"componentDidMount",value:function(){var e,t=this.props.getCirclePosition;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("orientationchange",this.updateSvg),window.addEventListener("resize",this.updateSvg),U.default.addEventListener("annotationChanged",this.onAnnotationChanged),null===(e=this.sliderSvg.current)||void 0===e||e.addEventListener("touchmove",this.onMove,{passive:!1}),this.updateSvg(),this.setState({sliderValue:this.props.initialValue}),this.setState({circleCenter:t(this.lineLength,this.props.initialValue)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.currentPalette,a=t.getCirclePosition,o=this.state.sliderValue;e.currentPalette!==n&&(this.updateSvg(),this.setState({circleCenter:a(this.lineLength,o)}))}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("orientationchange",this.updateSvg),window.removeEventListener("resize",this.updateSvg),U.default.removeEventListener("annotationChanged",this.onAnnotationChanged),null===(e=this.sliderSvg.current)||void 0===e||e.removeEventListener("touchmove",this.onMove,{passive:!1})}},{key:"render",value:function(){var e=this.props.property;return Re.i?C.a.createElement("div",{className:"slider"},this.renderSlider()):"Opacity"===e?this.renderSliderOpacity():this.renderSlider()}}]),n}(C.a.PureComponent);Me.propTypes=De,Me.defaultProps={initialValue:0};var Be=Me,Fe=Object(_.a)(null,{wait:!1})(Be),Ue=n("./src/constants/dataElement.js");function He(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return v()(this,n)}}var ze=100,Ke=function(e){f()(n,e);var t=He(n);function n(){var e;s()(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o)),E()(m()(e),"renderColorPalette",(function(){var t=e.props,n=t.style,a=t.onStyleChange,o=t.currentPalette,r=t.colorMapKey,i=t.annotation,l=t.placement,s=i&&i.Subject===x.g.REDACTION?"FillColor":o;return C.a.createElement(le,{color:n[s],property:s,onStyleChange:a,colorMapKey:r,annotation:i,placement:l})})),E()(m()(e),"renderSliders",(function(){var t=e.props,n=t.style.StrokeThickness,a=t.onStyleChange,o=t.isFreeText,r=t.annotation,l=t.isStrokeThicknessSliderDisabled,s=t.currentPalette,c=[],u=r.ToolName===z.a.SQUIGGLY||r.ToolName===z.a.HIGHTLIGHT||r.ToolName===z.a.UNDERLINE||r.ToolName===z.a.STRIKEOUT;return l||s!==x.b.STROKE_COLOR||u||c.push({dataElement:Ue.a.STROKE_THICKNESS_SLIDER,property:"StrokeThickness",displayProperty:"thickness",initialValue:n,getCirclePosition:function(e,t){return!o&&t<1?.05*e+8:(t>20?1:t/20)*e+8},convertRelativeCirclePositionToValue:function(e){return o?20*e:19*e+1},convertValue:function(e){return Math.round(e)},limitValue:{max:"20",min:o?"0":"1"}}),[n].map((function(e,t){if(null===e||void 0===e||!c[t])return null;var n=c[t],o=n.property;return C.a.createElement(Fe,i()({},n,{key:o,onStyleChange:a,annotation:r,currentPalette:s}))}))})),E()(m()(e),"renderSliderOpacity",(function(){var t,n=e.props,a=n.style,o=a.Opacity,r=a.FillColor,l=a.StrokeColor,s=n.onStyleChange,c=n.annotation,u=n.isOpacitySliderDisabled,d=n.currentPalette,m={};return u||(m={FillColor:r,StrokeColor:l,dataElement:Ue.a.OPACITY_SLIDER,property:"Opacity",displayProperty:"opacity",convertValue:function(e){return Math.round(e)/100},limitValue:{max:100,min:0},initialValue:Math.round(100*o),getCirclePosition:function(e,t){return(t>ze?1:t/100)*e+8},convertRelativeCirclePositionToValue:function(e){return 100*e}}),null!==o&&void 0!==o&&m?C.a.createElement(Fe,i()({},m,{key:null===(t=m)||void 0===t?void 0:t.property,onStyleChange:s,annotation:c,currentPalette:d})):null})),E()(m()(e),"renderTextColorComponent",(function(){var t=e.props,n=t.colorMapKey,a=t.style,o=t.onStyleChange,r=t.annotation,i=t.isAnnotationStylePopup;return"freeText"!==n?null:C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"colors-container","data-element":Ue.a.COLOR_PALETTE},C.a.createElement("div",{className:"inner-wrapper"},C.a.createElement(Pe,{colorPalette:x.b.TEXT_COLOR,colorMapKey:n,style:a,onStyleChange:o,annotation:r,isAnnotationStylePopup:i}),C.a.createElement(le,{color:null===a||void 0===a?void 0:a.TextColor,property:x.b.TEXT_COLOR,onStyleChange:o,colorMapKey:n}))),C.a.createElement("div",{className:"divider horizontal"}))})),e}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.isColorPaletteDisabled,n=e.currentPalette,a=e.style,o=e.colorMapKey,r=e.isSignature,i=e.isOpacitySliderDisabled,l=e.isStrokeThicknessSliderDisabled,s=e.isFontSizeSliderDisabled,c=e.isStylePopupDisabled,u=e.onStyleChange,d=e.isAnnotationStylePopup,m=e.hideOpacitySlider,p=e.hideThicknessSlider,f=e.annotation,h=l&&s,v=f&&f.Subject===x.g.REDACTION?"FillColor":n;return c?null:C.a.createElement("div",{className:"Popup StylePalette","data-element":Ue.a.STYLE_POPUP,onClick:function(e){return e.stopPropagation()},onScroll:function(e){return e.stopPropagation()}},this.renderTextColorComponent(),n&&!r&&!t&&C.a.createElement("div",{className:"colors-container","data-element":Ue.a.COLOR_PALETTE},C.a.createElement("div",{className:"inner-wrapper"},C.a.createElement(M,{colorPalette:v,colorMapKey:o,style:a,onStyleChange:u,isAnnotationStylePopup:d,annotation:f}),!h&&C.a.createElement("div",{className:"sliders-container"},!p&&C.a.createElement("div",{className:"sliders"},this.renderSliders())),this.renderColorPalette())),!i&&n!==x.b.TEXT_COLOR&&!m&&C.a.createElement("div",{className:"sliders-container"},C.a.createElement("div",{className:"sliders--opacity"},this.renderSliderOpacity())))}}]),n}(C.a.PureComponent);Ke.propTypes={style:T.a.object.isRequired,onStyleChange:T.a.func.isRequired,isFreeText:T.a.bool.isRequired,hideDivider:T.a.bool,colorMapKey:T.a.string,currentPalette:T.a.oneOf(["TextColor","StrokeColor","FillColor"]),isColorPaletteDisabled:T.a.bool,isOpacitySliderDisabled:T.a.bool,isStrokeThicknessSliderDisabled:T.a.bool,isFontSizeSliderDisabled:T.a.bool,isStyleOptionDisabled:T.a.bool,isStylePopupDisabled:T.a.bool,isSignature:T.a.bool,annotation:T.a.object,isAnnotationStylePopup:T.a.bool,hideOpacitySlider:T.a.bool,hideThicknessSlider:T.a.bool,placement:T.a.string},Ke.defaultProps={hideDivider:!1,colorMapKey:"",currentPalette:"TextColor",isColorPaletteDisabled:!1,isOpacitySliderDisabled:!1,isStrokeThicknessSliderDisabled:!1,isFontSizeSliderDisabled:!1,isStyleOptionDisabled:!1,isStylePopupDisabled:!1,isSignature:!1,annotation:{},isAnnotationStylePopup:!1,hideOpacitySlider:!1,hideThicknessSlider:!1,placement:"bottom"};var qe=Ke,Ge={COLOR_PALETTE:"colorPalette",OPACITY_SLIDER:"opacitySlider",STROKE_THICKNESS_SLIDER:"strokeThicknessSlider",FONT_SIZE_SLIDER:"fontSizeSlider",STYLE_OPTION:"styleOption"};t.a=Object(a.c)((function(e,t){var n=t.colorMapKey;return{currentPalette:o.a.getCurrentPalette(e,n),isStylePopupDisabled:o.a.isElementDisabled(e,Ge.STYLE_POPUP),isColorPaletteDisabled:o.a.isElementDisabled(e,Ge.COLOR_PALETTE),isOpacitySliderDisabled:o.a.isElementDisabled(e,Ge.OPACITY_SLIDER),isStrokeThicknessSliderDisabled:o.a.isElementDisabled(e,Ge.STROKE_THICKNESS_SLIDER),isFontSizeSliderDisabled:o.a.isElementDisabled(e,Ge.FONT_SIZE_SLIDER),isStyleOptionDisabled:o.a.isElementDisabled(e,Ge.STYLE_OPTION)}}))(qe)}}]);