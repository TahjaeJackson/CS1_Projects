(window.webpackJsonp=window.webpackJsonp||[]).push([[47,2],{"./node_modules/react-measure/dist/index.esm.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/esm/extends.js"),r=n("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),o=n("./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("./node_modules/react/index.js"),s=n("./node_modules/prop-types/index.js"),l=n.n(s),c=n("./node_modules/resize-observer-polyfill/dist/ResizeObserver.es.js"),u=["client","offset","scroll","bounds","margin"];function d(e){var t=[];return u.forEach((function(n){e[n]&&t.push(n)})),t}function m(e,t){var n={};if(t.indexOf("client")>-1&&(n.client={top:e.clientTop,left:e.clientLeft,width:e.clientWidth,height:e.clientHeight}),t.indexOf("offset")>-1&&(n.offset={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}),t.indexOf("scroll")>-1&&(n.scroll={top:e.scrollTop,left:e.scrollLeft,width:e.scrollWidth,height:e.scrollHeight}),t.indexOf("bounds")>-1){var a=e.getBoundingClientRect();n.bounds={top:a.top,right:a.right,bottom:a.bottom,left:a.left,width:a.width,height:a.height}}if(t.indexOf("margin")>-1){var r=getComputedStyle(e);n.margin={top:r?parseInt(r.marginTop):0,right:r?parseInt(r.marginRight):0,bottom:r?parseInt(r.marginBottom):0,left:r?parseInt(r.marginLeft):0}}return n}function p(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||window}var f=function(e){return function(t){var n,s;return s=n=function(n){function s(){for(var t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))||this).state={contentRect:{entry:{},client:{},offset:{},scroll:{},bounds:{},margin:{}}},t._animationFrameID=null,t._resizeObserver=null,t._node=null,t._window=null,t.measure=function(n){var a=m(t._node,e||d(t.props));n&&(a.entry=n[0].contentRect),t._animationFrameID=t._window.requestAnimationFrame((function(){null!==t._resizeObserver&&(t.setState({contentRect:a}),"function"===typeof t.props.onResize&&t.props.onResize(a))}))},t._handleRef=function(e){null!==t._resizeObserver&&null!==t._node&&t._resizeObserver.unobserve(t._node),t._node=e,t._window=p(t._node);var n=t.props.innerRef;n&&("function"===typeof n?n(t._node):n.current=t._node),null!==t._resizeObserver&&null!==t._node&&t._resizeObserver.observe(t._node)},t}Object(o.a)(s,n);var l=s.prototype;return l.componentDidMount=function(){this._resizeObserver=null!==this._window&&this._window.ResizeObserver?new this._window.ResizeObserver(this.measure):new c.default(this.measure),null!==this._node&&(this._resizeObserver.observe(this._node),"function"===typeof this.props.onResize&&this.props.onResize(m(this._node,e||d(this.props))))},l.componentWillUnmount=function(){null!==this._window&&this._window.cancelAnimationFrame(this._animationFrameID),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)},l.render=function(){var e=this.props,n=(e.innerRef,e.onResize,Object(r.a)(e,["innerRef","onResize"]));return Object(i.createElement)(t,Object(a.a)({},n,{measureRef:this._handleRef,measure:this.measure,contentRect:this.state.contentRect}))},s}(i.Component),n.propTypes={client:l.a.bool,offset:l.a.bool,scroll:l.a.bool,bounds:l.a.bool,margin:l.a.bool,innerRef:l.a.oneOfType([l.a.object,l.a.func]),onResize:l.a.func},s}}()((function(e){var t=e.measure,n=e.measureRef,a=e.contentRect;return(0,e.children)({measure:t,measureRef:n,contentRect:a})}));f.displayName="Measure",f.propTypes.children=l.a.func,t.a=f},"./src/constants/dataElement.js":function(e,t,n){"use strict";t.a={COLOR_PALETTE:"colorPalette",OPACITY_SLIDER:"opacitySlider",STROKE_THICKNESS_SLIDER:"strokeThicknessSlider",FONT_SIZE_SLIDER:"fontSizeSlider",STYLE_OPTION:"styleOption",STYLE_POPUP:"stylePopup",SCALE_INPUT_CONTAINER:"scaleInputContainer",PRECISION_INPUT_CONTAINER:"precisionInputContainer",ANNOTATION_POPUP:"annotationPopup",AREA_MEASUREMENT_TOOL_BUTTON:"areaMeasurementToolButton",ARROW_TOOL_BUTTON:"arrowToolButton",BOOKMARKS_PANEL:"bookmarksPanel",BOOKMARKS_PANEL_BUTTON:"bookmarksPanelButton",CLOUD_TOOL_BUTTON:"cloudToolButton",COUNT_MEASUREMENT_TOOL_BUTTON:"countMeasurementToolButton",CROP_TOOL_BUTTON:"cropToolButton",DISTANCE_MEASUREMENT_TOOL_BUTTON:"distanceMeasurementToolButton",ELLIPSE_MEASUREMENT_TOOL_BUTTON:"ellipseMeasurementToolButton",ELLIPSE_TOOL_BUTTON:"ellipseToolButton",ERASER_TOOL_BUTTON:"eraserToolButton",FILE_ATTACHMENT_TOOL_BUTTON:"fileAttachmentToolButton",FILE_PICKER_BUTTON:"filePickerButton",FILE_PICKER_HANDLER:"filePickerHandler",FREE_HANDTOOL_BUTTON:"freeHandToolButton",FREETEXT_TOOL_BUTTON:"freeTextToolButton",HIGHLIGHT_TOOL_BUTTON:"highlightToolButton",LAYERS_PANEL:"layersPanel",LAYERS_PANEL_BUTTON:"layersPanelButton",LINE_TOOL_BUTTON:"lineToolButton",LINK_BUTTON:"linkButton",MEASUREMENT_OVERLAY:"measurementOverlay",MEASUREMENT_TOOL_GROUP_BUTTON:"measurementToolGroupButton",PERIMETER_MEASUREMENT_TOOL_BUTTON:"perimeterMeasurementToolButton",POLYGON_TOOL_BUTTON:"polygonToolButton",POLYLINE_TOOL_BUTTON:"polylineToolButton",RECTANGLE_TOOL_BUTTON:"rectangleToolButton",RECTANGULAR_AREA_MEASUREMENT_TOOL_BUTTON:"rectangularAreaMeasurementToolButton",REDACTION_BUTTON:"redactionButton",REDO_BUTTON:"redoButton",RUBBER_STAMP_TOOL_BUTTON:"rubberStampToolButton",SHAPE_TOOL_GROUP_BUTTON:"shapeToolGroupButton",SIGNATURE_TOOL_BUTTON:"signatureToolButton",SQUIGGLY_TOOL_BUTTON:"squigglyToolButton",STAMP_TOOL_BUTTON:"stampToolButton",STICKY_TOOL_BUTTON:"stickyToolButton",STRIKEOUT_TOOL_BUTTON:"strikeoutToolButton",TEXT_HIGHLIGHT_TOOL_BUTTON:"textHighlightToolButton",TEXT_REDACT_TOOL_BUTTON:"textRedactToolButton",TEXT_SELECT_BUTTON:"textSelectButton",TEXT_SQUIGGLY_TOOL_BUTTON:"textSquigglyToolButton",TEXT_STRIKEOUT_TOOL_BUTTON:"textStrikeoutToolButton",TEXT_TOOL_GROUP_BUTTON:"textToolGroupButton",TEXT_UNDERLINE_TOOL_BUTTON:"textUnderlineToolButton",TOOLS_BUTTON:"toolsButton",UNDERLINE_TOOL_BUTTON:"underlineToolButton",UNDO_BUTTON:"undoButton",COPY_TEXT_BUTTON:"copyTextButton"}},"./src/helpers/getAnnotationStyles.js":function(e,t,n){"use strict";var a=n("./src/core/index.js");t.a=function(e){var t={};return["FillColor","StrokeColor","TextColor","Opacity","StrokeThickness","FontSize","Precision","Scale","Style","Font","FontStyle"].forEach((function(n){var a=e[n];null!==a&&void 0!==a&&(t[n]=e[n])})),"highlight"!==e.elementName||a.default.isBlendModeSupported(e.BlendMode)||(t.Opacity=null),e instanceof window.Annotations.RedactionAnnotation&&(t.Opacity=null,t.StrokeThickness=null,t.FontSize=null),t}},"./src/lumin-components/AnnotationStylePopup/index.js":function(e,t,n){"use strict";var a=n("./src/redux/actions/index.js"),r=n("./src/redux/selectors/index.js"),o=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=n.n(i),l=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),u=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(m),f=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=n.n(f),v=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=n.n(v),b=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=n.n(b),E=n("./node_modules/react/index.js"),O=n.n(E),C=n("./node_modules/prop-types/index.js"),T=n.n(C),P=n("./node_modules/lodash/debounce.js"),S=n.n(P),j=n("./src/lumin-components/StylePalette/index.js"),R=n("./src/core/index.js"),_=n("./src/helpers/getClassName.js"),N=n("./src/helpers/device.js"),x=n("./src/constants/map.js");function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=g()(e);if(t){var r=g()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return h()(this,n)}}var k={isDisabled:T.a.bool,annotation:T.a.object.isRequired,style:T.a.object.isRequired,closeElement:T.a.func.isRequired,placement:T.a.string},D=function(e){p()(n,e);var t=w(n);function n(e){var a;return s()(this,n),a=t.call(this,e),y()(d()(a),"handleStyleChange",(function(e,t){var n=a.props.annotation;R.default.setAnnotationStyles(n,y()({},e,t))})),y()(d()(a),"handleClick",(function(e){Object(N.m)()&&e.target===e.currentTarget&&a.props.closeElement("annotationPopup")})),a.debounceHandleStyleChange=S()(a.handleStyleChange,500),a}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.isDisabled,n=e.annotation,a=e.style,r=e.placement,o=n instanceof window.Annotations.FreeTextAnnotation&&n.getIntent()===window.Annotations.FreeTextAnnotation.Intent.FreeText,i="Signature"===n.Subject&&n instanceof window.Annotations.StampAnnotation,s=Object(_.a)("Popup AnnotationStylePopup",this.props),l=n instanceof window.Annotations.StampAnnotation,c=Object(x.c)(n);return t?null:O.a.createElement("div",{className:s,"data-element":"annotationStylePopup",onClick:this.handleClick},O.a.createElement(j.a,{colorMapKey:c,style:a,isFreeText:o,isSignature:i,annotation:n,onStyleChange:this.debounceHandleStyleChange,hideDivider:l,isAnnotationStylePopup:!0,placement:r}))}}]),n}(O.a.Component);D.propTypes=k,D.defaultProps={isDisabled:!1,placement:"bottom"};var L=D,A={closeElement:a.a.closeElement};t.a=Object(o.c)((function(e){return{isDisabled:r.a.isElementDisabled(e,"annotationStylePopup")}}),A)(L)},"./src/lumin-components/Button/index.js":function(e,t,n){"use strict";var a=n("./node_modules/react-redux/es/index.js"),r=n("./src/redux/selectors/index.js"),o=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(o),s=n("./node_modules/react/index.js"),l=n.n(s),c=n("./node_modules/classnames/index.js"),u=n.n(c),d=n("./node_modules/prop-types/index.js"),m=n.n(d),p=n("./src/lumin-components/Tooltip/index.js"),f=n("./src/lumin-components/Icon/index.js"),h={isActive:m.a.bool,mediaQueryClassName:m.a.string,img:m.a.string,label:m.a.oneOfType([m.a.string,m.a.number]),title:m.a.string,color:m.a.string,dataElement:m.a.string,className:m.a.string,onClick:m.a.func.isRequired,isElementDisabled:m.a.bool},v=function(e){var t,n,a=e.isActive,r=e.isDisabled,o=e.mediaQueryClassName,s=e.img,c=e.label,d=e.color,m=e.dataElement,h=e.onClick,v=e.className,g=e.title,b=e.isElementDisabled,y=u()((t={Button:!0,active:a,disabled:r},i()(t,o,o),i()(t,v,v),t)),E=s&&0===s.trim().indexOf("data:");s&&!E&&(-1===s.indexOf(".")||0===s.indexOf("<svg"))?n=l.a.createElement(f.a,{glyph:s,color:d}):s?n=l.a.createElement("img",{src:s}):c&&(n=l.a.createElement("p",null,c));var O=l.a.createElement("div",{className:y,"data-element":m,onClick:h},n);return b?null:g?l.a.createElement(p.a,{content:g},O):O};v.propTypes=h,v.defaultProps={onClick:function(){},isActive:!1,isDisabled:!1,isElementDisabled:!1};var g=l.a.memo(v);t.a=Object(a.c)((function(e,t){return{isElementDisabled:r.a.isElementDisabled(e,t.dataElement)}}))(g)},"./src/lumin-components/Element/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/inherits.js"),l=n.n(s),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=n.n(p),h=n("./node_modules/react/index.js"),v=n.n(h),g=n("./node_modules/prop-types/index.js"),b=n.n(g);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var E=function(e){l()(n,e);var t=y(n);function n(){return r()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.isDisabled,n=e.className,a=e.dataElement,r=e.children;return t?null:v.a.createElement("div",{className:n,"data-element":a},r)}}]),n}(v.a.PureComponent);f()(E,"propTypes",{isDisabled:b.a.bool,className:b.a.string.isRequired,dataElement:b.a.string.isRequired,children:b.a.node});var O=E,C=n("./node_modules/react-redux/es/index.js"),T=n("./src/redux/selectors/index.js");t.a=Object(C.c)((function(e,t){return{isDisabled:T.a.isElementDisabled(e,t.dataElement)}}))(O)},"./src/lumin-components/LeftPanelLumin/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/inherits.js"),l=n.n(s),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),f=n.n(p),h=n("./node_modules/react/index.js"),v=n.n(h),g=n("./node_modules/prop-types/index.js"),b=n.n(g),y=n("./node_modules/classnames/index.js"),E=n.n(y),O=n("./node_modules/react-redux/es/index.js"),C=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),T=n.n(C),P=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),S=n.n(P),j=n("./src/lumin-components/Button/index.js"),R=n("./src/lumin-components/ButtonMaterial/index.js"),_=n("./src/lumin-components/Element/index.js"),N=n("./src/redux/actions/index.js"),x=n("./src/redux/selectors/index.js");function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var k=function(e){l()(n,e);var t=w(n);function n(){var e;r()(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),S()(T()(e),"isActive",(function(t){return e.props.activePanel===t})),e}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.customPanels,a=t.isLeftPanelTabsDisabled,r=t.setActiveLeftPanel;if(a)return null;return v.a.createElement(_.a,{className:"LeftPanelTabs",dataElement:"leftPanelTabs"},[{className:"thumbnailsPanel",dataElement:"thumbnailsPanelButton",icon:"thumbnails",title:"component.thumbnailsPanel"},{className:"outlinesPanel",dataElement:"outlinesPanelButton",icon:"outlines",title:"component.outlinesPanel"},{className:"notesPanel",dataElement:"notesPanelButton",icon:"basic-notes",title:"component.notesPanel"},{className:"bookmarksPanel",dataElement:"bookmarksPanelButton",icon:"bookmark",title:"component.bookmarksPanel"}].map((function(t,n){return v.a.createElement(R.a,{key:n,className:"Button ".concat(e.isActive(t.className)?"active":""),dataElement:t.dataElement,icon:t.icon,onClick:function(){return r(t.className)},title:t.title})})),n.map((function(t,n){var a=t.panel,o=t.tab;return v.a.createElement(j.a,{key:o.dataElement||n,disabled:!e.isActive(a.dataElement),dataElement:o.dataElement,img:o.img,onClick:function(){return r(a.dataElement)},title:o.title})})))}}]),n}(v.a.Component);k.propTypes={activePanel:b.a.string.isRequired,customPanels:b.a.array.isRequired,isLeftPanelTabsDisabled:b.a.bool,setActiveLeftPanel:b.a.func.isRequired},k.defaultProps={isLeftPanelTabsDisabled:!1};var D={setActiveLeftPanel:N.a.setActiveLeftPanel},L=Object(O.c)((function(e){return{activePanel:x.a.getActiveLeftPanel(e),customPanels:x.a.getCustomPanels(e),disabledCustomPanelTabs:x.a.getDisabledCustomPanelTabs(e),isLeftPanelTabsDisabled:x.a.isElementDisabled(e,"leftPanelTabs")}}),D)(k),A=n("./src/lumin-components/NotesPanel/index.js"),I=n("./src/core/index.js"),M=n("./src/helpers/logger.js"),B=n("./src/constants/lumin-common.js"),F=n("./src/constants/messages.js"),U=n("./node_modules/@babel/runtime/regenerator/index.js"),H=n.n(U),z=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),q=n.n(z),V=n("./src/helpers/device.js"),K=function(){var e=q()(H.a.mark((function e(t){var n,a,r,o;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.default.getDocument(),a=I.default.getAnnotationManager(),r=n.getPageCount(),!t.some((function(e){return e<1||e>r}))){e.next=6;break}return e.abrupt("return",Promise.reject("Page out of range, please enter an array of numbers between 1 and ".concat(r)));case 6:return o=new Promise((function(e,r){try{var o=new Map;t.forEach((function(e){return o.set(e,!0)}));var i=a.getAnnotationsList().filter((function(e){return o.has(e.PageNumber)}));a.exportAnnotations({annotList:i}).then((function(a){n.extractPages(t,a).then((function(t){var a=new Uint8Array(t),r=n.getFilename()||"extractedDocument.pdf",o=null;o=V.h?new Blob([a],{type:"application/pdf"}):new File([a],r,{type:"application/pdf"}),e(o)})).catch((function(e){r(e)}))}))}catch(s){r(s)}})),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=n("./src/helpers/fireEvent.js"),W=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(a){return a(N.a.openElement("loadingModal")),new Promise((function(r,o){I.default.mergeDocument(e,t).then((function(e){a(N.a.closeElement("loadingModal")),I.default.setCurrentPage(t),n&&Object(G.a)("documentMerged",e),r(e)})).catch((function(e){o(e),a(N.a.closeElement("loadingModal"))}))}))}},Y=n("./node_modules/lodash/debounce.js"),X=n.n(Y),J=n("./node_modules/react-virtualized/dist/es/index.js"),Q=n("./node_modules/react-measure/dist/index.esm.js"),Z=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),$=n.n(Z);function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var te=150,ne=function(e){l()(n,e);var t=ee(n);function n(e){var a;return r()(this,n),a=t.call(this,e),S()(T()(a),"loadThumbnailAsync",(function(){var e=a.props,t=e.index,n=e.onLoadThumbnail,r=T()(a).thumbContainer.current,o=t+1;if(I.default.getDocument()||!I.default.getPageInfo(o)){var i=I.default.loadThumbnailAsync(o,(function(e){e.className="page-image",e.style.maxWidth="".concat(te,"px"),e.style.maxHeight="".concat(te,"px");var n=null===r||void 0===r?void 0:r.querySelector(".page-image");n&&r.removeChild(n),null===r||void 0===r||r.appendChild(e),a.props.updateAnnotations&&a.props.updateAnnotations(t),a.props.onFinishLoading(t)}));return n(t,a.thumbContainer.current,i),i}})),S()(T()(a),"handleClick",(function(e){var t=a.props,n=t.index,r=t.closeElement,o=t.selectedPageIndexes,i=t.setSelectedPageThumbnails;if(t.isThumbnailMultiselectEnabled){var s=e.ctrlKey||e.metaKey,l=$()(o);s?o.indexOf(n-1)>-1?l=o.filter((function(e){return n-1!==e})):l.push(n-1):l=[],i(l)}else Object(V.m)()&&r("leftPanel");I.default.setCurrentPage(n+1)})),S()(T()(a),"onDragStart",(function(e){var t=a.props,n=t.index;(0,t.onDragStart)(e,n)})),S()(T()(a),"onDragOver",(function(e){var t=a.props,n=t.index;(0,t.onDragOver)(e,n)})),a.thumbContainer=v.a.createRef(),a.onLayoutChangedHandler=a.onLayoutChanged.bind(T()(a)),a.loadThumbnailAsyncDelayed=X()(a.loadThumbnailAsync,100),a}return i()(n,[{key:"componentDidMount",value:function(){this.loadThumbnailAsyncDelayed(),I.default.addEventListener("layoutChanged",this.onLayoutChangedHandler)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.onCancel,a=t.index;!e.canLoad&&this.props.canLoad&&this.loadThumbnailAsyncDelayed(),e.canLoad&&!this.props.canLoad&&n(a)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.onRemove,n=e.index;I.default.removeEventListener("layoutChanged",this.onLayoutChangedHandler),t(n)}},{key:"onLayoutChanged",value:function(e){var t=e.contentChanged,n=e.moved,a=e.added,r=e.removed,o=this.props,i=o.index,s=o.pageLabels,l=i+1,c=a.indexOf(l)>-1,u=t.some((function(e){return l===e})),d=Object.keys(n).some((function(e){return l===parseInt(e)})),m=r.indexOf(l)>-1,p=s.length-r.length;r.length>0&&i+1>p||(c||u||d||m)&&(this.loadThumbnailAsyncDelayed(),this.props.updateAnnotations&&this.props.updateAnnotations(i))}},{key:"render",value:function(){var e=this.props,t=e.index,n=e.currentPage===t+1,a=e.pageLabels[t];return v.a.createElement("div",{className:E()({Thumbnail:!0,active:n}),onClick:this.handleClick},v.a.createElement("div",{className:"container",ref:this.thumbContainer}),v.a.createElement("div",{className:"page-label"},a))}}]),n}(v.a.PureComponent);ne.propTypes={index:b.a.number.isRequired,currentPage:b.a.number.isRequired,pageLabels:b.a.array.isRequired,canLoad:b.a.bool.isRequired,isThumbnailMultiselectEnabled:b.a.bool,onLoadThumbnail:b.a.func.isRequired,onFinishLoading:b.a.func.isRequired,onCancel:b.a.func.isRequired,onRemove:b.a.func.isRequired,updateAnnotations:b.a.func,closeElement:b.a.func.isRequired,onDragStart:b.a.func,onDragOver:b.a.func,setSelectedPageThumbnails:b.a.func,selectedPageIndexes:b.a.arrayOf(b.a.number)},ne.defaultProps={updateAnnotations:function(){},onDragStart:function(){},onDragOver:function(){},setSelectedPageThumbnails:function(){},selectedPageIndexes:[],isThumbnailMultiselectEnabled:!1};var ae=ne,re={closeElement:N.a.closeElement,setSelectedPageThumbnails:N.a.setSelectedPageThumbnails},oe=Object(O.c)((function(e){return{currentPage:x.a.getCurrentPage(e),pageLabels:x.a.getPageLabels(e),selectedPageIndexes:x.a.getSelectedThumbnailPageIndexes(e),isThumbnailMultiselectEnabled:x.a.getIsThumbnailMultiselectEnabled(e)}}),re)(ae),ie=n("./src/constants/types.js");function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var ue="dataTransferWebViewerFrame",de=function(e){l()(n,e);var t=ce(n);function n(){var e;return r()(this,n),e=t.call(this),S()(T()(e),"onAfterManipulationUpdated",(function(){e.removeEvents(),e.onManipupdated()})),S()(T()(e),"removeEvents",(function(){I.default.removeEventListener("beginRendering",e.onBeginRendering),I.default.removeEventListener("finishedRendering",e.onFinishedRendering),I.default.removeEventListener("annotationChanged",e.onAnnotationChanged),I.default.removeEventListener("layoutChanged",e.onLayoutChanged),I.default.removeEventListener("documentLoaded",e.onDocumentLoaded),I.default.removeEventListener("pageNumberUpdated",e.onPageNumberUpdated),I.default.removeEventListener("pageComplete",e.onPageComplete),I.default.removeEventListener("annotationHidden",e.onAnnotationChanged),I.default.docViewer.removeEventListener("native_manipUpdated",e.onManipupdated)})),S()(T()(e),"onManipupdated",(function(){e.setState({canLoadThumb:!0}),I.default.addEventListener("beginRendering",e.onBeginRendering),I.default.addEventListener("finishedRendering",e.onFinishedRendering),I.default.addEventListener("annotationChanged",e.onAnnotationChanged),I.default.addEventListener("layoutChanged",e.onLayoutChanged),I.default.addEventListener("documentLoaded",e.onDocumentLoaded),I.default.addEventListener("pageNumberUpdated",e.onPageNumberUpdated),I.default.addEventListener("pageComplete",e.onPageComplete),I.default.addEventListener("annotationHidden",e.onAnnotationChanged)})),S()(T()(e),"onBeginRendering",(function(){e.setState({canLoad:!1})})),S()(T()(e),"onDragEnd",(function(){e.setState({draggingOverPageIndex:null})})),S()(T()(e),"onPageComplete",(function(){e.afterMovePageNumber&&(I.default.setCurrentPage(e.afterMovePageNumber),e.afterMovePageNumber=null)})),S()(T()(e),"onDragOver",(function(t,n){t.preventDefault(),t.stopPropagation();var a=e.getNumberOfColumns(e.state.width),r=e.props,o=r.isThumbnailReorderingEnabled,i=r.isThumbnailMergingEnabled;if(o||i){var s=t.target.getBoundingClientRect(),l=!1;l=a>1?t.pageX<=s.x+s.width/2:t.pageY<=s.y+s.height/2,e.setState({draggingOverPageIndex:n,isDraggingToPreviousPage:l})}})),S()(T()(e),"onDragStart",(function(t,n){var a,r=e.props,o=r.selectedPageIndexes,i=r.isThumbnailMergingEnabled,s=r.isMultipleViewerMerging,l=r.setSelectedPageThumbnails,c=o.some((function(e){return e===n})),u=c?o.map((function(e){return e+1})):[n+1];t.dataTransfer.setData("text",""),u.length>1&&t.dataTransfer.setDragImage(new Image,0,0),i&&s&&(t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="all",t.dataTransfer.setData(ue,window.frameElement.id),a=u,window.extractedDataPromise=K(a),window.pagesExtracted=a),c||l([]),I.default.setCurrentPage(n+1)})),S()(T()(e),"onDrop",(function(t){t.preventDefault();var n=e.props,a=n.isThumbnailMergingEnabled,r=n.mergeExternalWebViewerDocument,o=n.mergeDocument,i=n.selectedPageIndexes,s=n.isThumbnailReorderingEnabled,l=n.currentPage,c=e.state,u=c.draggingOverPageIndex,d=c.isDraggingToPreviousPage,m=t.dataTransfer.files,p=d?u+1:u+2,f=t.dataTransfer.getData(ue),h=f&&window.frameElement.id!==f||m.length,v=l-1;if(a&&h)f&&window.frameElement.id!==f?r(f,p):m.length&&o(m[0],p);else if(s&&!h&&null!==u){var g=d?u+1:u+2,b=i.some((function(e){return e===v}))?i.map((function(e){return e+1})):[l],y=g-b.filter((function(e){return e<g})).length;e.afterMovePageNumber=y,I.default.movePages(b,g)}e.setState({draggingOverPageIndex:null})})),S()(T()(e),"onFinishedRendering",(function(t){t||e.setState({canLoad:!0})})),S()(T()(e),"onAnnotationChanged",(function(t){var n=[];t.forEach((function(t){var a=t.PageNumber-1;!t.Listable||n.indexOf(a)>-1||(n.push(a),e.updateAnnotations(a))}))})),S()(T()(e),"onLayoutChanged",(function(t){if(t){var n=e.props,a=n.selectedPageIndexes,r=n.setSelectedPageThumbnails,o=Array.from(a);t.removed&&(o=o.filter((function(e){return-1===t.removed.indexOf(e+1)}))),t.moved&&(o=o.map((function(e){return t.moved[e+1]?t.moved[e+1]-1:e}))),r(o)}})),S()(T()(e),"onDocumentLoaded",(function(){var t=e.props.setSelectedPageThumbnails;I.default.getDocument().type!==ie.a.PDF?e.setState({allowPageOperations:!1}):e.setState({allowPageOperations:!0}),e.activeThumbRenders={},t([])})),S()(T()(e),"onPageNumberUpdated",(function(t){if(e.listRef.current){var n=e.getNumberOfColumns(e.state.width),a=t-1;e.listRef.current.scrollToRow(Math.floor(a/n))}})),S()(T()(e),"getNumberOfColumns",(function(e){return Math.min(3,Math.max(1,Math.floor(e/160)))})),S()(T()(e),"updateAnnotations",(function(t){var n=e.thumbs[t]&&e.thumbs[t].element;if(n){var a=t+1,r=I.default.getPageWidth(a),o=I.default.getPageHeight(a),i=e.getThumbnailSize(r,o),s=i.width,l=i.height,c=n.querySelector(".annotation-image")||document.createElement("canvas");c.className="annotation-image",c.style.maxWidth="".concat(te,"px"),c.style.maxHeight="".concat(te,"px");var u=c.getContext("2d"),d=1,m=I.default.getCompleteRotation(a)-I.default.getRotation(a);m<0&&(m+=4);var p=window.utils.getCanvasMultiplier();m%2===0?(c.width=s,c.height=l,d=c.width/r,d/=p):(c.width=l,c.height=s,d=c.height/r,d/=p),null===n||void 0===n||n.appendChild(c),I.default.setAnnotationCanvasTransform(u,d,m);var f={pageNumber:a,overrideCanvas:c,namespace:"thumbnails"},h=n.querySelector(".page-image");if(h)f=le(le({},f),{},{overridePageRotation:m,overridePageCanvas:h}),e.activeThumbRenders[a]||(e.activeThumbRenders[a]=X()(I.default.drawAnnotations,100)),(0,e.activeThumbRenders[a])(f)}})),S()(T()(e),"getThumbnailSize",(function(e,t){var n,a,r;return e>t?(r=e/te,n=te,a=Math.round(t/r)):(r=t/te,n=Math.round(e/r),a=te),{width:n,height:a}})),S()(T()(e),"onLoadThumbnail",(function(t,n,a){e.thumbIsLoaded(t)||e.thumbIsPending(t)||(e.thumbs[t]={element:n,loaded:!1},e.pendingThumbs.push({pageIndex:t,id:a}))})),S()(T()(e),"removeFromPendingThumbs",(function(t){var n=e.getPendingThumbIndex(t);-1!==n&&e.pendingThumbs.splice(n,1)})),S()(T()(e),"thumbIsLoaded",(function(t){var n;return null===(n=e.thumbs[t])||void 0===n?void 0:n.loaded})),S()(T()(e),"thumbIsPending",(function(t){return-1!==e.getPendingThumbIndex(t)})),S()(T()(e),"onCancel",(function(t){var n=e.getPendingThumbIndex(t);-1!==n&&(I.default.cancelLoadThumbnail(e.pendingThumbs[n].id),e.pendingThumbs.splice(n,1))})),S()(T()(e),"getPendingThumbIndex",(function(t){return e.pendingThumbs.findIndex((function(e){return e.pageIndex===t}))})),S()(T()(e),"onRemove",(function(t){e.onCancel(t),e.thumbs[t]=null})),S()(T()(e),"renderThumbnails",(function(t){var n=t.index,a=t.key,r=t.style,o=e.state,i=o.canLoad,s=o.width,l=o.allowPageOperations,c=e.getNumberOfColumns(s),u=e.props,d=u.isThumbnailReorderingEnabled,m=u.isThumbnailMergingEnabled,p=u.selectedPageIndexes,f=E()({columnsOfThumbnails:c>1,row:!0});return v.a.createElement("div",{className:f,key:a,style:r},new Array(c).fill().map((function(t,a){var r=n*c+a,o=l&&(m||d);return r<=e.props.totalPages?v.a.createElement("div",{key:r},v.a.createElement(oe,{isDraggable:o,isSelected:p.includes(r),index:r,canLoad:i,onLoadThumbnail:e.onLoadThumbnail,onCancel:e.onCancel,onRemove:e.onRemove,onDragStart:e.onDragStart,onDragOver:e.onDragOver,onFinishLoading:e.removeFromPendingThumbs,updateAnnotations:e.updateAnnotations,shouldShowControls:l})):null})))})),S()(T()(e),"toggleDocumentControl",(function(){e.props.setSelectedPageThumbnails([])})),S()(T()(e),"onPanelResize",(function(t){var n=t.bounds;e.setState({height:n.height,width:n.width})})),e.pendingThumbs=[],e.thumbs=[],e.listRef=v.a.createRef(),e.afterMovePageNumber=null,e.isDraggingGroup=!1,e.activeThumbRenders={},e.state={canLoad:!0,height:0,width:0,draggingOverPageIndex:null,isDraggingToPreviousPage:!1,allowPageOperations:!0,canLoadThumb:!1},e}return i()(n,[{key:"componentDidMount",value:function(){this.onManipupdated(),I.default.docViewer.addEventListener("native_manipUpdated",this.onAfterManipulationUpdated)}},{key:"componentWillUnmount",value:function(){this.removeEvents()}},{key:"render",value:function(){var e=this,t=this.props,n=t.isDisabled,a=t.totalPages,r=t.display,o=this.state,i=o.height,s=o.width,l=o.canLoadThumb,c=this.getNumberOfColumns(this.state.width);return n||!l?null:v.a.createElement("div",{className:"Panel ThumbnailsPanel",style:{display:r},"data-element":"thumbnailsPanel",onDrop:this.onDrop},v.a.createElement(Q.a,{bounds:!0,onResize:this.onPanelResize},(function(t){var n=t.measureRef;return v.a.createElement("div",{ref:n,className:"virtualized-thumbnails-container"},v.a.createElement(J.f,{ref:e.listRef,height:i,width:s,rowHeight:200,rowCount:Math.ceil(a/c),rowRenderer:e.renderThumbnails,overscanRowCount:10,className:"thumbnailsList",style:{outline:"none"}}))})))}}]),n}(v.a.PureComponent);de.propTypes={isDisabled:b.a.bool,totalPages:b.a.number,display:b.a.string.isRequired,selectedPageIndexes:b.a.arrayOf(b.a.number),mergeExternalWebViewerDocument:b.a.func.isRequired,mergeDocument:b.a.func.isRequired,setSelectedPageThumbnails:b.a.func.isRequired,currentPage:b.a.number,isThumbnailMergingEnabled:b.a.bool,isThumbnailReorderingEnabled:b.a.bool,isMultipleViewerMerging:b.a.bool},de.defaultProps={isDisabled:!1,totalPages:1,selectedPageIndexes:[],currentPage:1,isThumbnailMergingEnabled:!1,isMultipleViewerMerging:!1,isThumbnailReorderingEnabled:!1};var me=de,pe=Object(O.c)((function(e){return{isDisabled:x.a.isElementDisabled(e,"thumbnailsPanel"),totalPages:x.a.getTotalPages(e),currentPage:x.a.getCurrentPage(e),selectedPageIndexes:x.a.getSelectedThumbnailPageIndexes(e),isThumbnailMergingEnabled:x.a.getIsThumbnailMergingEnabled(e),isThumbnailReorderingEnabled:x.a.getIsThumbnailReorderingEnabled(e),isMultipleViewerMerging:x.a.getIsMultipleViewerMerging(e)}}),(function(e){return{dispatch:e,setSelectedPageThumbnails:function(t){return e(N.a.setSelectedPageThumbnails(t))},showWarningMessage:function(t){return e(N.a.showWarningMessage(t))},mergeDocument:function(t,n){return e(W(t,n))},mergeExternalWebViewerDocument:function(t,n){return e(function(e,t){return function(n){return new Promise((function(a,r){var o=window.parent.document.querySelector("#".concat(e));o||(M.a.logInfo({message:F.z.FIND_WEBVIEWER_INSTANCE,reason:B.t.Service.PDFTRON}),r());var i=o.contentWindow.extractedDataPromise;i||(M.a.logInfo({message:F.z.RETRIEVE_DATA_WEBVIEWER_INSTANCE,reason:B.t.Service.PDFTRON}),r()),n(N.a.openElement("loadingModal")),i.then((function(e){n(W(e,t,!1)).then((function(e){var t=e.filename,r=e.pages;Object(G.a)("documentMerged",{filename:t,pages:o.contentWindow.pagesExtracted}),n(N.a.closeElement("loadingModal")),a({filename:t,pages:r})}))})).catch((function(e){n(N.a.closeElement("loadingModal")),r(e)}))}))}}(t,n))}}}))(me),fe=n("./node_modules/react-i18next/dist/es/withTranslation.js"),he=n("./src/lumin-components/Icomoon/index.js");function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var ge={outline:b.a.object.isRequired,closeElement:b.a.func.isRequired,isVisible:b.a.bool.isRequired},be=function(e){l()(n,e);var t=ve(n);function n(){var e;r()(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),S()(T()(e),"state",{isExpanded:!1}),S()(T()(e),"onClickExpand",(function(){e.setState((function(e){return{isExpanded:!e.isExpanded}}))})),S()(T()(e),"onClickOutline",(function(){var t=e.props,n=t.outline,a=t.closeElement;I.default.goToOutline(n),Object(V.m)()&&a("leftPanel")})),e}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.outline,a=e.isVisible,r=e.closeElement,o=this.state.isExpanded;return v.a.createElement("div",{className:"Outline ".concat(a?"visible":"hidden")},v.a.createElement("div",{className:"padding"},t.children.length>0&&v.a.createElement("div",{className:"arrow ".concat(o?"expanded":"collapsed"),onClick:this.onClickExpand},v.a.createElement(he.a,{icon:"next-page"}))),v.a.createElement("div",{className:"content"},v.a.createElement("div",{className:"title",onClick:this.onClickOutline},t.name),t.children.map((function(e,t){return v.a.createElement(n,{outline:e,key:t,isVisible:o,closeElement:r})}))))}}]),n}(v.a.PureComponent);be.propTypes=ge;var ye={closeElement:N.a.closeElement},Ee=Object(O.c)(null,ye)(be),Oe=n("./src/helpers/getClassName.js");function Ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var Te=function(e){l()(n,e);var t=Ce(n);function n(){return r()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.isDisabled,n=e.outlines,a=e.t,r=e.display;if(t)return null;var o=Object(Oe.a)("Panel OutlinesPanel",this.props);return v.a.createElement("div",{className:o,style:{display:r},"data-element":"outlinesPanel"},0===n.length&&v.a.createElement("div",{className:"no-outlines"},v.a.createElement(he.a,{className:"outlines icon__88"}),v.a.createElement("p",null,a("message.noOutlines"))),n.map((function(e,t){return v.a.createElement(Ee,{key:t,outline:e,isVisible:!0})})))}}]),n}(v.a.PureComponent);S()(Te,"propTypes",{outlines:b.a.arrayOf(b.a.object),display:b.a.string.isRequired,isDisabled:b.a.bool,t:b.a.func.isRequired});var Pe=Object(O.c)((function(e){return{outlines:x.a.getOutlines(e),isDisabled:x.a.isElementDisabled(e,"outlinePanel")}}))(Object(fe.a)()(Te));function Se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var je={bookmark:b.a.object.isRequired,closeElement:b.a.func.isRequired,isVisible:b.a.bool.isRequired,setActiveBookmark:b.a.func,activeBookmark:b.a.number,isRootBookmark:b.a.bool},Re=function(e){l()(n,e);var t=Se(n);function n(){var e;r()(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),S()(T()(e),"state",{isExpanded:!1}),S()(T()(e),"onClickExpand",(function(){e.setState((function(e){return{isExpanded:!e.isExpanded}}))})),S()(T()(e),"onClickBookmark",(function(){var t=e.props,n=t.bookmark,a=t.closeElement,r=t.setActiveBookmark;n.getHPos()||n.getVPos()?I.default.gotoOutline(n):I.default.setCurrentPage(n.getPageNumber()),r(n.getPageNumber()),Object(V.m)()&&a("leftPanel")})),e}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.bookmark,a=e.isVisible,r=e.closeElement,o=e.setActiveBookmark,i=e.activeBookmark,s=e.isRootBookmark,l=this.state.isExpanded;return v.a.createElement("div",{className:"Bookmark ".concat(a?"visible":"hidden")},v.a.createElement("div",{className:"padding"},t.children.length>0&&v.a.createElement("div",{className:"arrow ".concat(l?"expanded":"collapsed"),onClick:this.onClickExpand},v.a.createElement(he.a,{className:"next-page"}))),v.a.createElement("div",{className:"content"},v.a.createElement("div",{className:"title ".concat(s&&i===t.getPageNumber()?"title--bold":""),onClick:this.onClickBookmark},t.name),t.children.map((function(e,t){return v.a.createElement(n,{bookmark:e,key:t,isVisible:l,closeElement:r,setActiveBookmark:o})}))))}}]),n}(v.a.PureComponent);Re.propTypes=je,Re.defaultProps={setActiveBookmark:function(){},activeBookmark:-1,isRootBookmark:!1};var _e=Re,Ne={closeElement:N.a.closeElement},xe=Object(O.c)(null,Ne)(_e),we=n("./src/screens/Viewer/Context.js"),ke={bookmarks:b.a.arrayOf(b.a.object),display:b.a.string.isRequired,setBookmarks:b.a.func,isDisabled:b.a.bool,t:b.a.func.isRequired},De=function(e){var t=e.t,n=e.display,a=e.bookmarks,r=e.setBookmarks,o=e.isDisabled,i=Object(h.useContext)(we.a).bookmarkIns,s=Object(h.useState)(null),l=f()(s,2),c=l[0],u=l[1];Object(h.useEffect)((function(){return I.default.docViewer.addEventListener("native_manipUpdated",d),function(){I.default.docViewer.removeEventListener("native_manipUpdated",d)}}));var d=function(){var e=[];Object.keys(i.bookmarksUser).forEach((function(t){var n=new I.default.CoreControls.Bookmark([],i.bookmarksUser[t].message,parseInt(t),null,0,0);e.push(n)})),r(e)};if(o)return null;return v.a.createElement("div",{className:"Panel BookmarksPanel",style:{display:n},"data-element":"bookmarksPanel"},a&&0===a.length&&v.a.createElement("div",{className:"no-bookmarks"},v.a.createElement(he.a,{className:"bookmark icon__88"}),v.a.createElement("p",null,t("message.noBookmarks"))),a&&a.map((function(e,t){return v.a.createElement(xe,{key:t,bookmark:e,activeBookmark:c,setActiveBookmark:function(e){return u(e)},isRootBookmark:!0,isVisible:!0})})))};De.propTypes=ke,De.defaultProps={bookmarks:[],setBookmarks:function(){},isDisabled:!1};var Le=Object(fe.a)()(De),Ae=Object(O.c)((function(e){return{bookmarks:x.a.getBookmarks(e),isDisabled:x.a.isElementDisabled(e,"bookmarkPanel")}}),(function(e){return{setBookmarks:function(t){return e(N.a.setBookmarks(t))}}}))(Object(fe.a)(null,{wait:!1})(Le)),Ie=n("./node_modules/@material-ui/core/esm/Button/Button.js"),Me=n("./src/lumin-components/CustomElement/index.js");function Be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var Fe=function(){var e=Object(O.f)((function(e){return[x.a.isElementDisabled(e,"leftPanel"),x.a.isElementOpen(e,"leftPanel"),x.a.getActiveLeftPanel(e),x.a.getCustomPanels(e),x.a.getTotalPages(e),x.a.getLeftPanelWidth(e),x.a.getIsShowTopBar(e)]}),O.d),t=f()(e,7),n=t[0],a=t[1],r=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=Object(O.e)();Object(h.useEffect)((function(){a&&Object(V.p)()&&c(N.a.closeElement("searchPanel"))}),[c,a]);var u=function(e){return e===r?"flex":"none"},d=V.i&&s?{width:s}:{};return n?null:v.a.createElement("div",{className:E()({Panel:!0,LeftPanelLumin:!0,open:a,closed:!a,"no-topbar":!l}),"data-element":"leftPanel",style:d},v.a.createElement("div",{className:"LeftPanelLumin__top"},v.a.createElement("p",null,function(){var e=r.slice(0,r.length-5);return e.charAt(0).toUpperCase()+e.slice(1)}()),v.a.createElement("span",null," ","".concat(i," pages")),v.a.createElement("div",{className:"close_btn_wrapper"},v.a.createElement(Ie.a,{className:"CloseLeftPanel__btn",onClick:function(){return c(N.a.closeElement("leftPanel"))}},v.a.createElement(he.a,{className:"cross icon__12 icon",size:12})))),v.a.createElement("div",{className:"left-panel-header"},v.a.createElement(L,null)),v.a.createElement(Ue,null,v.a.createElement(A.a,{display:u("notesPanel")})),v.a.createElement(pe,{display:u("thumbnailsPanel")}),v.a.createElement(Pe,{display:u("outlinesPanel")}),v.a.createElement(Ae,{display:u("bookmarksPanel")}),o.map((function(e,t){var n=e.panel;return v.a.createElement(Me.a,{key:n.dataElement||t,className:"Panel ".concat(n.dataElement),display:u(n.dataElement),dataElement:n.dataElement,render:n.render})})))},Ue=function(e){l()(n,e);var t=Be(n);function n(e){var a;return r()(this,n),(a=t.call(this,e)).state={hasError:!1},a}return i()(n,null,[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0}}}]),i()(n,[{key:"render",value:function(){return this.state.hasError?null:this.props.children}}]),n}(v.a.Component);Ue.propTypes={children:b.a.element},Ue.defaultProps={children:v.a.createElement(v.a.Fragment,null)},Fe.propTypes={},Fe.defaultProps={};var He=Fe;t.default=He},"./src/lumin-components/ListSeparator/index.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),r=n.n(a);var o=function(e){var t=e.selectedPage,n=e.currentPage;return r.a.createElement("div",{className:"ListSeparator ".concat(t==n?"active":"")},e.renderContent())};t.a=o},"./src/lumin-components/MaterialSelect/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=n.n(s),c=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(p),h=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=n.n(h),g=n("./node_modules/react/index.js"),b=n.n(g),y=n("./node_modules/prop-types/index.js"),E=n.n(y),O=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),C=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),T=n("./node_modules/@material-ui/core/esm/styles/withStyles.js"),P=n("./node_modules/lodash/capitalize.js"),S=n.n(P),j=n("./node_modules/classnames/index.js"),R=n.n(j),_=n("./src/lumin-components/Icomoon/index.js"),N=n("./src/lumin-components/LuminPlanLabel/index.js"),x=n("./src/constants/lumin-common.js"),w=n("./src/constants/styles/index.js"),k=n("./src/lumin-components/MaterialPopper/index.js");function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=f()(e);if(t){var r=f()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return m()(this,n)}}var L=Object(T.a)({disabledMenu:{"&:hover":{cursor:"auto",background:"inherit"}}}),A=function(e){u()(n,e);var t=D(n);function n(e){var a;return r()(this,n),a=t.call(this,e),v()(l()(a),"togglePopper",(function(){a.setState((function(e){return{popperShow:!e.popperShow}}))})),v()(l()(a),"closePopper",(function(e){a.anchorEl.contains(e.target)||a.setState({popperShow:!1})})),v()(l()(a),"onItemClick",(function(e){var t=a.props.onSelected;a.setState({popperShow:!1}),t(e)})),a.state={popperShow:!1},a}return i()(n,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.items,r=n.containerClasses,o=n.inputClasses,i=n.value,s=n.blankMessage,l=n.disabled,c=n.classes,u=n.childNameComponent,d=n.arrowStyle,m=this.state.popperShow,p=a.find((function(e){return e.value===i}));return b.a.createElement("div",{className:"MaterialSelect ".concat(r||""," ").concat(m?"MaterialSelect--focus":""," ").concat(l?"disabled":"")},b.a.createElement("div",{className:R()("MaterialSelect__input",(e={},v()(e,o,Boolean(o)),v()(e,"MaterialSelect__input--disabled",l),e)),onClick:l?null:function(){return t.togglePopper()},ref:function(e){t.anchorEl=e}},b.a.createElement("span",{className:"form__text--overflow ".concat(p&&p.class?p.class:"")},p?p.name:"- Choose one -"),b.a.createElement(_.a,{className:"dropdown icon__9 MaterialSelect__input__icon_dropdown",color:d.color,size:d.size})),b.a.createElement(k.a,{open:m,anchorEl:this.anchorEl,handleClose:this.closePopper,placement:"bottom",classes:"MaterialSelect__popper"},b.a.createElement(O.a,null,a.length>0?a.map((function(e){var n;return b.a.createElement(C.a,{className:"Menu__item ".concat(e.disabled?"disabled":""," ").concat(e.selected?"selected":""),key:JSON.stringify(e),onClick:e.disabled?null:function(){return t.onItemClick(e)}},b.a.createElement("div",{className:"item__container"},b.a.createElement("div",{className:"form__text--overflow ".concat(null!==(n=e.class)&&void 0!==n?n:"")},"".concat(e.name," ").concat(e.note?e.note:"")," ",e.value===i&&u),b.a.createElement("div",null,e.payment&&b.a.createElement(N.a,{label:S()(e.payment.type),entity:x.k.ORGANIZATION,payment:e.payment}))))})):b.a.createElement(C.a,{className:c.disabledMenu,disableRipple:!0},s||"Nothing to choose"))))}}]),n}(b.a.PureComponent);A.propTypes={items:E.a.array,containerClasses:E.a.string,inputClasses:E.a.string,value:E.a.any,blankMessage:E.a.oneOfType([E.a.string,E.a.node]),disabled:E.a.bool,onSelected:E.a.func,classes:E.a.object,childNameComponent:E.a.element,arrowStyle:E.a.shape({size:E.a.number,color:E.a.string})},A.defaultProps={items:[],containerClasses:"",inputClasses:"",value:0,blankMessage:"",disabled:!1,onSelected:function(){},classes:{},childNameComponent:b.a.createElement("div",null),arrowStyle:{size:16,color:w.b.PRIMARY}};var I=L(A);t.a=I},"./src/lumin-components/NoteCommentBox/CommentContext.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),r=n.n(a).a.createContext();t.a=r},"./src/lumin-components/NoteLumin/Context.js":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),r=n.n(a).a.createContext();t.a=r},"./src/lumin-components/NoteLumin/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/regenerator/index.js"),r=n.n(a),o=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=n.n(s),c=n("./node_modules/react/index.js"),u=n.n(c),d=n("./node_modules/classnames/index.js"),m=n.n(d),p=n("./node_modules/prop-types/index.js"),f=n.n(p),h=n("./node_modules/react-redux/es/index.js"),v=n("./node_modules/@material-ui/core/esm/Button/Button.js"),g=n("./node_modules/@apollo/react-hoc/lib/react-hoc.esm.js"),b=n("./src/redux/store/index.js"),y=n("./src/lumin-components/NoteLumin/Context.js"),E=n("./src/lumin-components/NoteCommentBox/CommentContext.js"),O=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),C=n.n(O),T=n("./node_modules/react-i18next/dist/es/useTranslation.js"),P=n("./node_modules/autolinker/dist/es2015/index.js"),S=n("./node_modules/dayjs/dayjs.min.js"),j=n.n(S),R=n("./node_modules/dayjs/plugin/calendar.js"),_=n.n(R),N=n("./src/constants/lumin-common.js"),x=n("./node_modules/lodash/debounce.js"),w=n.n(x),k=n("./src/redux/selectors/index.js"),D=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),L=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),A=n("./src/lumin-components/MaterialPopper/index.js"),I=n("./src/lumin-components/MaterialAvatar/index.js"),M=n("./node_modules/@material-ui/core/esm/TextareaAutosize/TextareaAutosize.js"),B={value:f.a.string,placeholder:f.a.string,onChange:f.a.func.isRequired,onBlur:f.a.func,onFocus:f.a.func,onKeyDown:f.a.func,className:f.a.string,id:f.a.string},F=u.a.forwardRef((function(e,t){var n=e.value,a=void 0===n?"":n,r=e.onChange,o=e.onBlur,i=void 0===o?function(){}:o,s=e.onFocus,l=void 0===s?function(){}:s,d=e.onKeyDown,m=void 0===d?function(){}:d,p=e.placeholder,f=void 0===p?"":p,h=e.className,v=void 0===h?"":h,g=e.id,b=void 0===g?"":g,y=Object(c.useRef)(null);return u.a.createElement(M.a,{className:v,id:b,ref:function(e){y.current=e,t(e)},onBlur:i,onFocus:l,placeholder:f,onChange:r,onKeyDown:m,value:a})}));F.propTypes=B,F.defaultProps={value:"",placeholder:"",onBlur:function(){},onFocus:function(){},onKeyDown:function(){},className:"",id:""};var U=F;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q={value:f.a.string,placeholder:f.a.string,onChange:f.a.func.isRequired,onBlur:f.a.func,onFocus:f.a.func,onSubmit:f.a.func,onKeyDown:f.a.func},V=u.a.forwardRef((function(e,t){var n=z(z({},e),{},{ref:function(e){t(e)},onChange:function(t){e.onChange(t)},onKeyDown:function(t){e.onKeyDown(t),(t.metaKey||t.ctrlKey)&&13===t.which&&e.onSubmit(t)}});return u.a.createElement(U,n)}));V.propTypes=q,V.defaultProps={value:"",placeholder:"",onBlur:function(){},onFocus:function(){},onSubmit:function(){},onKeyDown:function(){}};var K=V,G=n("./src/lumin-components/CircularLoading/index.js"),W=n("./node_modules/@material-ui/core/esm/Grid/Grid.js"),Y=n("./src/utils/index.js"),X=n("./src/services/graphServices/documentGraphServices.js"),J=n("./src/screens/Viewer/Context.js");Q.propTypes={className:f.a.string,currentUser:f.a.object,inputRef:f.a.object,onBlur:f.a.func,onChange:f.a.func,onFocus:f.a.func,onSubmit:f.a.func,placeholder:f.a.string,value:f.a.string,showAvatar:f.a.bool},Q.defaultProps={className:"",currentUser:{},inputRef:{},onBlur:function(){},onChange:function(){},onFocus:function(){},onSubmit:function(){},placeholder:"",value:"",showAvatar:!0};function Q(e){var t=e.className,n=e.placeholder,a=e.value,o=e.onFocus,s=e.onBlur,d=e.onChange,p=e.onSubmit,f=e.inputRef,h=e.currentUser,v=e.showAvatar,g=Object(c.useState)(!1),b=l()(g,2),y=b[0],E=b[1],O=Object(c.useRef)(),C=Object(c.useState)(!1),T=l()(C,2),P=T[0],S=T[1],j=Object(c.useState)(a||""),R=l()(j,2),_=R[0],N=R[1],x=Object(c.useState)(),k=l()(x,2),M=k[0],B=k[1],F=Object(c.useState)([]),U=l()(F,2),H=U[0],z=U[1],q=Object(c.useState)(0),V=l()(q,2),Q=V[0],Z=V[1],$=Object(c.useState)(0),ee=l()($,2),te=ee[0],ne=ee[1],ae=Object(c.useContext)(J.a).currentDocument,re=Boolean(null===h||void 0===h?void 0:h._id),oe=Object(c.useCallback)(w()(function(){var e=i()(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!re||!ae.documentReference||P){e.next=11;break}return S(!0),e.prev=2,e.next=5,X.a.getMentionList({documentId:ae._id,searchKey:t});case 5:n=e.sent,z(n);case 7:return e.prev=7,S(!1),E(!0),e.finish(7);case 11:case"end":return e.stop()}}),e,null,[[2,,7,11]])})));return function(t){return e.apply(this,arguments)}}(),500),[]);Object(c.useEffect)((function(){var e=ie(_,Q);"@"===e.charAt(0)?(oe(e.slice(1)),ne(Q-e.length)):E(!1)}),[_]),Object(c.useEffect)((function(){a?N(a):(Z(0),ne(0),N(""))}),[a]),Object(c.useEffect)((function(){function e(){E(!1)}var t=document.getElementById("DocumentContainer");return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}),[]);var ie=function(e,t){var n=e.substring(0,t).split(/\s+/);return n[n.length-1]};var se=Object(c.useCallback)((function(){y||s()}),[]);return u.a.createElement("div",{className:"NoteInput__container"},v&&u.a.createElement(I.a,{size:28,src:h?Y.d.getAvatar(h.avatarRemoteId):""},h?Y.d.getTextAvatar(h.name):""),u.a.createElement("div",{className:"NoteInput",ref:function(e){return B(e)}},u.a.createElement(K,{className:"NoteInput__input",ref:function(e){f.current=e},onKeyDown:function(e){8===e.which&&e.stopPropagation(),32===e.which&&E(!1),(e.metaKey||e.shiftKey)&&50===e.which&&h&&(0!==_.length&&(" "!==_.charAt(Q)&&""!==_.charAt(Q)||" "!==_.charAt(Q-1)&&" "!==_.charAt(Q-2)&&"\n"!==_.charAt(Q-1)&&"\n"!==_.charAt(Q-2))||ne(Q)),y&&(38===e.keyCode&&Q>-1&&(f.current.blur(),O.current.focus()),40===e.keyCode&&Q<H.length-1&&(f.current.blur(),O.current.focus()))},value:_,onChange:function(e){e.preventDefault(),Z(e.target.selectionStart),function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=e.split(""),a=t.split(""),r=0;r<e.length;r++)if(n[r]!==a[r]&&"@"===n[r])return!0;return!1}(_,e.target.value)&&E(!1),N(e.target.value),d&&d(e.target.value)},onBlur:se,onSubmit:p,placeholder:n,onFocus:o})),y&&Boolean(H.length)&&u.a.createElement(A.a,{open:!0,disablePortal:!0,parentOverflow:"scrollParent",anchorEl:M,placement:"bottom",handleClose:function(){return E(!y)},classes:"NoteInput__popper ".concat(t||"")},u.a.createElement("div",{className:"NoteInput__popper-container"},u.a.createElement(D.a,{className:m()("NoteInput__user-list",{"NoteInput__user-list--disabled":P}),ref:O},H.map((function(e){return u.a.createElement(L.a,{onClick:function(){return function(e){var t="".concat(_.slice(0,te),"@").concat(e.email).concat(_.slice(Q));Z(0),N(t),E(!1),f.current.focus(),d(t)}(e)},className:"NoteInput__user-item",key:e._id},u.a.createElement(W.a,{container:!0,alignItems:"center"},u.a.createElement(W.a,{item:!0,xs:2},u.a.createElement(I.a,{size:28,src:Y.d.getAvatar(e.avatarRemoteId),containerClasses:"comment-avatar"},Y.d.getTextAvatar(e.name))),u.a.createElement(W.a,{item:!0,xs:10,className:"NoteInput__user-item __info"},u.a.createElement("p",null,Y.H.getShortStringWithLimit(e.name,30)," ",h&&e.id===h._id?"(You)":""),u.a.createElement("span",null,e.email))))}))),P&&u.a.createElement(G.a,{className:"NoteInput__loading",size:24}))))}var Z=Object(h.c)((function(e){return{currentUser:k.a.getCurrentUser(e),currentTeam:k.a.getCurrentTeam(e),currentFolderType:k.a.getCurrentFolderType(e),currentDocument:k.a.getCurrentDocument(e)}}))(Object(g.a)(Q)),$=n("./src/lumin-components/Icomoon/index.js"),ee=n("./src/lumin-components/AnnotationStylePopup/index.js"),te=n("./src/constants/documentConstants.js"),ne=n("./src/constants/customDataConstant.js"),ae=n("./src/constants/dataElement.js"),re=n("./src/constants/commentState.js"),oe=n("./src/helpers/getAnnotationStyles.js"),ie=n("./src/core/index.js"),se=n("./src/redux/actions/index.js"),le={annotation:f.a.object.isRequired,setIsEditing:f.a.func.isRequired,handleReopen:f.a.func,setIsShowDeleteOverlay:f.a.func,isResolved:f.a.bool,setIsNotOwnerComment:f.a.func,isCommentPanel:f.a.bool.isRequired},ce=function(e){var t=e.annotation,n=e.setIsEditing,a=e.handleReopen,r=e.setIsShowDeleteOverlay,o=e.isResolved,i=e.setIsNotOwnerComment,s=e.isCommentPanel,d=Object(h.f)((function(e){return[k.a.isElementDisabled(e,"notePopup"),k.a.isElementDisabled(e,"notePopupEdit"),k.a.isElementDisabled(e,"notePopupDelete")]}),h.d),m=l()(d,3),p=m[0],f=m[1],g=m[2],b=Object(c.useState)(ie.default.canModify(t)),O=l()(b,2),C=O[0],P=O[1],S=Object(c.useState)(ie.default.canModifyContents(t)),j=l()(S,2),R=j[0],_=j[1],N=Object(c.useState)(!1),x=l()(N,2),w=x[0],I=x[1],M=Object(c.useState)(!1),B=l()(M,2),F=B[0],U=B[1],H=Object(h.e)(),z=Object(T.a)(),q=l()(z,1)[0],V=Object(c.useRef)(),K=Object(c.useContext)(s?E.a:y.a),G=K.isInsideComment,W=void 0!==G&&G,Y=K.openCommentPanel,X=void 0===Y?function(){}:Y,J=K.disabledElements,Q=void 0===J?{}:J,Z=K.setIsFocusInput,le=t instanceof window.Annotations.FreeTextAnnotation,ce=t.isReply(),ue=t.getContents(),de=t.Subject===te.g.COMMENT;Object(c.useEffect)((function(){var e=function(){P(ie.default.canModify(t)),_(ie.default.canModifyContents(t))},n=!f&&ie.default.canModify(t),a=!g&&ie.default.canModifyContents(t);return i(!(n||a)||p),ie.default.addEventListener("updateAnnotationPermission",e),function(){return ie.default.removeEventListener("updateAnnotationPermission",e)}}),[t]),Object(c.useEffect)((function(){function e(){I(!1)}var t=document.getElementById("DocumentContainer");return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}),[]);return!(!f&&R)&&!(!g&&C)||p?null:u.a.createElement("div",{className:"NotePopup",onClick:function(e){return e.stopPropagation()}},u.a.createElement(v.a,{className:"square overflow  ".concat((w||F)&&"open"),"aria-label":"note",ref:function(e){return V.current=e},onMouseDown:function(){F&&(H(se.a.enableElement(ae.a.OPACITY_SLIDER)),U(!1)),I(!w)}},u.a.createElement($.a,{className:"more-v icon__16"})),u.a.createElement(A.a,{open:w,disablePortal:!0,parentOverflow:"window",anchorEl:V.current,handleClose:function(e){V.current.contains(e.target)||I(!1)},placement:"bottom-end",classes:"NotePopup__popper-comment"},u.a.createElement(D.a,null,!ce&&ie.default.getCurrentUser()===t.Author&&!(null!==Q&&void 0!==Q&&Q.annotationStyleEditButton)&&ue&&!o&&!t.getCustomData(ne.b.HIGHLIGHT_TEXT.key)&&de&&u.a.createElement(L.a,{onClick:function(){H(se.a.disableElement(ae.a.OPACITY_SLIDER)),I(!1),U(!0)}},u.a.createElement("span",{className:"icon-color"}),"Change color"),o&&!ce&&u.a.createElement(L.a,{onClick:function(){a(),I(!w)}},u.a.createElement($.a,{className:"reopen icon__16"}),"Reopen"),ie.default.getCurrentUser()===t.Author&&!o&&u.a.createElement(L.a,{onClick:function(){le?ie.default.getAnnotationManager().trigger("annotationDoubleClicked",t):setTimeout((function(){n(!0),Z(!0)}),0),I(!w)}},u.a.createElement($.a,{className:"edit icon__16"}),q("action.edit")),u.a.createElement(L.a,{onClick:function(){if(ce){if(ie.default.deleteAnnotations([t],{}),t.getState()===re.a.Cancelled.state){var e=new window.Annotations.StickyAnnotation;e.InReplyTo=t.InReplyTo,e.X=t.X,e.Y=t.Y,e.PageNumber=t.PageNumber,e.Author=t.Author,e.setContents(""),e.setStateModel("Marked"),e.setState(re.a.Rejected.state),e.DateCreated=t.DateCreated,t.addReply(e),ie.default.addAnnotations([e],{})}}else document.querySelector(".reply-container .NoteInput__container textarea").blur(),I(!1),r(!0)}},u.a.createElement($.a,{className:"trash icon__16"}),q("action.delete")),W&&u.a.createElement(L.a,{onClick:function(){I(!1),X()}},u.a.createElement($.a,{className:"outlines icon__16"}),"Open Annotation"))),u.a.createElement(A.a,{open:F,disablePortal:!0,parentOverflow:"window",anchorEl:V.current,handleClose:function(e){V.current.contains(e.target)||(H(se.a.enableElement(ae.a.OPACITY_SLIDER)),U(!1))},placement:"bottom-end",classes:"NotePopup__popper-comment"},F?u.a.createElement("div",{className:"commentColorPalette"},u.a.createElement(ee.a,{placement:"bottom-end",annotation:t,style:Object(oe.a)(t),isOpen:F})):u.a.createElement("div",null)))};ce.propTypes=le,ce.defaultProps={isResolved:!1,handleReopen:function(){},setIsShowDeleteOverlay:function(){},setIsNotOwnerComment:function(){}};var ue=ce,de=n("./src/lumin-components/ButtonMaterial/index.js"),me=n("./src/lumin-components/Tooltip/index.js"),pe=n("./src/helpers/MentionsManager.js"),fe=n("./src/constants/map.js"),he=n("./src/constants/plan.js"),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1?arguments[1]:void 0,n=Object(c.useRef)(!1);Object(c.useEffect)((function(){if(n.current)return e();n.current=!0}),t)};function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}j.a.extend(_.a);var ye={sameDay:"[Today]",lastDay:"[Yesterday]",lastWeek:"[Last] dddd"},Ee={annotation:f.a.object.isRequired,isRightPanel:f.a.bool.isRequired,handleReopen:f.a.func,setIsShowDeleteOverlay:f.a.func,isResolved:f.a.bool,setCommentResolve:f.a.func,openSignInModal:f.a.func,userPlan:f.a.string},Oe=function(e){var t,n=e.annotation,a=e.isRightPanel,o=e.handleReopen,s=e.setIsShowDeleteOverlay,d=e.isResolved,p=e.isCommentPanel,f=e.setCommentResolve,g=e.openSignInModal,b=e.userPlan,O=Object(h.f)((function(e){return[k.a.getCurrentUser(e),k.a.getCurrentDocument(e),k.a.getSortStrategy(e),k.a.getNoteDateFormat(e),k.a.getIconColor(e,Object(fe.c)(n)),k.a.getIsNoteEditing(e)]}),h.d),C=l()(O,6),T=C[0],S=C[1],R=C[2],_=C[3],x=C[4],w=C[5],D=Object(c.useContext)(p?E.a:y.a),L=D.isSelected,A=D.searchInput,M=D.resize,B=D.isContentEditable,F=D.isFocusInput,U=D.setIsFocusInput,H=Object(c.useState)(""),z=l()(H,2),q=z[0],V=z[1],K=Object(c.useState)(""),G=l()(K,2),W=G[0],X=G[1],J=Object(c.useState)(!1),Q=l()(J,2),Z=Q[0],ee=Q[1],ae=Object(c.useState)(!1),oe=l()(ae,2),le=oe[0],ce=oe[1],de=Object(c.useRef)(null),ge=Object(c.useRef)(null),Ee=Object(c.useState)(!0),Oe=l()(Ee,2),Ce=Oe[0],Pe=Oe[1],Se=Object(c.useState)(!1),je=l()(Se,2),Re=je[0],_e=je[1],Ne=n.getCustomData(ne.a.MENTION.key),xe=Object(c.useState)(Ne?null===(t=JSON.parse(Ne))||void 0===t?void 0:t.contents:n.getContents()),we=l()(xe,2),ke=we[0],De=we[1],Le=Object(h.e)(),Ae=n.isReply(),Ie=0===n.getReplies().length,Me=n.Subject===te.g.COMMENT,Be=n instanceof window.Annotations.StickyAnnotation&&"Marked"===n.getStateModel(),Fe=!!Me&&n.getState()===re.a.Cancelled.state,Ue=!!Me&&n.getState()===re.a.Rejected.state,He=n.getCustomData(ne.b.HIGHLIGHT_TEXT.key),ze=!0,qe=Object(c.useRef)();ve((function(){Z||Le(se.a.finishNoteEditing()),M()}),[Z]),Object(c.useEffect)((function(){function e(){return(e=i()(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(n);case 2:return t=e.sent,e.next=5,Ze();case 5:a=e.sent,V(t),X(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return qe.current=setTimeout((function(){de.current&&ge.current&&de.current.clientWidth+1<=ge.current.clientWidth&&Pe(!1)}),0),ze&&function(){e.apply(this,arguments)}(),ie.default.addEventListener("annotationChanged",Ke),ie.default.addEventListener("annotationSelected",Ge),function(){ze=!1,clearTimeout(qe.current),ie.default.removeEventListener("annotationChanged",Ke),ie.default.removeEventListener("annotationSelected",Ge)}}),[]),Object(c.useEffect)((function(){n instanceof window.Annotations.FreeTextAnnotation&&!W&&Ve(),w&&L&&B&&ee(!0)}),[B,w,L]),Object(c.useEffect)((function(){L||ce(!1)}),[L]),Object(c.useEffect)((function(){Ve()}),[n]);var Ve=function(){var e=i()(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze();case 2:t=e.sent,X(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=i()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==t&&void 0!==t&&t[0]&&n&&t[0].Id===n.Id&&Ve();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(e,t){"deselected"===t&&(ee(!1),U(!1),s(!1))},We=Object(c.useCallback)((function(e){L&&e.stopPropagation()}),[L]),Ye=function(){var e=i()(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","");case 2:if(n="string"===typeof t?t:t.Author,!Y.M.validateEmail(n)){e.next=9;break}if(!T||n!==T.email){e.next=6;break}return e.abrupt("return",T.name);case 6:if(!(a=pe.a.getUserData()).some((function(e){return e.email===n}))){e.next=9;break}return e.abrupt("return",a.find((function(e){return e.email===n})).name);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=Object(c.useCallback)((function(e){return A.trim()?e.replace(new RegExp("(".concat(A,")"),"gi"),'<span class="highlight">$1</span>'):e.includes("Anonymous")?e.split("-")[0]:e}),[A]),Je=Object(c.useCallback)(function(){var e=i()(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",u.a.createElement("span",{className:"author"},"no name"));case 5:return e.abrupt("return",u.a.createElement("span",{className:"author"},n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Xe]),Qe=function(){var e=i()(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(" "),e.next=3,Promise.all(n.map(function(){var e=i()(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\r|\n/),e.next=3,Promise.all(n.map(function(){var e=i()(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.startsWith("@")||!Y.M.validateEmail(t.slice(1))){e.next=9;break}return e.next=3,Ye(t.slice(1));case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",t);case 6:if(-1===n.search("@")){e.next=8;break}return e.abrupt("return",n);case 8:return e.abrupt("return",'<span class="mention">'.concat(n,"</span>"));case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return a=e.sent,e.abrupt("return",a.join("\n"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return a=e.sent,e.abrupt("return",a.join(" "));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=i()(r.a.mark((function e(){var t,a,o,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.getContents()){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Qe(t);case 5:return a=e.sent,-1!==P.a.link(a).indexOf("<a")?(o=P.a.link(a,{stripPrefix:!1}),a=o.replace(/>(.+)</i,(function(e,t){return">".concat(Xe(t),"<")}))):a=Xe(a),i=Y.h.commentParser(a),s=function(e){var t=e.target.href,n=new URL(t),a=n.hostname.replace("www.",""),r=n.hostname.split(".");"luminpdf.com"!==a&&"luminpdf.com"!=="".concat(r[1],".").concat(r[2])&&(e.preventDefault(),Le(se.a.openModal({type:N.A.WARNING,title:"You are leaving Lumin PDF",message:"Following this link opens a new browser tab and sends you to a website outside of Lumin PDF",cancelButtonTitle:"Cancel",confirmButtonTitle:"Proceed",onCancel:function(){return Le(se.a.closeModal())},onConfirm:function(){window.open(n.href,"_blank").focus()},isFullWidthButton:!0})))},e.abrupt("return",u.a.createElement("span",{className:"contents"},i.map((function(e,t){return e.startsWith("<a")?u.a.createElement("span",{key:"".concat(t,"-").concat(n.Id),className:"links",onClick:s,dangerouslySetInnerHTML:{__html:e}}):u.a.createElement("span",{key:"".concat(t,"-").concat(n.Id),dangerouslySetInnerHTML:{__html:e}})}))));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=Object(c.useCallback)((function(){var e,t={avatarRemoteId:"",name:""};if(!n)return t;if(e="string"===typeof n?n:n.Author,Y.M.validateEmail(e))if(T&&e===T.email)t.avatarRemoteId=T.avatarRemoteId,t.name=T.name;else{var a=pe.a.getUserData();if(a.some((function(t){return t.email===e}))){var r=a.find((function(t){return t.email===e}));t.avatarRemoteId=r.avatarRemoteId,t.name=r.name}}return t}),[]),et=Object(c.useCallback)((function(){var e=Object(fe.b)(Object(fe.c)(n)).icon,t="Signature"!==n.Subject?x&&n[x].toHexString():null;if(e){var a="annotation-redact"===e?"basic-redaction":e;return"comment"===a?u.a.createElement(I.a,{size:28,src:Y.d.getAvatar($e().avatarRemoteId)},Y.d.getTextAvatar($e().name)):u.a.createElement($.a,{className:a,color:t,size:22})}return n.Subject}),[]),tt=function(){L&&ce(!le)},nt=function(){b===he.c.NO_PLAN?g():f(!0)},at=Object(c.useMemo)((function(){var e;if(Ae)e=u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"type"},u.a.createElement(I.a,{size:28,src:Y.d.getAvatar($e().avatarRemoteId)},Y.d.getTextAvatar($e().name))),u.a.createElement("div",{className:"info-wrapper"},q,u.a.createElement("span",{className:"time"},"\n                ".concat(j()(n.DateCreated).calendar(null,be(be({},ye),{},{sameElse:_.split(",")[0]})),",\n                ").concat(j()(n.DateCreated).format(_.split(",")[1]),"\n              "))),L&&!d&&!Be&&!Ue&&u.a.createElement(ue,{isCommentPanel:p,annotation:n,setIsEditing:ee})));else{var t=n.getReplies().filter((function(e){return"Marked"!==e.getStateModel()&&e.getState()!==re.a.Rejected.state})).length;e=u.a.createElement("div",{className:m()("title",{comment_added:Me&&!W})},u.a.createElement("div",{className:"type"},et()),u.a.createElement("div",{className:"user-info"},q,u.a.createElement("div",{className:"time"},("time"!==R||L)&&j()(n.DateCreated||new Date).calendar(null,be(be({},ye),{},{sameElse:_.split(",")[0]})),","," ",j()(n.DateCreated).format(_.split(",")[1]),t>0&&u.a.createElement("span",{className:"reply-count"},u.a.createElement($.a,{className:"reply-count",size:16}),t))),Me&&W&&!d&&u.a.createElement("div",{className:"check-resolved"},u.a.createElement(me.a,{content:"Mark as resolved",additionalClass:"note_tooltip_edit ".concat(Re?"note_tooltip_edit-left":"")},u.a.createElement(v.a,{className:"Resolved__btn",onClick:nt},u.a.createElement($.a,{className:"check icon__16 icon"})))),u.a.createElement(ue,{isResolved:d,isCommentPanel:p,handleReopen:o,setIsShowDeleteOverlay:s,annotation:n,setIsEditing:ee,setIsNotOwnerComment:_e}))}return e}),[L,q,W]);return Object(c.useMemo)((function(){return u.a.createElement("div",{className:m()("NoteContent",{"no-content":!W&&!Ue,"no-reply":Ie&&!Ae,"is-status":Be}),onMouseDown:function(e){return e.preventDefault()}},u.a.createElement("div",{className:"NoteContent__right"},at,He&&a&&u.a.createElement("div",{className:"highlight ".concat(!Me||W||Ue?"":"comment_added"),onMouseDown:tt},u.a.createElement("div",{className:"highlight__mark_left"},u.a.createElement("div",null)),u.a.createElement("div",{ref:ge,className:"highlight__text ".concat(le?"opened":"closed")},u.a.createElement("span",{ref:de},He),Ce&&u.a.createElement("div",{className:"icon"},u.a.createElement($.a,{className:le?"light-arrow-up":"light-arrow-down",size:16})))),u.a.createElement("div",{className:"content-container ".concat(!Me||W||Ue?"":"comment_added"),onMouseDown:We},Z&&F?u.a.createElement(Te,{textAreaValue:ke,onTextAreaValueChange:De,annotation:n,setIsEditing:ee,currentUser:T,currentDocument:S,setContent:X,setIsFocusInput:U}):u.a.createElement("div",{className:"content-container"},Fe&&u.a.createElement("p",{className:"reopened"},re.a.Cancelled.message),Ue&&u.a.createElement("p",{className:"reopened"},re.a.Rejected.message),u.a.createElement("p",{className:"container"},W)))),u.a.createElement("hr",null))}),[We,Z,Ze])};Oe.propTypes=Ee,Oe.defaultProps={setIsShowDeleteOverlay:function(){},isResolved:!1,isCommentPanel:!1,setCommentResolve:function(){},openSignInModal:function(){},userPlan:"",isRightPanel:!1};var Ce=Object(g.a)(Oe),Te=function(e){var t,n=e.annotation,a=e.setIsEditing,o=e.currentUser,s=e.currentDocument,d=e.setContent,p=e.setIsFocusInput,f=n.getCustomData(ne.a.MENTION.key),h=f?null===(t=JSON.parse(f))||void 0===t?void 0:t.contents:n.getContents(),v=Object(c.useState)(h),g=l()(v,2),b=g[0],y=g[1],E=Object(c.useState)([]),O=l()(E,2),C=O[0],P=O[1],S=Object(T.a)(),j=l()(S,1)[0],R=Object(c.useRef)(),_=n.getCustomData(ne.b.HIGHLIGHT_TEXT.key),N=Object(c.useRef)(!1);Object(c.useEffect)((function(){return setTimeout((function(){if(R.current){R.current.focus();var e=R.current.value.length;R.current.setSelectionRange(e,e)}}),300),function(){clearTimeout(R.current)}}),[]),Object(c.useEffect)((function(){if(b){var e=b.trim(),t=Y.h.getEmailsFromContent(o,e);P(t)}}),[]),Object(c.useEffect)((function(){return ie.default.addEventListener("annotationSelected",x),function(){ie.default.removeEventListener("annotationSelected",x)}}),[b]);var x=function(e,t){"deselected"!==t||N.current||n.Subject===te.g.COMMENT&&(n.getContents()||(b?L(window.event,!1):w()))},w=function(){var e=ie.default.getAnnotationsList().filter((function(e){return e.Subject===te.g.HIGHLIGHT&&e.getCustomData(ne.b.IS_HIGHLIGHT_COMMENT.key)})).find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===n.Id}));e&&ie.default.deleteAnnotations([e]),ie.default.deleteAnnotations([n])},k=function(e){return{ownerEmail:e.Author,ownerComment:e.getContents(),comments:e.getReplies().map((function(e){return{email:e.Author,content:e.getContents()}}))}},D=function(){var e=i()(r.a.mark((function e(t){var i,l,c,u,m,f,v,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),b!==h&&b.trim()&&(a(!1),p(!1),i=b.trim(),l=Y.h.getEmailsFromContent(o,i),c=Y.h.getNewTagUsers(C,l),i&&(u=s._id,m=s.ownerId,o?(f=o.name,v={name:f,id:o._id},(0===c.length||c.every((function(e){return e!==n.Author})))&&o._id!==m&&Y.G.socketEmitSendEmailComment(v,u,new Date,i),0!==c.length&&(g=k(n),Y.G.socketEmitSendEmailMention(v,u,i,g,c))):Y.G.socketEmitSendEmailComment({name:"Anonymous"},u,new Date,i),d(Y.h.clearAllMarkupSymbol(i)),ie.default.setNoteContents(n,Y.h.clearAllMarkupSymbol(i)),n instanceof window.Annotations.FreeTextAnnotation&&ie.default.drawAnnotationsFromList([n])));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.preventDefault(),e.stopPropagation(),N.current=!0,_){var r=ie.default.getAnnotationsList().find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===n.Id}));h?r.DateModified=n.DateModified:r.setCustomData(ne.b.HIGHLIGHT_HAS_CONTENT.key,ne.b.HIGHLIGHT_HAS_CONTENT.hasValue)}b&&b.trim()&&(D(e),a(!1),p(!1)),t&&!h&&ie.default.deselectAnnotation(n)};return u.a.createElement("div",{className:"edit-content"},u.a.createElement(Z,{inputRef:R,value:Y.h.redoMarkupSymbol(b),onChange:y,closeEditing:function(){a(!1),p(!1)},placeholder:"".concat(j("action.comment"),"..."),onSubmit:D,showAvatar:!h}),u.a.createElement("span",{className:"buttons"},u.a.createElement(de.a,{className:"secondary",onMouseDown:function(){a(!1),p(!1),h||"Comment"!==n.Subject||ie.default.deleteAnnotations([n],{})}},j("action.cancel")),u.a.createElement(de.a,{className:m()("primary",{disabled:!(b&&b.trim())}),disabled:!(b&&b.trim()),onMouseDown:L},h?"Save":"Comment")))};Te.propTypes={annotation:f.a.object.isRequired,setIsEditing:f.a.func.isRequired,currentUser:f.a.object,currentDocument:f.a.object,setContent:f.a.func,setIsFocusInput:f.a.func},Te.defaultProps={currentUser:{},currentDocument:{},setContent:function(){},setIsFocusInput:function(){}};var Pe=Ce;function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){var t=e.annotation,n=e.handleReplyReopen,a=e.replyTextareaRef,r=e.isResolved,o=e.changeIsReOpenByReply,i=e.isCommentPanel,s=Object(h.f)((function(e){var n;return[k.a.getCurrentUser(e),k.a.getCurrentDocument(e),k.a.isDocumentReadOnly(e),k.a.isElementDisabled(e,"noteReply"),null===(n=k.a.getIsReplyDisabled(e))||void 0===n?void 0:n(t),k.a.getIsNoteEditing(e)]}),h.d),d=l()(s,6),p=d[0],f=d[1],v=d[2],g=d[3],b=d[4],O=d[5],C=Object(c.useContext)(i?E.a:y.a),P=C.resize,S=C.isContentEditable,j=C.isSelected,R=Object(c.useState)(!1),_=l()(R,2),N=_[0],x=_[1],w=Object(c.useState)(""),D=l()(w,2),L=D[0],A=D[1],I=Object(T.a)(),M=l()(I,1)[0],B=Object(h.e)(),F={email:t.Author,content:t.getContents()},U=t.getReplies().map((function(e){return{email:e.Author,content:e.getContents()}})).concat([F]);ve((function(){N||B(se.a.finishNoteEditing()),P()}),[N]),Object(c.useEffect)((function(){O&&j&&!S&&a&&a.current.focus()}),[S,O,j]);var H=function(e){e.preventDefault();var a=je(je({},F),{},{comments:U}),s=L&&L.trim();if(s){r&&o(!0),ie.default.createAnnotationReply(t,Y.h.clearAllMarkupSymbol(L.trim()));var l=f._id,c=t.Author,u=Y.h.getEmailsFromContent(p,L.trim()),d=Array.from(new Set(U.filter((function(e){return(null===p||void 0===p?void 0:p.email)!==e.email})).map((function(e){return e.email}))));if(p){var m={name:p.name,id:p._id};if(u.length>0&&Y.G.socketEmitSendEmailMention(m,l,L.trim(),a,u),u.every((function(e){return e!==c}))&&U.length>0){var h=d.filter((function(e){return!u.find((function(t){return t===e}))}));Y.G.socketEmitSendEmailReply(m,l,c,h,a,s)}}else Y.G.socketEmitSendEmailReply({name:"Anonymous"},l,c,d,a,s)}A(""),n(),i&&ie.default.deselectAnnotation(t)},z=m()({disabled:!L||!L.trim()});return v||g||b||O&&S?null:u.a.createElement("div",{className:"reply-container",onMouseDown:function(e){return e.stopPropagation()}},u.a.createElement("hr",null),u.a.createElement(Z,{inputRef:a,value:L,onChange:function(e){return A(e)},onFocus:function(){return x(!0)},placeholder:r?"Adding a comment will reopen this discussion":M("action.reply"),onBlur:function(){return x(!1)},onSubmit:H}),N&&u.a.createElement("div",{className:"buttons btn_mg-0"},u.a.createElement(de.a,{className:"secondary",onMouseDown:function(){A(""),a.current.blur()}},M("action.cancel")),u.a.createElement(de.a,{className:"primary ".concat(z),onMouseDown:H,disabled:!L||!L.trim()},"Reply")))};Re.propTypes={annotation:f.a.object.isRequired,handleReplyReopen:f.a.func,replyTextareaRef:f.a.object,isResolved:f.a.bool.isRequired,changeIsReOpenByReply:f.a.func,isCommentPanel:f.a.bool},Re.defaultProps={handleReplyReopen:function(){},replyTextareaRef:{},changeIsReOpenByReply:function(){},isCommentPanel:!1};var _e=Re,Ne=(n("./src/lumin-components/CustomCheckbox/index.js"),n("./src/constants/socketConstant.js")),xe=n("./src/helpers/setToolModeAndGroup.js"),we=n("./src/helpers/scrollToAnnotation.js"),ke=n("./src/socket/index.js"),De={annotation:f.a.object.isRequired,isCommentPanel:f.a.bool.isRequired,isRightPanel:f.a.bool.isRequired},Le=0,Ae=function(e){var t=e.annotation,n=e.isCommentPanel,a=e.isRightPanel,o=Object(c.useContext)(n?E.a:y.a),s=o.isSelected,d=o.resize,p=Object(c.useRef)(),f=Object(c.useRef)(),v=Object(c.useRef)(null),g=t instanceof window.Annotations.StickyAnnotation,O=Object(c.useRef)([]),C=Object(c.useState)(!1),T=l()(C,2),P=T[0],S=T[1],j=ie.default.getAnnotationManager(),R=Object(h.f)((function(e){return[k.a.getNoteTransformFunction(e),k.a.getCurrentDocument(e),k.a.getCurrentUser(e)]}),h.d),_=l()(R,3),N=_[0],x=_[1],w=_[2],D=Object(h.e)(),L=t.getContents(),A=w?"":he.c.NO_PLAN,I=g&&t.getState()===re.a.Resolved.state,M=Object(c.useRef)(!1),B=ie.default.getAnnotationsList().find((function(e){return e.getCustomData(ne.b.STICKY_ID.key)===t.Id}));Object(c.useEffect)((function(){return ie.default.addEventListener("addReply",F),function(){return ie.default.removeEventListener("addReply",F)}}),[]),Object(c.useEffect)((function(){var e=f.current,t=p.current.getBoundingClientRect().height;f.current=t,e&&Math.round(e)!==Math.round(t)&&d()}),[s,d]),Object(c.useEffect)((function(){if(N){O.current.forEach((function(e){var t=document.querySelector("[data-webviewer-custom-element='".concat(e,"']"));t&&t.parentNode.removeChild(t)})),O.current=[];var e={annotation:t,isSelected:s};N(p.current,e,(function(){var e,t=(e=document).createElement.apply(e,arguments),n="custom-element-".concat(Le);return Le++,O.current.push(n),t.setAttribute("data-webviewer-custom-element",n),t.addEventListener("mousedown",(function(e){e.stopPropagation()})),t}))}})),Object(c.useEffect)((function(){B&&Be(I,B)}),[I]);var F=function(e,t,n){M.current&&"Marked"!==e.getStateModel()&&"Comment"===n.Subject&&(e.setState(re.a.Cancelled.state),M.current=!1)},U=function(){var e=i()(r.a.mark((function e(n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.stopPropagation(),(null===(a=ie.default.getToolMode())||void 0===a?void 0:a.name)!==window.Tools.ToolNames.FREEHAND){e.next=4;break}return e.next=4,Object(xe.a)(b.a,"AnnotationEdit");case 4:s||(ie.default.deselectAllAnnotations(),ie.default.selectAnnotation(t),t.isVisible()&&Object(we.a)(ie.default.getScrollViewElement(),t),B&&(ie.default.selectAnnotation(B),B.isVisible()&&Object(we.a)(ie.default.getScrollViewElement(),B)));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=i()(r.a.mark((function e(n){var a,o=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.length>1&&void 0!==o[1]?o[1]:"button",n===I){e.next=4;break}return e.next=4,Ue(n,t,B,x,w);case 4:n?j.updateAnnotationState(t,re.a.Resolved.state,"Marked",re.a.Resolved.message):I&&"button"===a&&j.updateAnnotationState(t,re.a.Open.state,"Marked",re.a.Open.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=m()({NoteLumin:!0,expanded:s,resolved:I}),q=m()({replies:!0,hidden:!s}),V=t.getReplies().sort((function(e,t){return e.DateCreated-t.DateCreated})),K=function(){D(se.a.openElement("signInUseCommentModal"))};return u.a.createElement("div",{className:z,ref:p,onMouseDown:U},g&&L&&I&&u.a.createElement("div",{className:"NoteLumin_header"},u.a.createElement(Me,{setCommentResolve:H,userPlan:A,openSignInModal:K})),u.a.createElement("div",{className:"NoteLumin__wrapper-note-content",role:"button",tabIndex:0},u.a.createElement(Pe,{handleReopen:function(){return H(!1)},setIsShowDeleteOverlay:function(e){v.current&&v.current.blur(),S(e)},annotation:t,isResolved:I,isRightPanel:a,isCommentPanel:n,setCommentResolve:H,openSignInModal:K,userPlan:A}),u.a.createElement("div",{className:q},V.map((function(e){return u.a.createElement(Pe,{key:e.Id,isResolved:I,annotation:e,isCommentPanel:n,isRightPanel:a})})),A!==he.c.NO_PLAN?u.a.createElement(_e,{replyTextareaRef:v,annotation:t,handleReplyReopen:function(){return H(!1,"reply")},isResolved:I,changeIsReOpenByReply:function(e){return M.current=e},isCommentPanel:n,isRightPanel:a}):u.a.createElement("div",null)),P&&u.a.createElement(Ie,{setIsShowDeleteOverlay:S,handleDelete:function(){ie.default.deleteAnnotations([t],{}),B&&ie.default.deleteAnnotations([B],{})}})))},Ie=function(e){var t=e.setIsShowDeleteOverlay,n=e.handleDelete;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"note_delete_mask"}),u.a.createElement("div",{className:"note_delete_content"},u.a.createElement("div",{className:"note_delete_content_title"},"Delete this comment thread?"),u.a.createElement("div",{className:"note_delete_content_button_group"},u.a.createElement(de.a,{className:"secondary",onClick:function(){return t(!1)}},"Cancel"),u.a.createElement(de.a,{className:"primary",onClick:n},"Delete"))))};Ie.propTypes={setIsShowDeleteOverlay:f.a.func.isRequired,handleDelete:f.a.func.isRequired};f.a.string.isRequired,f.a.func.isRequired,f.a.bool.isRequired,f.a.string.isRequired,f.a.func.isRequired,f.a.object.isRequired;var Me=function(e){var t=e.setCommentResolve,n=e.userPlan,a=e.openSignInModal;return u.a.createElement("div",{className:"note-resolved-wrapper"},u.a.createElement("div",{className:"label"},u.a.createElement($.a,{className:"check",size:14}),u.a.createElement("span",null,"Resolved")),u.a.createElement(v.a,{className:m()({action:!0,disabled:n===he.c.NO_PLAN}),onClick:function(){n!==he.c.NO_PLAN?t(!1):a()}},"Reopen"))};Me.propTypes={setCommentResolve:f.a.func.isRequired,userPlan:f.a.string.isRequired,openSignInModal:f.a.func.isRequired};var Be=function(e,t){var n=ie.default.getAnnotationManager();e?n.hideAnnotation(t):n.showAnnotation(t)},Fe=function(e,t,n,a){ke.a.emit(Ne.a.ANNOTATION_CHANGE,{roomId:n._id,xfdf:t,annotationId:e,userId:a._id,email:a.email})},Ue=function(){var e=i()(r.a.mark((function e(t,n,a,o,s){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i()(r.a.mark((function e(i){var c,u,d,m,p,f,h,v,g,b,y;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ie.default.getAnnotationManager(),e.next=3,ze(a?[n,a]:[n]);case 3:u=e.sent,d=l()(u,2),m=d[0],p=d[1],f=new XMLSerializer,h="",m.setAttribute("state",t?re.a.Resolved.state:re.a.Open.state),a?(g=p.getAttribute("flags").split(","),t?g.push("hidden"):g.indexOf("hidden")>-1&&g.splice(g.indexOf("hidden"),1),p.setAttribute("flags",g.join(",")),h=f.serializeToString(p)):(v=m.getAttribute("flags").split(","),t?v.push("noview"):v.indexOf("noview")>-1&&v.splice(v.indexOf("noview"),1),m.setAttribute("flags",v.join(","))),b=f.serializeToString(m),y=He(b+h),Fe(n.Id,y,o,s),c.importAnnotCommand(y),t&&ie.default.deselectAnnotation(n),t||(Object(we.a)(ie.default.getScrollViewElement(),n,"instant"),ie.default.selectAnnotation(n)),i();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),He=function(e){return'<?xml version="1.0" encoding="UTF-8" ?>\n<xfdf xmlns="http://www.w3.org/1999/xhtml" xml:space="preserve"><fields /><add /><modify>'.concat(e,"</modify><delete /></xfdf>")},ze=function(){var e=i()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i()(r.a.mark((function e(n){var a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new DOMParser,e.next=3,ie.default.getAnnotationManager().exportAnnotations({annotList:t,widgets:!1,links:!1,fields:!1});case 3:o=e.sent,n(a.parseFromString(o,"text/xml").querySelector("annots").children);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Ae.propTypes=De,Ae.defaultProps={};var qe=Object(g.a)(Ae);t.a=qe},"./src/lumin-components/NotesPanel/index.js":function(e,t,n){"use strict";var a=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),r=n.n(a),o=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=n.n(s),c=n("./node_modules/react/index.js"),u=n.n(c),d=n("./node_modules/prop-types/index.js"),m=n.n(d),p=n("./node_modules/react-redux/es/index.js"),f=n("./node_modules/react-measure/dist/index.esm.js"),h=n("./node_modules/react-virtualized/dist/es/index.js"),v=n("./node_modules/react-i18next/dist/es/useTranslation.js"),g=n("./node_modules/@apollo/react-hoc/lib/react-hoc.esm.js"),b=n("./src/lumin-components/ListSeparator/index.js"),y=n("./src/lumin-components/Icomoon/index.js"),E=n("./src/lumin-components/SvgElement/index.js"),O=n("./src/lumin-components/NoteLumin/index.js"),C=n("./src/lumin-components/NoteLumin/Context.js"),T=n("./src/lumin-components/NoteCommentBox/CommentContext.js"),P=n("./src/core/index.js"),S=n("./src/redux/selectors/index.js"),j=n("./src/constants/sortStrategies.js"),R=n("./src/constants/documentConstants.js"),_=n("./src/constants/customDataConstant.js");function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={display:m.a.string.isRequired,isRightPanel:m.a.bool},k=function(e){var t=e.display,n=e.isRightPanel,a=Object(p.f)((function(e){return[S.a.getSortStrategy(e),S.a.isElementDisabled(e,"notesPanel"),S.a.getPageLabels(e),S.a.getCustomNoteFilter(e)]}),p.d),r=l()(a,4),o=r[0],s=r[1],d=r[2],m=r[3],f=Object(c.useState)([]),h=l()(f,2),g=h[0],N=h[1],x=Object(c.useState)({}),w=l()(x,2),k=w[0],D=w[1],L=Object(c.useState)(""),A=l()(L,2),B=A[0],F=A[1],U=Object(c.useState)(!1),H=l()(U,2),z=H[0],q=H[1],V=Object(v.a)(),K=l()(V,1)[0],G=Object(c.useRef)(),W=Object(c.useRef)(),Y=Object(c.useRef)(0);Object(c.useEffect)((function(){var e=function(){N([]),D({}),F("")};return P.default.addEventListener("documentUnloaded",e),P.default.getTool("AnnotationCreateSticky").addEventListener("annotationCreated",J),function(){P.default.removeEventListener("documentUnloaded",e),P.default.getTool("AnnotationCreateSticky").removeEventListener("annotationCreated",J)}}),[]),Object(c.useEffect)((function(){var e=function(){N(P.default.getAnnotationsList().filter((function(e){return n?e.Subject===R.g.COMMENT&&!e.isReply()&&e.getContents():e.Subject&&e.Subject!==R.g.NO_NAME&&e.Subject!==R.g.WIDGET&&!e.isReply()&&!e.Hidden&&!e.isGrouped()&&!e.getCustomData(_.b.IS_HIGHLIGHT_COMMENT.key)&&e.Subject!==R.g.COMMENT})))};return e(),P.default.addEventListener("annotationChanged",e),P.default.addEventListener("annotationHidden",e),function(){P.default.removeEventListener("annotationChanged",e),P.default.removeEventListener("annotationHidden",e)}}),[]),Object(c.useEffect)((function(){var e=function(){var e={},t=n?P.default.getSelectedAnnotations().filter((function(e){return e.Subject===R.g.COMMENT&&!e.isReply()})):P.default.getSelectedAnnotations().filter((function(e){return e.Subject!==R.g.COMMENT&&!e.getCustomData(_.b.IS_HIGHLIGHT_COMMENT.key)}));n&&q(!0),t.forEach((function(t){e[t.Id]=!0})),D(e)};return P.default.addEventListener("annotationSelected",e),function(){P.default.removeEventListener("annotationSelected",e)}}),[]);Object(c.useEffect)((function(){"flex"===t&&G.current&&Y.current&&G.current.scrollToPosition(Y.current)}),[t]);var X=function(e){e&&(Y.current=e)},J=function(){q(!0)},Q=function(e,t){return!!e&&-1!==e.search(new RegExp(t,"i"))},Z=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=null,i=Object(j.a)()[o],s=i.shouldRenderSeparator,l=i.getSeparatorContent,c=0===t?null:e[t-1],m=e[t];s&&l&&(!c||s(c,m))&&(r=u.a.createElement(b.a,{renderContent:function(){return l(c,m,{pageLabels:d})}}));var p={searchInput:B,resize:a,isSelected:k[m.Id],isFocusInput:z,setIsFocusInput:q,isContentEditable:P.default.canModify(m)&&!m.getContents()},f=function(){return n?"".concat(m.Id,"-right"):""};return u.a.createElement("div",{className:"note-wrapper",id:f()},n?"":r,n?u.a.createElement(T.a.Provider,{value:p},u.a.createElement(O.a,{annotation:m,isCommentPanel:!0,isRightPanel:!0})):u.a.createElement(C.a.Provider,{value:p},u.a.createElement(O.a,{annotation:m,isCommentPanel:!1,isRightPanel:!1})))},$=Object(j.a)()[o].getSortedNotes(g).filter((function(e){var t=!0;if(m&&(t=t&&m(e)),B){var n=e.getReplies(),a=[e].concat(i()(n));t=t&&a.some((function(e){var t=e.getContents(),n=e.Author;return Q(t,B)||Q(n,B)}))}return t})),ee=Object.keys(k),te=-1;1===ee.length&&(te=$.findIndex((function(e){return e.Id===ee[0]}))),Object(c.useEffect)((function(){Object.keys(k).length&&-1!==te&&W.current&&($.length<=100?function(e){var t=G.current.children(),n=t.children[e],a=W.current.getBoundingClientRect(),r=n.getBoundingClientRect();r.top>=a.top&&r.top<=a.top+W.current.clientHeight||(W.current.scrollTop=r.top+t.scrollTop-a.top)}(te):G.current.scrollToRow(te))}),[k]);return s||"none"===t?null:u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"Panel NotesPanel","data-element":"notesPanel",ref:W,onMouseDown:P.default.deselectAllAnnotations},0===g.length?n?u.a.createElement("div",{className:"no-annotations"},u.a.createElement(E.a,{className:"center-of-panel",content:"icon_comment",width:132,height:120}),u.a.createElement("p",null,"There is no comments here")):u.a.createElement("div",{className:"no-annotations"},u.a.createElement(y.a,{className:"annotation icon__88"}),u.a.createElement("p",null,K("message.noAnnotations"))):0===$.length?u.a.createElement("div",{className:"no-results"},K("message.noResults")):$.length<=100?u.a.createElement(M,{ref:G,notes:$,onScroll:X,initialScrollTop:Y.current},Z):u.a.createElement(I,{ref:G,notes:$,onScroll:X,initialScrollTop:Y.current},Z)))};k.propTypes=w,k.defaultProps={isRightPanel:!1};var D=Object(g.a)(k),L={notes:m.a.array.isRequired,children:m.a.func.isRequired,onScroll:m.a.func.isRequired,initialScrollTop:m.a.number.isRequired},A=new h.c({defaultHeight:50,fixedWidth:!0}),I=u.a.forwardRef((function(e,t){var n=e.notes,a=e.children,r=e.onScroll,o=e.initialScrollTop,i=Object(c.useRef)(),s=Object(c.useState)(0),d=l()(s,2),m=d[0],p=d[1],v=Object(c.useState)({width:0,height:0}),g=l()(v,2),b=g[0],y=g[1],E=window.innerHeight;Object(c.useImperativeHandle)(t,(function(){return{scrollToPosition:function(e){i.current.scrollToPosition(e)},scrollToRow:function(e){i.current.scrollToRow(e)}}})),Object(c.useEffect)((function(){i.current.scrollToPosition(o)}),[o]),Object(c.useEffect)((function(){var e;A.clearAll(),null===i||void 0===i||null===(e=i.current)||void 0===e||e.recomputeRowHeights()}),[n.length]),Object(c.useEffect)((function(){var e=function(){var e=window.innerHeight-E;e&&(window.innerHeight<E&&p(e),E=window.innerHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var O=function(e){var t=e.scrollTop;r(t)},C=function(e){var t=e.index,r=e.key,o=e.parent,s=e.style,l=n[t];return u.a.createElement(h.b,{key:"".concat(r).concat(l.Id),cache:A,columnIndex:0,parent:o,rowIndex:t},u.a.createElement("div",{style:s},a(n,t,(function(){return function(e){A.clear(e),i.current&&i.current.recomputeRowHeights(e)}(t)}))))};return u.a.createElement(f.a,{bounds:!0,onResize:function(e){var t=e.bounds;y(x(x({},t),{},{height:t.height+2*m})),p(0)}},(function(e){var t=e.measureRef;return u.a.createElement("div",{ref:t,className:"virtualized-notes-container"},u.a.createElement(h.f,{deferredMeasurementCache:A,style:{outline:"none"},height:b.height-m,width:b.width,overscanRowCount:10,ref:i,rowCount:n.length,rowHeight:A.rowHeight,rowRenderer:C,onScroll:O}))}))}));I.propTypes=L;var M=u.a.forwardRef((function(e,t){var n=e.notes,a=e.children,r=e.onScroll,o=e.initialScrollTop,i=Object(c.useRef)();Object(c.useImperativeHandle)(t,(function(){return{scrollToPosition:function(e){i.current.scrollTop=e},children:function(){return i.current},scrollToRow:function(e){var t=i.current,n=t.children[e],a=t.getBoundingClientRect(),r=n.getBoundingClientRect();r.top>=a.top&&r.top<=a.top+t.clientHeight||(t.scrollTop=r.top+t.scrollTop-a.top)}}})),Object(c.useEffect)((function(){i.current.scrollTop=o}),[o]);return u.a.createElement("div",{ref:i,className:"normal-notes-container",onScroll:function(e){r(e.target.scrollTop)}},n.map((function(e,t){return u.a.createElement(u.a.Fragment,{key:"".concat(t).concat(e.Id)},a(n,t))})))}));M.propTypes=L;t.a=D},"./src/lumin-components/StylePalette/index.js":function(e,t,n){"use strict";var a=n("./node_modules/react-redux/es/index.js"),r=n("./src/redux/selectors/index.js"),o=n("./node_modules/@babel/runtime/helpers/extends.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),c=n("./node_modules/@babel/runtime/helpers/createClass.js"),u=n.n(c),d=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),m=n.n(d),p=n("./node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(p),h=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=n.n(h),g=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=n.n(g),y=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=n.n(y),O=n("./node_modules/react/index.js"),C=n.n(O),T=n("./node_modules/prop-types/index.js"),P=n.n(T),S=n("./node_modules/react-i18next/dist/es/withTranslation.js"),j=n("./src/redux/actions/index.js"),R=n("./node_modules/classnames/index.js"),_=n.n(R),N=n("./src/lumin-components/Tooltip/index.js"),x=n("./src/lumin-components/Icomoon/index.js"),w=n("./src/constants/documentConstants.js"),k=n("./src/constants/map.js");function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return v()(this,n)}}var L=function(e){f()(n,e);var t=D(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),E()(m()(e),"setActivePalette",(function(t){var n=e.props;(0,n.setActivePalette)(n.colorMapKey,t)})),E()(m()(e),"renderBorderColorIcon",(function(){var t=e.props,n=t.style.StrokeColor,a=t.colorPalette,r=null===n||void 0===n?void 0:n.toHexString(),o=a===w.b.STROKE_COLOR,i="#FFFFFF"===r;return C.a.createElement(N.a,{content:"option.annotationColor.StrokeColor"},C.a.createElement("div",{className:_()({border:!0,selected:o}),onClick:function(){return e.setActivePalette(w.b.STROKE_COLOR)}},C.a.createElement(x.a,{className:"border",color:i&&!o?"rgb(192, 208, 223)":n})))})),E()(m()(e),"renderFillColorIcon",(function(){var t=e.props,n=t.style.FillColor,a=t.colorPalette,r=null===n||void 0===n?void 0:n.toHexString(),o=a===w.b.FILL_COLOR,i="#FFFFFF"===r;return C.a.createElement(N.a,{content:"option.annotationColor.FillColor"},C.a.createElement("div",{className:_()({fill:!0,selected:o}),onClick:function(){return e.setActivePalette(w.b.FILL_COLOR)}},C.a.createElement(x.a,{className:"rect-filled",color:i&&!o?"rgb(192, 208, 223, 0.6)":r})))})),E()(m()(e),"renderTitleHeader",(function(){var t=e.props,n=t.colorPalette,a="Style";return"freeText"===t.colorMapKey&&(n===w.b.TEXT_COLOR&&(a="Text style"),n!==w.b.STROKE_COLOR&&n!==w.b.FILL_COLOR||(a="Text frame")),a})),e}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.colorPalette,n=e.colorMapKey,a=e.isTextColorPaletteDisabled,r=e.isBorderColorPaletteDisabled,o=e.isFillColorPaletteDisabled,i=e.isAnnotationStylePopup,s=e.annotation,l=Object(k.b)(n).availablePalettes,c=s&&s.Subject!==w.g.REDACTION,u=(null===l||void 0===l?void 0:l.includes(w.b.TEXT_COLOR))&&!a&&c,d=(null===l||void 0===l?void 0:l.includes(w.b.STROKE_COLOR))&&!r&&c,m=(null===l||void 0===l?void 0:l.includes(w.b.FILL_COLOR))&&!o&&c;return(null===l||void 0===l?void 0:l.length)<2||!u&&!d&&!m?C.a.createElement("div",{className:"stylePopup-title"},"freeHand"===n&&C.a.createElement("div",{className:_()({"palette--title":!0,"palette--mg-0":i})})):C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"stylePopup-title"},C.a.createElement("div",{className:_()({"palette--title":!0,"palette--mg-0":t===w.b.FILL_COLOR})},this.renderTitleHeader(),C.a.createElement("div",{className:"palette palette--mg-0 ColorPaletteHeader__palette--flex"},t!==w.b.TEXT_COLOR&&m&&this.renderFillColorIcon(),t!==w.b.TEXT_COLOR&&d&&this.renderBorderColorIcon()))))}}]),n}(C.a.PureComponent);L.propTypes={style:P.a.object.isRequired,colorPalette:P.a.oneOf(["TextColor","StrokeColor","FillColor"]),colorMapKey:P.a.string.isRequired,setActivePalette:P.a.func.isRequired,isTextColorPaletteDisabled:P.a.bool,isFillColorPaletteDisabled:P.a.bool,annotation:P.a.object,isBorderColorPaletteDisabled:P.a.bool,isAnnotationStylePopup:P.a.bool},L.defaultProps={colorPalette:"TextColor",isTextColorPaletteDisabled:!1,isFillColorPaletteDisabled:!1,isBorderColorPaletteDisabled:!1,annotation:{},isAnnotationStylePopup:!1};var A=L,I={setActivePalette:j.a.setActivePalette},M=Object(a.c)((function(e){return{isTextColorPaletteDisabled:r.a.isElementDisabled(e,"textColorPalette"),isFillColorPaletteDisabled:r.a.isElementDisabled(e,"fillColorPalette"),isBorderColorPaletteDisabled:r.a.isElementDisabled(e,"borderColorPalette")}}),I)(Object(S.a)(null,{wait:!1})(A)),B=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),F=n.n(B),U=n("./src/core/index.js"),H=n("./src/utils/index.js"),z=n("./src/constants/toolsName.js"),q="redaction",V=n("./node_modules/@material-ui/core/esm/Button/Button.js"),K=C.a.createElement("svg",{width:"24px",height:"24px",style:{position:"relative",borderRadius:"100%",border:"1px solid #c0d0df"}},C.a.createElement("line",{x1:"0%",y1:"100%",x2:"100%",y2:"0%",strokeWidth:"1",stroke:"#e44234",strokeLinecap:"square"}));function G(e){var t=e.property,n=e.setColor,a=e.active,r=e.className;return e.isNotRenderTransparencyCell||"TextColor"===t||"StrokeColor"===t||"redaction"===t?null:C.a.createElement(V.a,{onClick:function(e){return n(e)},className:"ColorPaletteLumin__transparent ".concat(r," ").concat(a)},C.a.createElement("div",{className:"cell ColorPaletteLumin__transparent--cell"},K))}G.propTypes={property:P.a.string,setColor:P.a.func.isRequired,active:P.a.string,className:P.a.string,isNotRenderTransparencyCell:P.a.bool},G.defaultProps={property:"",active:"",className:"",isNotRenderTransparencyCell:!1};var W=G,Y=function(e){var t=e.bg,n=e.onClick,a=e.className;return C.a.createElement(V.a,{key:t,onClick:n,value:t,className:a},C.a.createElement("div",{className:"cell ".concat("rgb(255, 255, 255)"===t?"bordered":""),style:{backgroundColor:t}}))};Y.propTypes={bg:P.a.string,onClick:P.a.func,className:P.a.string},Y.defaultProps={bg:"",className:"",onClick:function(){}};var X=Y,J=n("./node_modules/react-color/es/index.js"),Q=n("./src/lumin-components/LuminButton/index.js"),Z=n("./node_modules/@material-ui/core/esm/Grid/Grid.js"),$=n("./src/lumin-components/MaterialPopper/index.js");function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return v()(this,n)}}var te=function(e){f()(n,e);var t=ee(n);function n(e){var a;return l()(this,n),a=t.call(this,e),E()(m()(a),"handleToggleColorPicker",(function(){a.setState({displayColorPicker:!a.state.displayColorPicker})})),E()(m()(a),"handleChange",(function(e){var t=e.rgb;a.setState({color:t})})),E()(m()(a),"setPalette",(function(){var e=a.state.color;a.props.setPalette("rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")),a.handleToggleColorPicker()})),E()(m()(a),"handleClosePicker",(function(){a.setState({displayColorPicker:!1})})),a.state={displayColorPicker:!1,color:{r:34,g:25,b:75,a:1}},a}return u()(n,[{key:"render",value:function(){var e=this,t=this.props.placement,n=this.state,a=n.displayColorPicker,r=n.color;return C.a.createElement(C.a.Fragment,null,C.a.createElement(V.a,{onClick:this.handleToggleColorPicker,value:this.props.bg,className:"ColorPickerBtn ".concat(this.props.className," ").concat(this.state.displayColorPicker?"active-picker":""),ref:function(t){e.anchorEl=t}},C.a.createElement(x.a,{className:"basic-tint",size:22})),C.a.createElement($.a,{open:a,anchorEl:this.anchorEl,classes:"ColorPicker__popper",placement:t,handleClose:this.handleClosePicker},C.a.createElement("div",{className:"ColorPicker"},C.a.createElement(J.a,{className:"ColorPicker__container",disableAlpha:!0,color:r,width:"auto",onChangeComplete:this.handleChange,styles:{default:{picker:{boxShadow:"none"}}}}),C.a.createElement("div",{className:"divider horizontal"}),C.a.createElement(Z.a,{container:!0,spacing:2},C.a.createElement(Z.a,{item:!0,xs:6},C.a.createElement(Q.a,{type:"secondary",label:"Cancel",full:!0,onClick:this.handleToggleColorPicker})),C.a.createElement(Z.a,{item:!0,xs:6},C.a.createElement(Q.a,{type:"primary",label:"Confirm",full:!0,onClick:this.setPalette}))))))}}]),n}(C.a.PureComponent);te.propTypes={bg:P.a.string,className:P.a.string,setPalette:P.a.func,placement:P.a.string},te.defaultProps={placement:"bottom",bg:"",className:"",setPalette:function(){}};var ne=te;function ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return v()(this,n)}}var re={property:P.a.string.isRequired,color:P.a.object,onStyleChange:P.a.func.isRequired,colorMapKey:P.a.string.isRequired,overridePalette:P.a.object,annotation:P.a.object,placement:P.a.string},oe=function(e){f()(n,e);var t=ae(n);function n(e){var a;return l()(this,n),a=t.call(this,e),E()(m()(a),"defaultPalette",function(){var e,t,n=["transparency","rgb(249, 73, 57)","rgb(255, 230, 162)","rgb(79, 194, 246)","rgb(126, 211, 33)","rgb(74, 144, 226)","rgb(80, 227, 194)","rgb(246, 123, 137)","rgb(255, 255, 255)"];return(U.default.getSelectedAnnotations().length&&U.default.getSelectedAnnotations().some((function(e){return"Comment"===e.Subject}))||"AnnotationCreateSticky"===(null===(e=U.default.getToolMode())||void 0===e?void 0:e.name))&&n.splice(7,1),(U.default.getSelectedAnnotations().length&&(null===(t=U.default.getToolMode())||void 0===t?void 0:t.name)===z.a.REDACTION||a.props.colorMapKey===q)&&n.splice(7,1,"rgb(0, 0, 0)"),n}()),E()(m()(a),"setColor",(function(e){e.stopPropagation();var t=a.props,n=t.property,r=t.onStyleChange,o=e.currentTarget.value,i=o?o.slice(o.indexOf("(")+1,-1).split(","):[0,0,0,0];r(n,new window.Annotations.Color(i[0],i[1],i[2],i[3]))})),E()(m()(a),"setPalette",(function(e){var t=a.props,n=t.property,r=t.onStyleChange;if(!a.state.palette.includes(e)){var o="transparency"===a.state.palette[0]?1:0,i=F()(a.state.palette);null===i||void 0===i||i.splice(o,1),a.setState({palette:[].concat(F()(i),[e])});var s=e?e.slice(e.indexOf("(")+1,-1).split(","):[0,0,0,0];r(n,new window.Annotations.Color(s[0],s[1],s[2],s[3]))}})),E()(m()(a),"renderActiveClass",(function(e){var t=a.props.color,n=H.g.rbgToHex(e)||"transparency";return(t.toHexString()||"transparency").toLowerCase()===n?"active":""})),a.state={palette:[]},a.setPalette=a.setPalette.bind(m()(a)),a}return u()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.overridePalette,n=e.colorMapKey,a=e.color,r=(null===t||void 0===t?void 0:t[n])||(null===t||void 0===t?void 0:t.global)||this.defaultPalette,o="rgb(".concat(a.R,", ").concat(a.G,", ").concat(a.B,")");r.includes(o)||null===r||void 0===r||r.splice((null===r||void 0===r?void 0:r.length)-1,1,o),this.setState({palette:r})}},{key:"render",value:function(){var e=this,t=this.state.palette,n=this.props,a=n.annotation,r=n.placement,o=a&&a.Subject===w.g.REDACTION;return C.a.createElement("div",{className:"ColorPaletteLumin","data-element":"colorPalette"},t.map((function(t){return C.a.createElement(C.a.Fragment,{key:t},"transparency"===t?C.a.createElement(W,{setColor:e.setColor,property:e.props.property,active:e.renderActiveClass(t),className:"color-cell",isNotRenderTransparencyCell:o}):C.a.createElement(X,{bg:t,onClick:function(t){return e.setColor(t)},className:"color-cell  ".concat(e.renderActiveClass(t))}))})),C.a.createElement(ne,{setPalette:this.setPalette,placement:r}))}}]),n}(C.a.PureComponent);oe.propTypes=re,oe.defaultProps={overridePalette:null,color:"",annotation:{},placement:"bottom"};var ie=oe,se=Object(a.c)((function(e){return{overridePalette:r.a.getCustomElementOverrides(e,"colorPalette")}}))(ie),le=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),ce=n.n(le),ue=n("./node_modules/lodash/debounce.js"),de=n.n(ue),me=n("./node_modules/@material-ui/core/esm/MenuList/MenuList.js"),pe=n("./node_modules/@material-ui/core/esm/MenuItem/MenuItem.js"),fe=n("./src/lumin-components/MaterialSelect/index.js"),he=n("./src/lumin-components/ActionButton/index.js"),ve=n("./src/lumin-components/Shared/Input/index.js"),ge=n("./src/helpers/getRichTextCSSStyle.js");function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=/^\d+$/,Oe=function(e,t){var n=Object(ge.a)(e.getContents(),t);n&&e.setRichTextStyle(n),U.default.getAnnotationManager().redrawAnnotation(e)},Ce=function(e){var t=e.key,n=e.annotation,a=e.fontWeight,r=Number(n.FontSize.replace(/\p|t/g,""));if("bold"===t&&("Arial"===n.Font||"Helvetica"===n.Font)){var o=r;r>=40?o=r-9:r<40&&r>=30?o=r-6:r<30&&r>=20&&(o=r-3);var i=function(e,t){var n=document.createElement("canvas").getContext("2d");return n.font=t,n.measureText(e).width}(n.getContents().split(/\n/).sort((function(e,t){return t.length-e.length}))[0],"".concat(a," ").concat(o,"pt Helvetica"));n.Width<i&&n.setWidth(i)}},Te=[{value:"Aladin",name:"Aladin",class:"font-aladin"},{value:"Allura",name:"Allura",class:"font-allura"},{value:"Cookie",name:"Cookie",class:"font-cookie"},{value:"Courgette",name:"Courgette",class:"font-courgette"},{value:"DancingScript",name:"Dancing Script",class:"font-dancing-script"},{value:"GillSans",name:"GillSans",class:"font-gillSans"},{value:"Helvetica",name:"Helvetica",class:"font-helvetica"},{value:"Italianno",name:"Italianno",class:"font-italianno"},{value:"Lora",name:"Lora",class:"font-lora"},{value:"Merriweather",name:"Merriweather",class:"font-merriweather"},{value:"Roboto",name:"Roboto",class:"font-roboto"}],Pe=function(e){var t,n=e.key,a=e.annotation,r=e.onStyleChange,o=void 0===r?function(){}:r,i=null===(t=a.getContents())||void 0===t?void 0:t.length,s=a.getRichTextStyle();Object.prototype.hasOwnProperty.call(s,i)||(s[i]={});var l=s[Object.keys(s)[0]],c=Object.values(l),u={key:n,objRichStyleKeys:c,richStyle:l,annotation:a,propertyName:function(e){return{bold:"font-weight",italic:"font-style",word:"text-decoration"}[e]}(n),onStyleChange:o};void 0!==c&&null!==c&&void 0!==c&&c.includes(n)?function(e){var t=e.key,n=e.objRichStyleKeys,a=e.richStyle,r=e.annotation,o=e.propertyName,i=e.onStyleChange,s=void 0===i?function(){}:i,l=null===n||void 0===n?void 0:n.filter((function(e){return e!==t}));s(w.b.FONT_STYLE,l),r instanceof window.Annotations.FreeTextAnnotation&&(delete a[o],Oe(r,a))}(ye({},u)):function(e){var t=e.key,n=e.objRichStyleKeys,a=e.richStyle,r=e.annotation,o=e.propertyName,i=e.onStyleChange,s=void 0===i?function(){}:i,l=(null===n||void 0===n?void 0:n.length)>0?[].concat(F()(n),[t]):[t];s(w.b.FONT_STYLE,l),r instanceof window.Annotations.FreeTextAnnotation&&(a[o]=t,Oe(r,a)),Ce({key:"bold",annotation:r,fontWeight:"bold"})}(ye({},u))},Se=function(e){var t,n=e.inputFontSizeRef,a=e.inputFocused,r=e.fontSizeValue,o=e.setOpenFontSizePopper,i=void 0===o?function(){}:o,s=e.handleUpdateFontSize,l=void 0===s?function(){}:s,c=e.renderCheckedActiveFont,u=void 0===c?function(){}:c,d=(t=5,Array(45-t+1).fill().map((function(e,n){return t+n}))||[]);return C.a.createElement($.a,{open:!0,anchorEl:n.current,classes:"FreeTextPaletteHeader__MaterialPopper",handleClose:function(){a||i(!1)}},C.a.createElement(me.a,{className:"FreeTextPaletteHeader__MenuList"},d.map((function(e,t){return C.a.createElement(pe.a,{key:t,onClick:function(){l(e),i(!1)}},e," pt ",e===Number(r)&&u())}))))};function je(e){var t=e.isAnnotationStylePopup,n=e.style,a=n.Font,r=n.FontSize,o=e.annotation,i=e.colorPalette,s=e.colorMapKey,l=e.onStyleChange,c=null===r||void 0===r?void 0:r.split("pt")[0],u=Object(O.useRef)(),d=Object(O.useState)(c),m=ce()(d,2),p=m[0],f=m[1],h=Object(O.useState)(!1),v=ce()(h,2),g=v[0],b=v[1],y=Object(O.useState)(!1),E=ce()(y,2),T=E[0],P=E[1],S=o&&o.Subject===w.g.FREE_TEXT&&!o.getContents(),j=S?"FreeTextPaletteHeader__ActionButton--disabled":"",R=function(e){var t;f(e),l(w.b.FONT_SIZE,(t=e,"".concat(Math.round(t),"pt")))},N=Object(O.useCallback)(de()((function(e){Number(e)>=5&&Number(e)<=45&&R(e)}),700),[]),k=function(e){var n=t&&o&&o.getRichTextStyle();if(n){var a=n[Object.keys(n)[0]];if(Object.values(a).includes(e))return"active"}return""},D=function(){return C.a.createElement("span",{className:"palette__font-selected"},C.a.createElement(x.a,{className:"check",size:14}))},L=[{title:"Bold",icon:"text-bold",iconSize:24,className:"text-tool ".concat(k("bold")," ").concat(j),onClick:function(){Pe({key:"bold",annotation:o,onStyleChange:l})},disabled:S},{title:"Italic",icon:"text-italic",iconSize:24,className:"text-tool ".concat(k("italic")," ").concat(j),onClick:function(){Pe({key:"italic",annotation:o,onStyleChange:l})},disabled:S},{title:"Underline",icon:"text-underline",iconSize:24,className:"text-tool ".concat(k("word")," ").concat(j),onClick:function(){Pe({key:"word",annotation:o,onStyleChange:l})},disabled:S}];return C.a.createElement("div",{className:"stylePopup-title"},C.a.createElement("div",{className:_()({"palette--mg-0":i===w.b.FILL_COLOR})},C.a.createElement("span",{className:"palette--title-free-text"},function(){var e="Style";return"freeText"===s&&(i===w.b.TEXT_COLOR&&(e="Text style"),i!==w.b.STROKE_COLOR&&i!==w.b.FILL_COLOR||(e="Text frame")),e}()),C.a.createElement("div",{className:_()({palette:!0,"ColorPaletteHeader__palette--flex":!t})},C.a.createElement(fe.a,{value:a,onSelected:function(e){l(w.b.FONT,e.value)},containerClasses:_()({"FreeTextPaletteHeader__MaterialSelect--full-width":t,"FreeTextPaletteHeader__MaterialSelect--font-size":!0}),inputClasses:"input",items:Te,childNameComponent:D()}),C.a.createElement("div",{className:_()({"FreeTextPaletteHeader__input--wrapper":!0,"FreeTextPaletteHeader__input--wrapper-flex":t})},C.a.createElement("div",{className:"Input--container",onClick:function(){g||u.current.focus()}},C.a.createElement(ve.a,{inputRef:u,value:"".concat(p).concat(g?"":" pt"),postfix:C.a.createElement("span",{className:"FreeTextPaletteHeader__Input--font-extension"},C.a.createElement(x.a,{className:"dropdown MaterialSelect__input__icon_dropdown",size:16})),onChange:function(e){var t=e.target.value,n=new RegExp(Ee);t&&!n.test(t)||(f(t),N(t))},onBlur:function(e){var t=Number(e.target.value),n=Math.max(5,Math.min(45,t));R(n),b(!1)},onFocus:function(){P(!0),b(!0)},onKeyPress:function(e){"Enter"===e.key&&(u.current.blur(),P(!1))}})),t&&C.a.createElement("div",{className:"FreeTextPaletteHeader__ActionButton--wrapper"},L.map((function(e,t){return C.a.createElement(he.a,{key:t,title:e.title,icon:e.icon,iconSize:e.iconSize,className:e.className,onClick:e.onClick,disabled:e.disabled})}))),T&&Se({inputFontSizeRef:u,inputFocused:g,fontSizeValue:p,setOpenFontSizePopper:P,handleUpdateFontSize:R,renderCheckedActiveFont:D})))))}je.propTypes={style:P.a.object.isRequired,colorPalette:P.a.oneOf(["TextColor","StrokeColor","FillColor"]),colorMapKey:P.a.string.isRequired,onStyleChange:P.a.func.isRequired,annotation:P.a.object,isAnnotationStylePopup:P.a.bool},je.defaultProps={colorPalette:"TextColor",annotation:{},isAnnotationStylePopup:!1};var Re=je,_e=n("./src/helpers/device.js"),Ne=n("./node_modules/react-color/lib/components/common/index.js"),xe=function(){return C.a.createElement("div",{style:{width:"16px",height:"16px",borderRadius:"8px",marginTop:"1px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}})};function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){E()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var De=function(e){var t=e.rgb,n=e.hsl,a=e.hsv,r=e.renderers,o=e.extension,i=e.sliderValue,s=e.setSliderValue,l=e.changeSlider,c=e.handleOnBlur,u=e.property,d=e.displayProperty,m=Object(O.useState)(i),p=ce()(m,2),f=p[0],h=p[1];return Object(O.useEffect)((function(){i<=100&&h(i)}),[i]),C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{id:"".concat(u,"-").concat(d),onMouseDown:function(){document.getElementById("".concat(u,"-").concat(d)).style.cursor="grabbing"},onMouseUp:function(){document.getElementById("".concat(u,"-").concat(d)).style.cursor="pointer"},className:"slider__alpha"},C.a.createElement(Ne.Alpha,{width:208,rgb:ke(ke({},t),{},{a:f/100}),hsl:n,hsv:a,renderers:r,onChange:function(e){var t=100*(null===e||void 0===e?void 0:e.a);l(t)},pointer:xe})),C.a.createElement("div",{className:"slider__value"},C.a.createElement(ve.a,{postfix:C.a.createElement("span",{className:"SliderLumin__extension"},o),value:String(i),onChange:function(e){s(e)},onBlur:c})))};De.propTypes={renderers:P.a.any,sliderValue:P.a.number,extension:P.a.string,property:P.a.string,displayProperty:P.a.string,rgb:P.a.object,hsl:P.a.object,hsv:P.a.object,setSliderValue:P.a.func,changeSlider:P.a.func,handleOnBlur:P.a.func},De.defaultProps={renderers:{},sliderValue:0,extension:"",property:"",displayProperty:"",rgb:{},hsl:{},hsv:{},setSliderValue:function(){},changeSlider:function(){},handleOnBlur:function(){}};var Le=Object(J.b)(De);function Ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return v()(this,n)}}var Ie={property:P.a.string.isRequired,initialValue:P.a.oneOfType([P.a.number,P.a.string]),displayProperty:P.a.string.isRequired,dataElement:P.a.string.isRequired,getCirclePosition:P.a.func.isRequired,convertRelativeCirclePositionToValue:P.a.func.isRequired,onStyleChange:P.a.func.isRequired,t:P.a.func.isRequired,limitValue:P.a.object.isRequired,annotation:P.a.object.isRequired,convertValue:P.a.func.isRequired,currentPalette:P.a.string.isRequired},Me=function(e){f()(n,e);var t=Ae(n);function n(e){var a;return l()(this,n),a=t.call(this,e),E()(m()(a),"onAnnotationChanged",(function(){var e=a.props.annotation;if("Free text"===e.Subject&&e.getContents()&&(e.Width<50||e.Height<20)){var t=U.default.getDocument(),n=U.default.getCurrentPage(),r=t.getPageInfo(n),o=t.getPageMatrix(n),i=t.getPageRotation(n);e.fitText(r,o,i),U.default.getAnnotationManager().redrawAnnotation(e)}})),E()(m()(a),"updateSvg",(function(){a.setLineLength(),a.forceUpdate()})),E()(m()(a),"setLineLength",(function(){var e,t;(null===(e=a.sliderSvg.current)||void 0===e?void 0:e.getBoundingClientRect().width)<170?a.lineLength=a.sliderSvg.current.getBoundingClientRect().width+50-24:a.lineLength=(null===(t=a.sliderSvg.current)||void 0===t?void 0:t.getBoundingClientRect().width)-24})),E()(m()(a),"onMouseDown",(function(e){var t=a.props,n=t.property,r=t.displayProperty;document.getElementById("".concat(n,"-").concat(r)).style.cursor="grabbing",a.isMouseDown=!0,a.onMove(e.nativeEvent)})),E()(m()(a),"onMouseUp",(function(){var e=a.props,t=e.property,n=e.displayProperty;document.getElementById("".concat(t,"-").concat(n)).style.cursor="pointer",a.isMouseDown=!1})),E()(m()(a),"onTouchStart",(function(e){a.onMove(e)})),E()(m()(a),"onMove",(function(e){if(!!e.touches||a.isMouseDown){e.preventDefault();var t=(0,a.props.convertRelativeCirclePositionToValue)(a.getRelativeCirclePosition(e));a.setState({sliderValue:t}),a.handleUpdateStyle(t)}})),E()(m()(a),"handleUpdateStyle",(function(e){var t=a.props,n=t.property,r=t.onStyleChange,o=t.convertValue,i=t.getCirclePosition;a.setState({sliderValue:parseInt(e)},(function(){a.setState({circleCenter:i(a.lineLength,a.state.sliderValue)})})),r(n,o(e))})),E()(m()(a),"getRelativeCirclePosition",(function(e){var t,n=!e.touches,r=8+a.lineLength,o=a.sliderSvg.current.getBoundingClientRect().left;return(t=n?e.pageX-o:e.touches[0].pageX-o)<8?t=8:t>r&&(t=r),(t-8)/a.lineLength})),E()(m()(a),"onChange",(function(e){var t=a.props.limitValue,n=t.max,r=t.min;(e=Number(e))>=Number(r)&&e<=Number(n)&&a.handleUpdateStyle(e)})),E()(m()(a),"handleChangeInput",(function(e){var t=e.target.value;t&&Number.isNaN(Number(t))||(a.setState({sliderValue:parseInt(t)||0}),a.debounceInput(t))})),E()(m()(a),"handleOnBlur",(function(e){var t=a.props.limitValue,n=t.max,r=t.min,o=Number(e.target.value);if(o<Number(r)||o>Number(n)){var i=Math.max(Number(r),Math.min(Number(n),Number(o)));a.handleUpdateStyle(i)}})),E()(m()(a),"getExtension",(function(){return"Opacity"===a.props.property?"%":"pt"})),E()(m()(a),"renderSlider",(function(){var e=a.props,t=e.dataElement,n=e.displayProperty,r=e.t,o=e.property,i=a.state,s=i.sliderValue,l=i.circleCenter;return C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"slider__property","data-element":t},C.a.createElement(N.a,{content:"thickness"!==n?r("option.slider.".concat(n)):"Border Size"},C.a.createElement("div",null,"FontSize"===o?C.a.createElement(x.a,{className:"text-font-size",size:22}):C.a.createElement(x.a,{className:"stroke-size",size:16})))),C.a.createElement("svg",{id:"".concat(o,"-").concat(n),width:"100%",height:22,onMouseDown:a.onMouseDown,onTouchStart:a.onTouchStart,ref:a.sliderSvg,onMouseUp:a.onMouseUp,onMouseMove:a.onMove},C.a.createElement("defs",null,C.a.createElement("filter",{id:"dropshadow",x:"-40%",y:"-40%",width:"180%",height:"180%",filterUnits:"userSpaceOnUse"},C.a.createElement("feGaussianBlur",{in:"SourceAlpha",result:"shadowBlurOuter1",stdDeviation:"2"}),C.a.createElement("feColorMatrix",{in:"shadowBlurOuter1",values:"0 0 0 0 0.131001602 0 0 0 0 0.270895425 0 0 0 0 0.43622449 0 0 0 0.29761096 0"}),C.a.createElement("feOffset",{dx:"5",dy:"5",result:"offsetblur"}),C.a.createElement("feOffset",{dx:"-5",dy:"-5",result:"offsetblur"}),C.a.createElement("feMerge",null,C.a.createElement("feMergeNode",null),C.a.createElement("feMergeNode",{in:"SourceGraphic"}),C.a.createElement("feMergeNode",{in:"SourceGraphic"})))),C.a.createElement("line",{className:"slider__line-fill",x1:8,y1:"50%",x2:l,y2:"50%",strokeWidth:"3",strokeLinecap:"round"}),C.a.createElement("line",{className:"slider__line-empty",x1:l,y1:"50%",x2:a.lineLength+8,y2:"50%",strokeWidth:"3",strokeLinecap:"round"}),C.a.createElement("circle",{className:"slider__circle",cx:l,cy:"50%",r:8,strokeWidth:"3"})),C.a.createElement("div",{className:"slider__value"},C.a.createElement(ve.a,{value:String(s),postfix:C.a.createElement("span",{className:"SliderLumin__extension"},a.getExtension()),onChange:a.handleChangeInput,onBlur:a.handleOnBlur})))})),E()(m()(a),"renderSliderOpacity",(function(){var e=a.props,t=e.property,n=e.displayProperty,r=a.state.sliderValue;return C.a.createElement(Le,{color:"#000000",extension:a.getExtension(),sliderValue:r,changeSlider:a.onChangeOpacityInputValue,setSliderValue:a.handleChangeInput,handleOnBlur:a.handleOnBlur,property:t,displayProperty:n})})),E()(m()(a),"onChangeOpacityInputValue",(function(e){a.setState({sliderValue:parseInt(e)}),a.onChange(e)})),a.state={sliderValue:0},a.isMouseDown=!1,a.sliderSvg=C.a.createRef(),a.lineLength=0,a.updateMinValue=null,a.state={sliderValue:0,circleCenter:0},a.debounceInput=de()(a.onChange,700),a}return u()(n,[{key:"componentDidMount",value:function(){var e,t=this.props.getCirclePosition;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("orientationchange",this.updateSvg),window.addEventListener("resize",this.updateSvg),U.default.addEventListener("annotationChanged",this.onAnnotationChanged),null===(e=this.sliderSvg.current)||void 0===e||e.addEventListener("touchmove",this.onMove,{passive:!1}),this.updateSvg(),this.setState({sliderValue:this.props.initialValue}),this.setState({circleCenter:t(this.lineLength,this.props.initialValue)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.currentPalette,a=t.getCirclePosition,r=this.state.sliderValue;e.currentPalette!==n&&(this.updateSvg(),this.setState({circleCenter:a(this.lineLength,r)}))}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("orientationchange",this.updateSvg),window.removeEventListener("resize",this.updateSvg),U.default.removeEventListener("annotationChanged",this.onAnnotationChanged),null===(e=this.sliderSvg.current)||void 0===e||e.removeEventListener("touchmove",this.onMove,{passive:!1})}},{key:"render",value:function(){var e=this.props.property;return _e.i?C.a.createElement("div",{className:"slider"},this.renderSlider()):"Opacity"===e?this.renderSliderOpacity():this.renderSlider()}}]),n}(C.a.PureComponent);Me.propTypes=Ie,Me.defaultProps={initialValue:0};var Be=Me,Fe=Object(S.a)(null,{wait:!1})(Be),Ue=n("./src/constants/dataElement.js");function He(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return v()(this,n)}}var ze=100,qe=function(e){f()(n,e);var t=He(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),E()(m()(e),"renderColorPalette",(function(){var t=e.props,n=t.style,a=t.onStyleChange,r=t.currentPalette,o=t.colorMapKey,i=t.annotation,s=t.placement,l=i&&i.Subject===w.g.REDACTION?"FillColor":r;return C.a.createElement(se,{color:n[l],property:l,onStyleChange:a,colorMapKey:o,annotation:i,placement:s})})),E()(m()(e),"renderSliders",(function(){var t=e.props,n=t.style.StrokeThickness,a=t.onStyleChange,r=t.isFreeText,o=t.annotation,s=t.isStrokeThicknessSliderDisabled,l=t.currentPalette,c=[],u=o.ToolName===z.a.SQUIGGLY||o.ToolName===z.a.HIGHTLIGHT||o.ToolName===z.a.UNDERLINE||o.ToolName===z.a.STRIKEOUT;return s||l!==w.b.STROKE_COLOR||u||c.push({dataElement:Ue.a.STROKE_THICKNESS_SLIDER,property:"StrokeThickness",displayProperty:"thickness",initialValue:n,getCirclePosition:function(e,t){return!r&&t<1?.05*e+8:(t>20?1:t/20)*e+8},convertRelativeCirclePositionToValue:function(e){return r?20*e:19*e+1},convertValue:function(e){return Math.round(e)},limitValue:{max:"20",min:r?"0":"1"}}),[n].map((function(e,t){if(null===e||void 0===e||!c[t])return null;var n=c[t],r=n.property;return C.a.createElement(Fe,i()({},n,{key:r,onStyleChange:a,annotation:o,currentPalette:l}))}))})),E()(m()(e),"renderSliderOpacity",(function(){var t,n=e.props,a=n.style,r=a.Opacity,o=a.FillColor,s=a.StrokeColor,l=n.onStyleChange,c=n.annotation,u=n.isOpacitySliderDisabled,d=n.currentPalette,m={};return u||(m={FillColor:o,StrokeColor:s,dataElement:Ue.a.OPACITY_SLIDER,property:"Opacity",displayProperty:"opacity",convertValue:function(e){return Math.round(e)/100},limitValue:{max:100,min:0},initialValue:Math.round(100*r),getCirclePosition:function(e,t){return(t>ze?1:t/100)*e+8},convertRelativeCirclePositionToValue:function(e){return 100*e}}),null!==r&&void 0!==r&&m?C.a.createElement(Fe,i()({},m,{key:null===(t=m)||void 0===t?void 0:t.property,onStyleChange:l,annotation:c,currentPalette:d})):null})),E()(m()(e),"renderTextColorComponent",(function(){var t=e.props,n=t.colorMapKey,a=t.style,r=t.onStyleChange,o=t.annotation,i=t.isAnnotationStylePopup;return"freeText"!==n?null:C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"colors-container","data-element":Ue.a.COLOR_PALETTE},C.a.createElement("div",{className:"inner-wrapper"},C.a.createElement(Re,{colorPalette:w.b.TEXT_COLOR,colorMapKey:n,style:a,onStyleChange:r,annotation:o,isAnnotationStylePopup:i}),C.a.createElement(se,{color:null===a||void 0===a?void 0:a.TextColor,property:w.b.TEXT_COLOR,onStyleChange:r,colorMapKey:n}))),C.a.createElement("div",{className:"divider horizontal"}))})),e}return u()(n,[{key:"render",value:function(){var e=this.props,t=e.isColorPaletteDisabled,n=e.currentPalette,a=e.style,r=e.colorMapKey,o=e.isSignature,i=e.isOpacitySliderDisabled,s=e.isStrokeThicknessSliderDisabled,l=e.isFontSizeSliderDisabled,c=e.isStylePopupDisabled,u=e.onStyleChange,d=e.isAnnotationStylePopup,m=e.hideOpacitySlider,p=e.hideThicknessSlider,f=e.annotation,h=s&&l,v=f&&f.Subject===w.g.REDACTION?"FillColor":n;return c?null:C.a.createElement("div",{className:"Popup StylePalette","data-element":Ue.a.STYLE_POPUP,onClick:function(e){return e.stopPropagation()},onScroll:function(e){return e.stopPropagation()}},this.renderTextColorComponent(),n&&!o&&!t&&C.a.createElement("div",{className:"colors-container","data-element":Ue.a.COLOR_PALETTE},C.a.createElement("div",{className:"inner-wrapper"},C.a.createElement(M,{colorPalette:v,colorMapKey:r,style:a,onStyleChange:u,isAnnotationStylePopup:d,annotation:f}),!h&&C.a.createElement("div",{className:"sliders-container"},!p&&C.a.createElement("div",{className:"sliders"},this.renderSliders())),this.renderColorPalette())),!i&&n!==w.b.TEXT_COLOR&&!m&&C.a.createElement("div",{className:"sliders-container"},C.a.createElement("div",{className:"sliders--opacity"},this.renderSliderOpacity())))}}]),n}(C.a.PureComponent);qe.propTypes={style:P.a.object.isRequired,onStyleChange:P.a.func.isRequired,isFreeText:P.a.bool.isRequired,hideDivider:P.a.bool,colorMapKey:P.a.string,currentPalette:P.a.oneOf(["TextColor","StrokeColor","FillColor"]),isColorPaletteDisabled:P.a.bool,isOpacitySliderDisabled:P.a.bool,isStrokeThicknessSliderDisabled:P.a.bool,isFontSizeSliderDisabled:P.a.bool,isStyleOptionDisabled:P.a.bool,isStylePopupDisabled:P.a.bool,isSignature:P.a.bool,annotation:P.a.object,isAnnotationStylePopup:P.a.bool,hideOpacitySlider:P.a.bool,hideThicknessSlider:P.a.bool,placement:P.a.string},qe.defaultProps={hideDivider:!1,colorMapKey:"",currentPalette:"TextColor",isColorPaletteDisabled:!1,isOpacitySliderDisabled:!1,isStrokeThicknessSliderDisabled:!1,isFontSizeSliderDisabled:!1,isStyleOptionDisabled:!1,isStylePopupDisabled:!1,isSignature:!1,annotation:{},isAnnotationStylePopup:!1,hideOpacitySlider:!1,hideThicknessSlider:!1,placement:"bottom"};var Ve=qe,Ke={COLOR_PALETTE:"colorPalette",OPACITY_SLIDER:"opacitySlider",STROKE_THICKNESS_SLIDER:"strokeThicknessSlider",FONT_SIZE_SLIDER:"fontSizeSlider",STYLE_OPTION:"styleOption"};t.a=Object(a.c)((function(e,t){var n=t.colorMapKey;return{currentPalette:r.a.getCurrentPalette(e,n),isStylePopupDisabled:r.a.isElementDisabled(e,Ke.STYLE_POPUP),isColorPaletteDisabled:r.a.isElementDisabled(e,Ke.COLOR_PALETTE),isOpacitySliderDisabled:r.a.isElementDisabled(e,Ke.OPACITY_SLIDER),isStrokeThicknessSliderDisabled:r.a.isElementDisabled(e,Ke.STROKE_THICKNESS_SLIDER),isFontSizeSliderDisabled:r.a.isElementDisabled(e,Ke.FONT_SIZE_SLIDER),isStyleOptionDisabled:r.a.isElementDisabled(e,Ke.STYLE_OPTION)}}))(Ve)}}]);